!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.CoCreateAttributes=e():t.CoCreateAttributes=e()}(this,function(){return n={586:()=>{function e(e,t){var r,n=Object.keys(e);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(e),t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)),n}function r(n){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?e(Object(a),!0).forEach(function(t){var e,r;e=n,t=a[r=t],r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(a)):e(Object(a)).forEach(function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(a,t))})}return n}function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,u=t[Symbol.iterator]();!(n=(i=u.next()).done)&&(r.push(i.value),!e||r.length!==e);n=!0);}catch(t){a=!0,o=t}finally{try{n||null==u.return||u.return()}finally{if(a)throw o}}return r}(t,e)||u(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(t,e){if(t){if("string"==typeof t)return n(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(r="Object"===r&&t.constructor?t.constructor.name:r)||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(t,e):void 0}}function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function c(r){var n,a,e=r.getAttribute("data-attribute_target");e&&(n=s(function(t){return t.querySelector(e)})[0],a=r.getAttribute("data-attribute_sync"),n&&n.getAttribute(a)&&b(r,function(t,e){e&&"toggle"===e.class?r.checked=p({input:r,element:n,inputValue:r.getAttribute("value"),read:a}):"SELECT"==r.tagName?h({input:r,element:n,read:a}):"COCREATE-SELECT"==r.tagName?A({input:r,element:n,read:a}):(r.lastValue=r.value,r.value=m({element:n,read:a}))}))}function l(t){var r={};return t.split&&t.split(";").forEach(function(t){var e=t.split(":"),t=e.shift().trim(),e=e.join().trim();t&&(r[t]=e)}),r}function s(t){var e=new Set,r=function(t,e){var r;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(r=u(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,e=function(){};return{s:e,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:e}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,i=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return o=t.done,t},e:function(t){i=!0,a=t},f:function(){try{o||null==r.return||r.return()}finally{if(i)throw a}}}}(O);try{for(r.s();!(n=r.n()).done;){var n=i(n.value,2),n=(n[0],n[1]),n=t(n.document,n.window);n&&"function"==typeof n[Symbol.iterator]?n.forEach(function(t){return e.add(t)}):n&&e.add(n)}}catch(t){r.e(t)}finally{r.f()}return Array.from(e).filter(function(e){return!a.some(function(t){return e.matches(t)})})}function t(t){var e,r=t.windowObject,n=t.docObject,a=t.isIframe,o=t.frame,t=t.onCollaboration,t=void 0===t?function(){}:t;C.onCollaboration=t,a?(a=o.contentWindow,e={frame:o,window:a,document:a.document||o.contentDocument,isIframe:!0},O.set(o,e)):(e={window:r,document:n,isIframe:!1},O.set("main",e)),e.window.addEventListener("load",function(){e.window.CoCreateObserver.add({observe:["attributes","characterData"],task:f}),e.window.CoCreateObserver.add({name:"ccAttribute",observe:["attributes"],attributes:["data-attribute_target"],task:function(t){return c(t.target)}})}),e.window.HTMLElement.prototype.getAllSelectedOptions=function(){var t=this.querySelectorAll(":scope > [selected]");return Array.from(t).map(function(t){return t.getAttribute("value")})},e.window.HTMLElement.prototype.getAllOptions=function(){var t=this.querySelectorAll(":scope > ul > [value]");return Array.from(t).map(function(t){return t.getAttribute("value")})},e.document.addEventListener("input",function(t){var e,o,i=t.target,r=i.getAttribute("data-attribute_target");r&&(e=s(function(t){return t.querySelector(r)}),o=t.target.getAttribute("data-attribute_sync"),e.forEach(function(a){b(i,function(e,t){var r,n;t&&"checkbox"===t.type?(i[t.read]?y:v)(i,a,e,o):t&&"radio"===t.type?(y(i,a,e,o),n=s(function(t){return t.getElementsByName(i.name)}),-1!==(r=(n=Array.from(n)).indexOf(i))&&delete n[r],n.forEach(function(t){t&&v(t,a,e,o)})):t&&"select"===t.type?(r=g(i,!0),n=g(i,!1),y(i,a,r,o),v(i,a,n,o)):t&&"cocreate-select"===t.type?(t=i.getAllSelectedOptions(),y(i,a,t,o)):(v(i,a,"lastValue",o),y(i,a,e,o))})}))})}function f(t){var a,o;switch(t.type){case"attributes":o=t.attributeName,a=t.target;break;case"characterData":o="innerText",a=t.target.parentElement}!a||a&&a.getAttribute("data-attribute_sync")||s(function(t){return t.querySelectorAll("[data-attribute_target]")}).filter(function(t){if(t.getAttribute("data-attribute_sync")!==o)return!1;var e=t.getAttribute("data-attribute_target");return s(function(t){return t.querySelectorAll(e)}).includes(a)}).forEach(function(r){var n=r.getAttribute("data-attribute_sync");n===o&&b(r,function(t,e){e&&"toggle"===e.class?r.checked=p({input:r,element:a,inputValue:r.getAttribute("value"),read:n}):"SELECT"==r.tagName?h({input:r,element:a,read:n}):"COCREATE-SELECT"==r.tagName?A({input:r,element:a,read:n}):(e=m({element:a,read:n}),r.value.trim()!=e&&(r.lastValue=r.value,r.value=e))})})}function d(t){return t.split?t.split(" ").map(function(t){return t.trim()}):[]}function b(t,e){switch(t.tagName.toLowerCase()){case"input":switch(t.type.toLowerCase()){case"text":case"color":case"date":e("value");break;case"checkbox":e("value",{class:"toggle",type:"checkbox",read:"checked"});break;case"radio":e("value",{class:"toggle",type:"radio",read:"checked"});break;default:e("value")}break;case"select":e("value",{type:"select",class:t.multiple?"multiselect":"select"});break;case"textarea":e("value");break;case"cocreate-select":e("COCREATE-SELECT",{type:"cocreate-select",class:t.multiple?"multiselect":"select"});break;default:null!==t.getAttribute("contenteditable")?e("innerText"):e("value")}}function p(t){t.input;var e=t.element,r=t.inputValue,n=t.read;switch(n){case"style":var a=l(r);return function(t,e){for(var r=0,n=Object.entries(e);r<n.length;r++){var a=i(n[r],2),o=a[0],a=a[1];if(t[o]!==a)return!1}return!0}(e.style,a);case"class":var a=d(r),o=Array.from(e.classList);return a.every(function(t){return o.includes(t)});default:return!!e.getAttribute(n)}}function m(t){var e=t.element,r=t.read;switch(r){case"style":return e.getAttribute(r);case"class":return e.classList.toString();case"innerText":return e.innerText;default:return e.getAttribute(r)}}function y(t,r,e,n,a){a||w({method:"add",values:a="object"===o(e)?e:[t.getAttribute(e)||t[e]],element:r,type:e,read:n}),a.forEach(function(t){switch(n){case"style":if(!t)return;var e=l(t);Object.assign(r.style,e);break;case"class":if(!t)return;t.split(" ").forEach(function(t){return t&&r.classList.add(t)});break;case"innerText":r[n]=t,f({type:"characterData",target:{parentElement:r}});break;default:t?r.setAttribute(n,t):r.removeAttribute(n)}})}function v(t,r,e,n,a){a||w({method:"remove",values:a="object"===o(e)?e:[t.getAttribute(e)||t[e]],element:r,type:e,read:n}),a.forEach(function(t){switch(n){case"style":if(!t)return;var e=l(t);Object.keys(e).forEach(function(t){e[t]&&(r.style[t]="")});break;case"class":if(!t)return;t.split(" ").forEach(function(t){return t&&r.classList.remove(t)})}})}function g(t,e){return Array.from(t.options).filter(function(t){return void 0===e||t.selected==e}).map(function(t){return t.value})}function h(t){for(var e=t.input,r=t.element,n=t.read,a=0,o=e.options.length;a<o;a++)switch(n){case"style":!function(t,e){for(var r=0,n=Object.entries(t);r<n.length;r++){var a=i(n[r],2),o=a[0];a[1];if(t[o]!==e[o]||""===t[o])return}return 1}(l(e.options[a].value),r.style)?e.options[a].selected=!1:e.options[a].selected=!0;break;case"class":r.classList.contains(e.options[a].value)?e.options[a].selected=!0:e.options[a].selected=!1;break;default:r.getAttribute(n)==e.options[a].value?e.options[a].selected=!0:e.options[a].selected=!1}}function A(t){var e,r=t.input,n=t.element,a=t.read;switch(a){case"style":e=(e=n.getAttribute("style")).split?e.split(";").slice(0,-1).map(function(t){return t.trim()}):[],CoCreateSelect.renderValue(r,e);break;case"class":e=d(n.getAttribute("class")),CoCreateSelect.renderValue(r,e);break;default:n.getAttribute(a)&&CoCreateSelect.renderValue(r,n.getAttribute(a))}}function w(t){C.onCollaboration({value:Array.isArray(t.values)?t.values.join(" "):t.values,read:t.read,element:t.element}),CoCreate.sendMessage({broadcast_sender:!1,rooms:"",emit:{message:"ccAttribute",data:r(r({},t),{},{element:t.element.getAttribute("data-element_id")})}})}var a,O,C;a=[],O=new Map,C={},window.ccAttribute={init:t,addFilter:function(t){a.push(t)}},window.addEventListener("load",function(){t({windowObject:window,docObject:document}),window.CoCreateObserver.add({observe:["attributes","characterData"],task:f}),window.CoCreateObserver.add({name:"ccAttribute",observe:["attributes"],attributes:["data-attribute_target"],task:function(t){return c(t.target)}}),s(function(t){return t.querySelectorAll("[data-attribute_target]")}).forEach(c)}),CoCreateSocket.listen("ccAttribute",function(t){var e=t.method,r=t.values,n=t.element,a=t.type,t=t.read,n=s(function(t){return t.querySelector("[data-element_id="+n+"]")})[0];"add"===e?y(null,n,a,t,r):"remove"===e&&v(null,n,a,t,r)})}},a={},function t(e){if(a[e])return a[e].exports;var r=a[e]={exports:{}};return n[e](r,r.exports,t),r.exports}(586).default;var n,a});
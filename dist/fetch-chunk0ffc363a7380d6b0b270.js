/*! For license information please see fetch-chunk0ffc363a7380d6b0b270.js.LICENSE.txt */
(this.webpackChunkCoCreate_attributes=this.webpackChunkCoCreate_attributes||[]).push([["fetch-chunk"],{"../../CoCreateJS/node_modules/@cocreate/fetch/src/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _cocreate_observer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @cocreate/observer */ \"../../CoCreateJS/node_modules/@cocreate/observer/src/index.js\");\n/* harmony import */ var _cocreate_filter__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @cocreate/filter */ \"../../CoCreateJS/node_modules/@cocreate/filter/src/index.js\");\n/* harmony import */ var _cocreate_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @cocreate/utils */ \"../../CoCreateJS/node_modules/@cocreate/utils/src/index.js\");\n/* harmony import */ var _cocreate_cocreatejs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @cocreate/cocreatejs */ \"../../CoCreateJS/node_modules/@cocreate/cocreatejs/src/index.js\");\n/* harmony import */ var _cocreate_crud_src_utils_crud_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @cocreate/crud/src/utils.crud.js */ \"../../CoCreateJS/node_modules/@cocreate/crud/src/utils.crud.js\");\n/* harmony import */ var _cocreate_logic__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @cocreate/logic */ \"../../CoCreateJS/node_modules/@cocreate/logic/src/index.js\");\n/* harmony import */ var _cocreate_render__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @cocreate/render */ \"../../CoCreateJS/node_modules/@cocreate/render/src/index.js\");\n\n\n\n\n// import CoCreateSocket from '@cocreate/socket';\n// import CoCreateCrud from '@cocreate/crud';\n\n\n\n\n// let socket = new CoCreateSocket('ws');\n// let crud = CoCreateCrud(socket);\n\nconsole.log(_cocreate_cocreatejs__WEBPACK_IMPORTED_MODULE_3__.socket)\nconst CoCreateFetch = {\n\tselector: '[data-template_id][data-fetch_collection]',\n\titems: [],\n\n\tinit: function() {\n\t\tthis.initElement();\n\t\tthis.__initSocketEvent();\n\t\tthis.__initEvents()\n\t},\n\t\n\tinitElement: function(container) {\n\t\t\n\t\tlet mainContainer = container || document;\n\t\tconst self = this;\n\t\tif (!mainContainer.querySelectorAll) {\n\t\t\treturn;     \n\t\t}\n\t\tlet wrappers = mainContainer.querySelectorAll(this.selector);\n\t\tif (wrappers.length == 0 && mainContainer != document && mainContainer.hasAttribute('data-template_id') && mainContainer.hasAttribute('data-fetch_collection')) {\n\t\t\twrappers = [mainContainer];\n\t\t}\n\t\twrappers.forEach((wrapper) => {\n\t\t\tself.__initEachElement(wrapper, true, true)\n\t\t})\n\t},\n\t\n\trefershElement: function(mutation ) {\n\t\tconst { target } = mutation;\n\t\tif (!target) return;\n\t\tif (!target.hasAttribute('data-fetch_collection')) return;\n\t\t\n\t\tthis.__initEachElement(target, false, false, true);\n\t\t\n\t},\n\t\n\t//. public functions....\n\treload: function(element) {\n\t\treturn;\n\t\tif (!element || !element.getAttribute) {\n\t\t\treturn;\n\t\t}\n\t\tif (element.hasAttribute('date-template_id') && element.hasAttribute('date-fetch_collection')) {\n\t\t\tthis.__initEachElement(element, true)\n\t\t}\n\t},\n\t\n\t__initSocketEvent: function() {\n\t\tconst self = this;\n\t\t_cocreate_cocreatejs__WEBPACK_IMPORTED_MODULE_3__.socket.listen('readDocumentList', function(data) {\n\t\t\tself.__fetchedItem(data)\n\t\t})\n\t\t_cocreate_cocreatejs__WEBPACK_IMPORTED_MODULE_3__.socket.listen('readCollectionList', function(data) {\n\t\t\tself.__fetchedItem(data)\n\t\t})\n\t\t\n\t\t_cocreate_cocreatejs__WEBPACK_IMPORTED_MODULE_3__.socket.listen('createDocument', function(data) {\n\t\t\tself.__createItem(data)\n\t\t})\n\t\n\t\t_cocreate_cocreatejs__WEBPACK_IMPORTED_MODULE_3__.socket.listen('deleteDocument', function(data) {\n\t\t\tself.__deleteItem(data);\n\t\t})\n\t},\n\t\n\t__initEvents: function() {\n\t\tconst self = this;\n\t\twindow.addEventListener('dndsuccess', function(e) {\n\t\t\tconst {dropedEl, dragedEl} = e.detail;\n\t\t\tlet dragedElTemplatId = dragedEl.getAttribute('data-template_id')\n\t\t\tlet dragElTemplate = document.querySelector(`[data-fetch_collection][data-template_id='${dragedElTemplatId}']`);\n\t\t\tlet dropElTemplate = self.findTemplateElByChild(dropedEl);\n\t\t\t\n\t\t\tif (!dragElTemplate || !dropElTemplate) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t\n\t\t\tif (!dragElTemplate.isSameNode(dropElTemplate)) {\n\t\t\t\t//. save template id\n\t\t\t\tself.updateParentTemplateOfChild(dropElTemplate, dragedEl)\n\t\t\t\t\n\t\t\t\t//. reordering\n\t\t\t\tself.reorderChildrenOfTemplate(dragElTemplate);\n\t\t\t\tself.reorderChildrenOfTemplate(dropElTemplate);\n\t\t\t} else {\n\t\t\t\tself.reorderChildrenOfTemplate(dropElTemplate);\n\t\t\t}\n\t\t})\n\t},\n\t\n\t__initEachElement: function(element, isInit, checkInit, refresh) {\n\t\tlet item_id = element.getAttribute('data-template_id');\n\t\tif (!item_id) return;\n\t\t\n\t\tif (!element.getAttribute('data-fetch_collection')) return;\n\t\t\n\t\tif (_cocreate_observer__WEBPACK_IMPORTED_MODULE_0__.default.getInitialized(element, 'fetch') && isInit){\n\t\t\treturn;\t\n\t\t} \n\t\t\n\t\tlet item = _cocreate_filter__WEBPACK_IMPORTED_MODULE_1__.default.getObjectByFilterId(this.items, item_id);\n\t\tlet filter = null;\n\t\tconst self = this;\n\t\t\n\t\tif (isInit && item) {\n\t\t\treturn;\n\t\t}\n\t\t\n\t\t// if (checkInit) {  \n\t\t\t_cocreate_observer__WEBPACK_IMPORTED_MODULE_0__.default.setInitialized(element, 'fetch')\n\t\t// }\n\n\t\tif (!item) {\n\t\t\tfilter = _cocreate_filter__WEBPACK_IMPORTED_MODULE_1__.default.setFilter(element, \"data-template_id\", \"template\");\n\t\t\tlet fetch_type = element.getAttribute('data-fetch_value_type') || \"string\";\n\t\t\tif (!filter) return;\n\t\t\t\n\t\t\tif (fetch_type === 'collection') {\n\t\t\t\tfilter.is_collection = true;\n\t\t\t}\n\t\t\t\n\t\t\titem = {\n\t\t\t\tel: element,\n\t\t\t\tfilter: filter,\n\t\t\t\ttemplateId: item_id,\n\t\t\t\tfetch_type: fetch_type\n\t\t\t}\n\t\t\t\n\t\t\tthis.items.push(item);\n\n\t\t\telement.addEventListener(\"changeFilterInput\", function(e) {\n\t\t\t\tself.__removeOldData(item.el)\n\t\t\t\titem.filter.startIndex = 0;\n\t\t\t\titem.filter.isRefresh = true;\n\t\t\t\t_cocreate_filter__WEBPACK_IMPORTED_MODULE_1__.default.fetchData(item.filter);\n\t\t\t})\n\t\t\t\n\t\t} else {\n\t\t\tfilter = item.filter\n\t\t\t_cocreate_filter__WEBPACK_IMPORTED_MODULE_1__.default.changeCollection(filter);\n\t\t\tif (refresh) {\n\t\t\t\titem.filter.isRefresh = true;\n\t\t\t\tself.__removeOldData(element);\n\t\t\t\tfilter.isRefresh = true;\n\t\t\t\tfilter.startIndex = 0;\n\t\t\t}\n\t\t}\n\t\t\n\t\t_cocreate_filter__WEBPACK_IMPORTED_MODULE_1__.default.fetchData(filter);\n\t},\n\t\n\t__runLoadMore: function(templateId) {\n\t\tif (!templateId) return;\n\t\tlet item = _cocreate_filter__WEBPACK_IMPORTED_MODULE_1__.default.getObjectByFilterId(this.items, templateId);\n\t\t\n\t\tif (!item) return;\n\t\tif (item.filter.count > 0) {\n\t\t\t_cocreate_filter__WEBPACK_IMPORTED_MODULE_1__.default.fetchData(item.filter)\n\t\t}\n\t},\n\t\n\t__removeOldData: function(wrapper) {\n\t\tlet item_id = wrapper.getAttribute('data-template_id');\n\t\tlet elements = wrapper.querySelectorAll(\"[templateId='\" + item_id + \"']\");\n\t\telements.forEach((el) => el.remove())\n\t},\n\t\n\t__cloneElement: function(clone_node, templateId, type) {\n\t\tlet itemTemplateDiv = document.createElement(clone_node.parentNode.tagName || 'div');\n\t\t// let itemTemplateDiv = document.createElement('tbody');\n\t\tlet template = clone_node.cloneNode(true);\n\t\ttemplate.setAttribute('templateId', templateId);\n\n\t\tif (!type) type = \"data\"\n\t\tif (!template.getAttribute('data-render_array')) {\n\t\t\ttemplate.setAttribute('data-render_array', type);\n\t\t}\n\t\t\n\t\titemTemplateDiv.appendChild(template.cloneNode(true));\n\t\treturn itemTemplateDiv;\n\t},\n\t\n\t__renderData: function(wrapper, data, type = \"data\") {\n\n\t\tlet templateId = wrapper.getAttribute('data-template_id');\n\t\tlet template = wrapper.querySelector(`.template[data-template_id='${templateId}'`);// || wrapper.querySelector('.template');\n\t\t// let template = wrapper.querySelector('.template');\n\t\tif (!template)  {\n\t\t\treturn;\n\t\t}\n\t\tlet renderId = wrapper.getAttribute('data-render_id');\n\t\t\n\t\tlet passTo = wrapper.getAttribute('data-pass_to');\n\t\tlet renderData = renderId ? {[renderId] : data} : data;\n\t\t\n\t\ttype = type || \"data\";\n\t\ttype = renderId ? `${renderId}.${type}` : type;\n\n\t\tlet cloneWrapper = this.__cloneElement(template, templateId, type);\n\t\t\n\t\t// render.setValue(cloneWrapper.children, renderData, passTo, cloneWrapper);\n\t\t\n\t\t_cocreate_render__WEBPACK_IMPORTED_MODULE_6__.default.data({\n\t\t\telements: cloneWrapper.children,\n\t\t\tdata: renderData,\n\t\t\tpassTo: passTo\n\t\t})\n\t\tlet removeableTemplate = cloneWrapper.querySelector(`.template[data-template_id=\"${templateId}\"]`);\n\t\tif (removeableTemplate) {\n\t\t\tremoveableTemplate.remove();\n\t\t} else {\n\t\t\treturn;\n\t\t}\n\n\t\ttemplate.insertAdjacentHTML('beforebegin', cloneWrapper.innerHTML);\n\t\tvar evt = new CustomEvent('fetchedTemplate', { bubbles: true });\n\t\twrapper.dispatchEvent(evt);\n\n\t\t/// init passValueBtns\n\t\tlet forms = wrapper.parentNode.getElementsByTagName('form');\n\t\t\n\t\tfor (let i = 0; i < forms.length; i++) {\n\t\t\tlet form = forms[i];\n\t\t\tlet valuePassBtn = form.querySelector('.passValueBtn');\n\t\t\tif (valuePassBtn) _cocreate_logic__WEBPACK_IMPORTED_MODULE_5__.default.__registerValuePassBtnEvent(form, valuePassBtn);\n\t\t}\n\t\t\n\t\t// this.initElement(wrapper)\n\t},\n\n\t__deleteItem: function(data) {\n\t\tlet collection = data['collection'];\n\t\tlet document_id = data['document_id'];\n\t\t\n\t\tfor (let i = 0; i < this.items.length; i++) {\n\t\t\tlet item = this.items[i];\n\t\t\t\n\t\t\tif (item.filter.collection == collection) {\n\t\t\t\tvar tmpId = item.el.getAttribute('data-template_id')\n\t\t\t\tvar els = item.el.querySelectorAll(\"[templateId='\" + tmpId + \"'][data-document_id='\" + document_id + \"']\");\n\t\t\t\tfor (let j = 0; j < els.length; j++) {\n\t\t\t\t\tels[j].remove();\n\t\t\t\t\titem.startIndex--;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\t\n\t__fetchedItem: function(data) {\n\t\tlet item_id = data['element'];\n\t\tlet item = _cocreate_filter__WEBPACK_IMPORTED_MODULE_1__.default.getObjectByFilterId(this.items, item_id);\n\t\tif (item) {\n\t\t\titem.filter.startIndex += data['data'].length;\n\t\t\tlet fetch_name = item.el.getAttribute('data-fetch_name');\n\t\t\tif (fetch_name) {\n\t\t\t\tdata = data.data[0];\n\t\t\t}\n\t\t\t\n\t\t\tif (data) {\n\t\t\t\tif (data.metadata && data.metadata.isRefresh) {\n\t\t\t\t\tthis.__removeOldData(item.el);\n\t\t\t\t}\n\t\t\t\tthis.__renderData(item.el, data, fetch_name);\n\t\t\t}\n\t\t\t\n\t\t}\n\t},\n\n\t__createItem: function(data) {\n\t\tlet collection = data['collection'];\n\t\tconst self = this;\n\t\tlet itemData = data.data;\n\t\tlet render_data = data;\n\t\trender_data.data = [itemData];\n\n\t\tthis.items.forEach((item) => {\n\t\t\tconst {filter} = item;\n\t\t\tlet ids = [];\n\t\t\titem.fetch_ids = [];\n\t\t\tif (filter.collection === collection && !item.el.getAttribute('data-fetch_name') && self.__checkItemByFilters(itemData, filter.filters)) {\n\t\t\t\t// ids.push(data['document_id']);\n\t\t\t\tself.__renderData(item.el, render_data)\n\t\t\t}\n\t\t})\n\t},\n\n\tfindTemplateElByChild: function(element) {\n\t\treturn _cocreate_utils__WEBPACK_IMPORTED_MODULE_2__.default.getParentFromElement(element, null, ['data-template_id', 'data-fetch_collection']);\n\t},\n\t\n\tupdateParentTemplateOfChild: function(template, element) {\n\t\tconst name = template.getAttribute('data-filter_name')\n\t\tconst value = template.getAttribute('data-filter_value')\n\t\tconst operator = template.getAttribute('data-filter_operator')\n\t\tif (!name || operator != \"$eq\") return;\n\n\t\t_cocreate_cocreatejs__WEBPACK_IMPORTED_MODULE_3__.crud.updateDocument({\n\t\t\tcollection\t: template.getAttribute('data-fetch_collection'), \n\t\t\tdocument_id : element.getAttribute('data-document_id'), \n\t\t\tdata: {\n\t\t\t\t[name]: value\t\n\t\t\t},\n\t\t\tbroadcast\t: false\n\t\t})\n\t},\n\t\n\treorderChildrenOfTemplate: function (template) {\n\t\tconst orderField = template.getAttribute('data-order_by')\n\t\tconst template_id = template.getAttribute('data-template_id')\n\t\tif (!orderField || !template_id) {\n\t\t\treturn;\n\t\t}\n\t\tconst children = template.querySelectorAll(`[data-template_id=\"${template_id}\"][data-document_id]:not(.template)`)\n\t\t\n\t\tconst coff = template.getAttribute('data-order_type') !== 'asc' ? -1 : 1;\n\t\tchildren.forEach((item, index) => {\n\t\t\tif (item.classList.contains('template')) {\n\t\t\t\treturn\n\t\t\t}\n\t\t\t_cocreate_cocreatejs__WEBPACK_IMPORTED_MODULE_3__.crud.updateDocument({\n\t\t\t\tcollection : template.getAttribute('data-fetch_collection'), \n\t\t\t\tdocument_id : item.getAttribute('data-document_id'), \n\t\t\t\tdata: {\n\t\t\t\t\t[orderField]: index * coff\t\n\t\t\t\t},\n\t\t\t\tbroadcast: false,\n\t\t\t})\n\t\t})\n\t},\n\t\n\t__checkItemByFilters: function(item, filters) {\n\t\t//. $contain, $range, $eq, $ne, $lt, $lte, $gt, $gte, $in, $nin, $geoWithin\n\t\tlet flag = true;\n\t\tif (!item || !filters) {\n\t\t\treturn false;\n\t\t}\n\t\t\n\t\tif (Array.isArray(item)) return false;\n\t\tfilters.forEach(({name, operator, type, value}) => {\n\t\t\t\n\t\t\tconst fieldValue = item[name]\n\t\t\tif (!flag) return;\n\t\t\t\n\t\t\tswitch (operator) {\n\t\t\t\tcase '$contain':\n\t\t\t\t\tif (!Array.isArray(fieldValue) || !fieldValue.some(x => value.includes(x))) flag = false;\n\t\t\t\t\tbreak;\n\t\t\t\tcase '$range':\n\t\t\t\t\tif (value[0] !== null && value[1] !== null) {\n\t\t\t\t\t\tif (value[0] > fieldValue || value[1] <= fieldValue)\n\t\t\t\t\t\t\tflag = false;\n\t\t\t\t\t} else if (item.value[0] == null && value[1] >= fieldValue) {\n\t\t\t\t\t\tflag = false;\n\t\t\t\t\t} else if (item.value[1] == null && value[0] <= fieldValue) {\n\t\t\t\t\t\tflag = false;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase '$eq':\n\t\t\t\t\tif (fieldValue != value[0]) flag = false; \n\t\t\t\t\tbreak;\n\t\t\t\tcase '$ne':\n\t\t\t\t\tif (fieldValue == null || fieldValue == value[0]) flag = false;\n\t\t\t\t\tbreak;\n\t\t\t\tcase '$lt':\n\t\t\t\t\tif (fieldValue >= value[0]) flag = false;\n\t\t\t\t\tbreak;\n\t\t\t\tcase '$lte':\n\t\t\t\t\tif (fieldValue > value[0]) flag = false;\n\t\t\t\t\tbreak;\n\t\t\t\tcase '$gt':\n\t\t\t\t\tif (fieldValue <= value[0]) flag = false;\n\t\t\t\t\tbreak;\n\t\t\t\tcase '$gte':\n\t\t\t\t\tif (fieldValue < value[0]) flag = false;\n\t\t\t\t\tbreak;\n\t\t\t\tcase '$in':\n\t\t\t\t\tif (!Array.isArray(fieldValue) || !fieldValue.some(x => value.includes(x))) flag = false;\n\t\t\t\t\tbreak;\n\t\t\t\tcase '$nin':\n\t\t\t\t\tif (Array.isArray(fieldValue) && fieldValue.some(x => value.includes(x))) flag = false;\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\t\t})\n\t\treturn flag;\n\t}\n}\n\n\n\n_cocreate_observer__WEBPACK_IMPORTED_MODULE_0__.default.init({ \n\tname: 'CoCreateFetchObserver', \n\tobserve: ['attributes'],\n\tattributes: ['data-fetch_collection', 'data-filter_name'],\n\tcallback: function(mutation) {\n\t\tCoCreateFetch.refershElement(mutation)\n\t}\n})\n\n_cocreate_observer__WEBPACK_IMPORTED_MODULE_0__.default.init({ \n\tname: 'CoCreateFetchInit', \n\tobserve: ['subtree', 'childList'],\n\tinclude: \"[data-fetch_collection]\",\n\tcallback: function(mutation) {\n\t\tCoCreateFetch.initElement(mutation.target)\n\t}\n})\n\nCoCreateFetch.init();\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (CoCreateFetch);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9Db0NyZWF0ZS5hdHRyaWJ1dGVzLy4uLy4uL0NvQ3JlYXRlSlMvbm9kZV9tb2R1bGVzL0Bjb2NyZWF0ZS9mZXRjaC9zcmMvaW5kZXguanM/MzQ4NiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUF5QztBQUNGO0FBQ0g7QUFDYztBQUNsRDtBQUNBO0FBQ3dEO0FBQ3BCO0FBQ0U7O0FBRXRDO0FBQ0E7O0FBRUEsWUFBWSx3REFBTTtBQUNsQjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFOztBQUVGOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSCxFQUFFOztBQUVGO0FBQ0EsU0FBUyxTQUFTO0FBQ2xCO0FBQ0E7O0FBRUE7O0FBRUEsRUFBRTs7QUFFRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQSxFQUFFLCtEQUFhO0FBQ2Y7QUFDQSxHQUFHO0FBQ0gsRUFBRSwrREFBYTtBQUNmO0FBQ0EsR0FBRzs7QUFFSCxFQUFFLCtEQUFhO0FBQ2Y7QUFDQSxHQUFHOztBQUVILEVBQUUsK0RBQWE7QUFDZjtBQUNBLEdBQUc7QUFDSCxFQUFFOztBQUVGO0FBQ0E7QUFDQTtBQUNBLFVBQVUsbUJBQW1CO0FBQzdCO0FBQ0EsNEZBQTRGLGtCQUFrQjtBQUM5Rzs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0EsR0FBRztBQUNILEVBQUU7O0FBRUY7QUFDQTtBQUNBOztBQUVBOztBQUVBLE1BQU0sc0VBQXVCO0FBQzdCLFU7QUFDQSxHOztBQUVBLGFBQWEseUVBQTRCO0FBQ3pDO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBLHFCO0FBQ0EsR0FBRyxzRUFBdUI7QUFDMUI7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aWxlIjoiLi4vLi4vQ29DcmVhdGVKUy9ub2RlX21vZHVsZXMvQGNvY3JlYXRlL2ZldGNoL3NyYy9pbmRleC5qcy5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBvYnNlcnZlciBmcm9tICdAY29jcmVhdGUvb2JzZXJ2ZXInXG5pbXBvcnQgY2NmaWx0ZXIgZnJvbSAnQGNvY3JlYXRlL2ZpbHRlcidcbmltcG9ydCB1dGlscyBmcm9tICdAY29jcmVhdGUvdXRpbHMnO1xuaW1wb3J0IHtzb2NrZXQsIGNydWR9IGZyb20gJ0Bjb2NyZWF0ZS9jb2NyZWF0ZWpzJztcbi8vIGltcG9ydCBDb0NyZWF0ZVNvY2tldCBmcm9tICdAY29jcmVhdGUvc29ja2V0Jztcbi8vIGltcG9ydCBDb0NyZWF0ZUNydWQgZnJvbSAnQGNvY3JlYXRlL2NydWQnO1xuaW1wb3J0IGNydWRVdGlscyBmcm9tICdAY29jcmVhdGUvY3J1ZC9zcmMvdXRpbHMuY3J1ZC5qcydcbmltcG9ydCBsb2dpYyBmcm9tICdAY29jcmVhdGUvbG9naWMnO1xuaW1wb3J0IHJlbmRlciBmcm9tICdAY29jcmVhdGUvcmVuZGVyJztcblxuLy8gbGV0IHNvY2tldCA9IG5ldyBDb0NyZWF0ZVNvY2tldCgnd3MnKTtcbi8vIGxldCBjcnVkID0gQ29DcmVhdGVDcnVkKHNvY2tldCk7XG5cbmNvbnNvbGUubG9nKHNvY2tldClcbmNvbnN0IENvQ3JlYXRlRmV0Y2ggPSB7XG5cdHNlbGVjdG9yOiAnW2RhdGEtdGVtcGxhdGVfaWRdW2RhdGEtZmV0Y2hfY29sbGVjdGlvbl0nLFxuXHRpdGVtczogW10sXG5cblx0aW5pdDogZnVuY3Rpb24oKSB7XG5cdFx0dGhpcy5pbml0RWxlbWVudCgpO1xuXHRcdHRoaXMuX19pbml0U29ja2V0RXZlbnQoKTtcblx0XHR0aGlzLl9faW5pdEV2ZW50cygpXG5cdH0sXG5cdFxuXHRpbml0RWxlbWVudDogZnVuY3Rpb24oY29udGFpbmVyKSB7XG5cdFx0XG5cdFx0bGV0IG1haW5Db250YWluZXIgPSBjb250YWluZXIgfHwgZG9jdW1lbnQ7XG5cdFx0Y29uc3Qgc2VsZiA9IHRoaXM7XG5cdFx0aWYgKCFtYWluQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3JBbGwpIHtcblx0XHRcdHJldHVybjsgICAgIFxuXHRcdH1cblx0XHRsZXQgd3JhcHBlcnMgPSBtYWluQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5zZWxlY3Rvcik7XG5cdFx0aWYgKHdyYXBwZXJzLmxlbmd0aCA9PSAwICYmIG1haW5Db250YWluZXIgIT0gZG9jdW1lbnQgJiYgbWFpbkNvbnRhaW5lci5oYXNBdHRyaWJ1dGUoJ2RhdGEtdGVtcGxhdGVfaWQnKSAmJiBtYWluQ29udGFpbmVyLmhhc0F0dHJpYnV0ZSgnZGF0YS1mZXRjaF9jb2xsZWN0aW9uJykpIHtcblx0XHRcdHdyYXBwZXJzID0gW21haW5Db250YWluZXJdO1xuXHRcdH1cblx0XHR3cmFwcGVycy5mb3JFYWNoKCh3cmFwcGVyKSA9PiB7XG5cdFx0XHRzZWxmLl9faW5pdEVhY2hFbGVtZW50KHdyYXBwZXIsIHRydWUsIHRydWUpXG5cdFx0fSlcblx0fSxcblx0XG5cdHJlZmVyc2hFbGVtZW50OiBmdW5jdGlvbihtdXRhdGlvbiApIHtcblx0XHRjb25zdCB7IHRhcmdldCB9ID0gbXV0YXRpb247XG5cdFx0aWYgKCF0YXJnZXQpIHJldHVybjtcblx0XHRpZiAoIXRhcmdldC5oYXNBdHRyaWJ1dGUoJ2RhdGEtZmV0Y2hfY29sbGVjdGlvbicpKSByZXR1cm47XG5cdFx0XG5cdFx0dGhpcy5fX2luaXRFYWNoRWxlbWVudCh0YXJnZXQsIGZhbHNlLCBmYWxzZSwgdHJ1ZSk7XG5cdFx0XG5cdH0sXG5cdFxuXHQvLy4gcHVibGljIGZ1bmN0aW9ucy4uLi5cblx0cmVsb2FkOiBmdW5jdGlvbihlbGVtZW50KSB7XG5cdFx0cmV0dXJuO1xuXHRcdGlmICghZWxlbWVudCB8fCAhZWxlbWVudC5nZXRBdHRyaWJ1dGUpIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0aWYgKGVsZW1lbnQuaGFzQXR0cmlidXRlKCdkYXRlLXRlbXBsYXRlX2lkJykgJiYgZWxlbWVudC5oYXNBdHRyaWJ1dGUoJ2RhdGUtZmV0Y2hfY29sbGVjdGlvbicpKSB7XG5cdFx0XHR0aGlzLl9faW5pdEVhY2hFbGVtZW50KGVsZW1lbnQsIHRydWUpXG5cdFx0fVxuXHR9LFxuXHRcblx0X19pbml0U29ja2V0RXZlbnQ6IGZ1bmN0aW9uKCkge1xuXHRcdGNvbnN0IHNlbGYgPSB0aGlzO1xuXHRcdHNvY2tldC5saXN0ZW4oJ3JlYWREb2N1bWVudExpc3QnLCBmdW5jdGlvbihkYXRhKSB7XG5cdFx0XHRzZWxmLl9fZmV0Y2hlZEl0ZW0oZGF0YSlcblx0XHR9KVxuXHRcdHNvY2tldC5saXN0ZW4oJ3JlYWRDb2xsZWN0aW9uTGlzdCcsIGZ1bmN0aW9uKGRhdGEpIHtcblx0XHRcdHNlbGYuX19mZXRjaGVkSXRlbShkYXRhKVxuXHRcdH0pXG5cdFx0XG5cdFx0c29ja2V0Lmxpc3RlbignY3JlYXRlRG9jdW1lbnQnLCBmdW5jdGlvbihkYXRhKSB7XG5cdFx0XHRzZWxmLl9fY3JlYXRlSXRlbShkYXRhKVxuXHRcdH0pXG5cdFxuXHRcdHNvY2tldC5saXN0ZW4oJ2RlbGV0ZURvY3VtZW50JywgZnVuY3Rpb24oZGF0YSkge1xuXHRcdFx0c2VsZi5fX2RlbGV0ZUl0ZW0oZGF0YSk7XG5cdFx0fSlcblx0fSxcblx0XG5cdF9faW5pdEV2ZW50czogZnVuY3Rpb24oKSB7XG5cdFx0Y29uc3Qgc2VsZiA9IHRoaXM7XG5cdFx0d2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2RuZHN1Y2Nlc3MnLCBmdW5jdGlvbihlKSB7XG5cdFx0XHRjb25zdCB7ZHJvcGVkRWwsIGRyYWdlZEVsfSA9IGUuZGV0YWlsO1xuXHRcdFx0bGV0IGRyYWdlZEVsVGVtcGxhdElkID0gZHJhZ2VkRWwuZ2V0QXR0cmlidXRlKCdkYXRhLXRlbXBsYXRlX2lkJylcblx0XHRcdGxldCBkcmFnRWxUZW1wbGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYFtkYXRhLWZldGNoX2NvbGxlY3Rpb25dW2RhdGEtdGVtcGxhdGVfaWQ9JyR7ZHJhZ2VkRWxUZW1wbGF0SWR9J11gKTtcblx0XHRcdGxldCBkcm9wRWxUZW1wbGF0ZSA9IHNlbGYuZmluZFRlbXBsYXRlRWxCeUNoaWxkKGRyb3BlZEVsKTtcblx0XHRcdFxuXHRcdFx0aWYgKCFkcmFnRWxUZW1wbGF0ZSB8fCAhZHJvcEVsVGVtcGxhdGUpIHtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHRpZiAoIWRyYWdFbFRlbXBsYXRlLmlzU2FtZU5vZGUoZHJvcEVsVGVtcGxhdGUpKSB7XG5cdFx0XHRcdC8vLiBzYXZlIHRlbXBsYXRlIGlkXG5cdFx0XHRcdHNlbGYudXBkYXRlUGFyZW50VGVtcGxhdGVPZkNoaWxkKGRyb3BFbFRlbXBsYXRlLCBkcmFnZWRFbClcblx0XHRcdFx0XG5cdFx0XHRcdC8vLiByZW9yZGVyaW5nXG5cdFx0XHRcdHNlbGYucmVvcmRlckNoaWxkcmVuT2ZUZW1wbGF0ZShkcmFnRWxUZW1wbGF0ZSk7XG5cdFx0XHRcdHNlbGYucmVvcmRlckNoaWxkcmVuT2ZUZW1wbGF0ZShkcm9wRWxUZW1wbGF0ZSk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRzZWxmLnJlb3JkZXJDaGlsZHJlbk9mVGVtcGxhdGUoZHJvcEVsVGVtcGxhdGUpO1xuXHRcdFx0fVxuXHRcdH0pXG5cdH0sXG5cdFxuXHRfX2luaXRFYWNoRWxlbWVudDogZnVuY3Rpb24oZWxlbWVudCwgaXNJbml0LCBjaGVja0luaXQsIHJlZnJlc2gpIHtcblx0XHRsZXQgaXRlbV9pZCA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKCdkYXRhLXRlbXBsYXRlX2lkJyk7XG5cdFx0aWYgKCFpdGVtX2lkKSByZXR1cm47XG5cdFx0XG5cdFx0aWYgKCFlbGVtZW50LmdldEF0dHJpYnV0ZSgnZGF0YS1mZXRjaF9jb2xsZWN0aW9uJykpIHJldHVybjtcblx0XHRcblx0XHRpZiAob2JzZXJ2ZXIuZ2V0SW5pdGlhbGl6ZWQoZWxlbWVudCwgJ2ZldGNoJykgJiYgaXNJbml0KXtcblx0XHRcdHJldHVybjtcdFxuXHRcdH0gXG5cdFx0XG5cdFx0bGV0IGl0ZW0gPSBjY2ZpbHRlci5nZXRPYmplY3RCeUZpbHRlcklkKHRoaXMuaXRlbXMsIGl0ZW1faWQpO1xuXHRcdGxldCBmaWx0ZXIgPSBudWxsO1xuXHRcdGNvbnN0IHNlbGYgPSB0aGlzO1xuXHRcdFxuXHRcdGlmIChpc0luaXQgJiYgaXRlbSkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHRcblx0XHQvLyBpZiAoY2hlY2tJbml0KSB7ICBcblx0XHRcdG9ic2VydmVyLnNldEluaXRpYWxpemVkKGVsZW1lbnQsICdmZXRjaCcpXG5cdFx0Ly8gfVxuXG5cdFx0aWYgKCFpdGVtKSB7XG5cdFx0XHRmaWx0ZXIgPSBjY2ZpbHRlci5zZXRGaWx0ZXIoZWxlbWVudCwgXCJkYXRhLXRlbXBsYXRlX2lkXCIsIFwidGVtcGxhdGVcIik7XG5cdFx0XHRsZXQgZmV0Y2hfdHlwZSA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKCdkYXRhLWZldGNoX3ZhbHVlX3R5cGUnKSB8fCBcInN0cmluZ1wiO1xuXHRcdFx0aWYgKCFmaWx0ZXIpIHJldHVybjtcblx0XHRcdFxuXHRcdFx0aWYgKGZldGNoX3R5cGUgPT09ICdjb2xsZWN0aW9uJykge1xuXHRcdFx0XHRmaWx0ZXIuaXNfY29sbGVjdGlvbiA9IHRydWU7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdGl0ZW0gPSB7XG5cdFx0XHRcdGVsOiBlbGVtZW50LFxuXHRcdFx0XHRmaWx0ZXI6IGZpbHRlcixcblx0XHRcdFx0dGVtcGxhdGVJZDogaXRlbV9pZCxcblx0XHRcdFx0ZmV0Y2hfdHlwZTogZmV0Y2hfdHlwZVxuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHR0aGlzLml0ZW1zLnB1c2goaXRlbSk7XG5cblx0XHRcdGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNoYW5nZUZpbHRlcklucHV0XCIsIGZ1bmN0aW9uKGUpIHtcblx0XHRcdFx0c2VsZi5fX3JlbW92ZU9sZERhdGEoaXRlbS5lbClcblx0XHRcdFx0aXRlbS5maWx0ZXIuc3RhcnRJbmRleCA9IDA7XG5cdFx0XHRcdGl0ZW0uZmlsdGVyLmlzUmVmcmVzaCA9IHRydWU7XG5cdFx0XHRcdGNjZmlsdGVyLmZldGNoRGF0YShpdGVtLmZpbHRlcik7XG5cdFx0XHR9KVxuXHRcdFx0XG5cdFx0fSBlbHNlIHtcblx0XHRcdGZpbHRlciA9IGl0ZW0uZmlsdGVyXG5cdFx0XHRjY2ZpbHRlci5jaGFuZ2VDb2xsZWN0aW9uKGZpbHRlcik7XG5cdFx0XHRpZiAocmVmcmVzaCkge1xuXHRcdFx0XHRpdGVtLmZpbHRlci5pc1JlZnJlc2ggPSB0cnVlO1xuXHRcdFx0XHRzZWxmLl9fcmVtb3ZlT2xkRGF0YShlbGVtZW50KTtcblx0XHRcdFx0ZmlsdGVyLmlzUmVmcmVzaCA9IHRydWU7XG5cdFx0XHRcdGZpbHRlci5zdGFydEluZGV4ID0gMDtcblx0XHRcdH1cblx0XHR9XG5cdFx0XG5cdFx0Y2NmaWx0ZXIuZmV0Y2hEYXRhKGZpbHRlcik7XG5cdH0sXG5cdFxuXHRfX3J1bkxvYWRNb3JlOiBmdW5jdGlvbih0ZW1wbGF0ZUlkKSB7XG5cdFx0aWYgKCF0ZW1wbGF0ZUlkKSByZXR1cm47XG5cdFx0bGV0IGl0ZW0gPSBjY2ZpbHRlci5nZXRPYmplY3RCeUZpbHRlcklkKHRoaXMuaXRlbXMsIHRlbXBsYXRlSWQpO1xuXHRcdFxuXHRcdGlmICghaXRlbSkgcmV0dXJuO1xuXHRcdGlmIChpdGVtLmZpbHRlci5jb3VudCA+IDApIHtcblx0XHRcdGNjZmlsdGVyLmZldGNoRGF0YShpdGVtLmZpbHRlcilcblx0XHR9XG5cdH0sXG5cdFxuXHRfX3JlbW92ZU9sZERhdGE6IGZ1bmN0aW9uKHdyYXBwZXIpIHtcblx0XHRsZXQgaXRlbV9pZCA9IHdyYXBwZXIuZ2V0QXR0cmlidXRlKCdkYXRhLXRlbXBsYXRlX2lkJyk7XG5cdFx0bGV0IGVsZW1lbnRzID0gd3JhcHBlci5xdWVyeVNlbGVjdG9yQWxsKFwiW3RlbXBsYXRlSWQ9J1wiICsgaXRlbV9pZCArIFwiJ11cIik7XG5cdFx0ZWxlbWVudHMuZm9yRWFjaCgoZWwpID0+IGVsLnJlbW92ZSgpKVxuXHR9LFxuXHRcblx0X19jbG9uZUVsZW1lbnQ6IGZ1bmN0aW9uKGNsb25lX25vZGUsIHRlbXBsYXRlSWQsIHR5cGUpIHtcblx0XHRsZXQgaXRlbVRlbXBsYXRlRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChjbG9uZV9ub2RlLnBhcmVudE5vZGUudGFnTmFtZSB8fCAnZGl2Jyk7XG5cdFx0Ly8gbGV0IGl0ZW1UZW1wbGF0ZURpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3Rib2R5Jyk7XG5cdFx0bGV0IHRlbXBsYXRlID0gY2xvbmVfbm9kZS5jbG9uZU5vZGUodHJ1ZSk7XG5cdFx0dGVtcGxhdGUuc2V0QXR0cmlidXRlKCd0ZW1wbGF0ZUlkJywgdGVtcGxhdGVJZCk7XG5cblx0XHRpZiAoIXR5cGUpIHR5cGUgPSBcImRhdGFcIlxuXHRcdGlmICghdGVtcGxhdGUuZ2V0QXR0cmlidXRlKCdkYXRhLXJlbmRlcl9hcnJheScpKSB7XG5cdFx0XHR0ZW1wbGF0ZS5zZXRBdHRyaWJ1dGUoJ2RhdGEtcmVuZGVyX2FycmF5JywgdHlwZSk7XG5cdFx0fVxuXHRcdFxuXHRcdGl0ZW1UZW1wbGF0ZURpdi5hcHBlbmRDaGlsZCh0ZW1wbGF0ZS5jbG9uZU5vZGUodHJ1ZSkpO1xuXHRcdHJldHVybiBpdGVtVGVtcGxhdGVEaXY7XG5cdH0sXG5cdFxuXHRfX3JlbmRlckRhdGE6IGZ1bmN0aW9uKHdyYXBwZXIsIGRhdGEsIHR5cGUgPSBcImRhdGFcIikge1xuXG5cdFx0bGV0IHRlbXBsYXRlSWQgPSB3cmFwcGVyLmdldEF0dHJpYnV0ZSgnZGF0YS10ZW1wbGF0ZV9pZCcpO1xuXHRcdGxldCB0ZW1wbGF0ZSA9IHdyYXBwZXIucXVlcnlTZWxlY3RvcihgLnRlbXBsYXRlW2RhdGEtdGVtcGxhdGVfaWQ9JyR7dGVtcGxhdGVJZH0nYCk7Ly8gfHwgd3JhcHBlci5xdWVyeVNlbGVjdG9yKCcudGVtcGxhdGUnKTtcblx0XHQvLyBsZXQgdGVtcGxhdGUgPSB3cmFwcGVyLnF1ZXJ5U2VsZWN0b3IoJy50ZW1wbGF0ZScpO1xuXHRcdGlmICghdGVtcGxhdGUpICB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHRcdGxldCByZW5kZXJJZCA9IHdyYXBwZXIuZ2V0QXR0cmlidXRlKCdkYXRhLXJlbmRlcl9pZCcpO1xuXHRcdFxuXHRcdGxldCBwYXNzVG8gPSB3cmFwcGVyLmdldEF0dHJpYnV0ZSgnZGF0YS1wYXNzX3RvJyk7XG5cdFx0bGV0IHJlbmRlckRhdGEgPSByZW5kZXJJZCA/IHtbcmVuZGVySWRdIDogZGF0YX0gOiBkYXRhO1xuXHRcdFxuXHRcdHR5cGUgPSB0eXBlIHx8IFwiZGF0YVwiO1xuXHRcdHR5cGUgPSByZW5kZXJJZCA/IGAke3JlbmRlcklkfS4ke3R5cGV9YCA6IHR5cGU7XG5cblx0XHRsZXQgY2xvbmVXcmFwcGVyID0gdGhpcy5fX2Nsb25lRWxlbWVudCh0ZW1wbGF0ZSwgdGVtcGxhdGVJZCwgdHlwZSk7XG5cdFx0XG5cdFx0Ly8gcmVuZGVyLnNldFZhbHVlKGNsb25lV3JhcHBlci5jaGlsZHJlbiwgcmVuZGVyRGF0YSwgcGFzc1RvLCBjbG9uZVdyYXBwZXIpO1xuXHRcdFxuXHRcdHJlbmRlci5kYXRhKHtcblx0XHRcdGVsZW1lbnRzOiBjbG9uZVdyYXBwZXIuY2hpbGRyZW4sXG5cdFx0XHRkYXRhOiByZW5kZXJEYXRhLFxuXHRcdFx0cGFzc1RvOiBwYXNzVG9cblx0XHR9KVxuXHRcdGxldCByZW1vdmVhYmxlVGVtcGxhdGUgPSBjbG9uZVdyYXBwZXIucXVlcnlTZWxlY3RvcihgLnRlbXBsYXRlW2RhdGEtdGVtcGxhdGVfaWQ9XCIke3RlbXBsYXRlSWR9XCJdYCk7XG5cdFx0aWYgKHJlbW92ZWFibGVUZW1wbGF0ZSkge1xuXHRcdFx0cmVtb3ZlYWJsZVRlbXBsYXRlLnJlbW92ZSgpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0dGVtcGxhdGUuaW5zZXJ0QWRqYWNlbnRIVE1MKCdiZWZvcmViZWdpbicsIGNsb25lV3JhcHBlci5pbm5lckhUTUwpO1xuXHRcdHZhciBldnQgPSBuZXcgQ3VzdG9tRXZlbnQoJ2ZldGNoZWRUZW1wbGF0ZScsIHsgYnViYmxlczogdHJ1ZSB9KTtcblx0XHR3cmFwcGVyLmRpc3BhdGNoRXZlbnQoZXZ0KTtcblxuXHRcdC8vLyBpbml0IHBhc3NWYWx1ZUJ0bnNcblx0XHRsZXQgZm9ybXMgPSB3cmFwcGVyLnBhcmVudE5vZGUuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2Zvcm0nKTtcblx0XHRcblx0XHRmb3IgKGxldCBpID0gMDsgaSA8IGZvcm1zLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRsZXQgZm9ybSA9IGZvcm1zW2ldO1xuXHRcdFx0bGV0IHZhbHVlUGFzc0J0biA9IGZvcm0ucXVlcnlTZWxlY3RvcignLnBhc3NWYWx1ZUJ0bicpO1xuXHRcdFx0aWYgKHZhbHVlUGFzc0J0bikgbG9naWMuX19yZWdpc3RlclZhbHVlUGFzc0J0bkV2ZW50KGZvcm0sIHZhbHVlUGFzc0J0bik7XG5cdFx0fVxuXHRcdFxuXHRcdC8vIHRoaXMuaW5pdEVsZW1lbnQod3JhcHBlcilcblx0fSxcblxuXHRfX2RlbGV0ZUl0ZW06IGZ1bmN0aW9uKGRhdGEpIHtcblx0XHRsZXQgY29sbGVjdGlvbiA9IGRhdGFbJ2NvbGxlY3Rpb24nXTtcblx0XHRsZXQgZG9jdW1lbnRfaWQgPSBkYXRhWydkb2N1bWVudF9pZCddO1xuXHRcdFxuXHRcdGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5pdGVtcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0bGV0IGl0ZW0gPSB0aGlzLml0ZW1zW2ldO1xuXHRcdFx0XG5cdFx0XHRpZiAoaXRlbS5maWx0ZXIuY29sbGVjdGlvbiA9PSBjb2xsZWN0aW9uKSB7XG5cdFx0XHRcdHZhciB0bXBJZCA9IGl0ZW0uZWwuZ2V0QXR0cmlidXRlKCdkYXRhLXRlbXBsYXRlX2lkJylcblx0XHRcdFx0dmFyIGVscyA9IGl0ZW0uZWwucXVlcnlTZWxlY3RvckFsbChcIlt0ZW1wbGF0ZUlkPSdcIiArIHRtcElkICsgXCInXVtkYXRhLWRvY3VtZW50X2lkPSdcIiArIGRvY3VtZW50X2lkICsgXCInXVwiKTtcblx0XHRcdFx0Zm9yIChsZXQgaiA9IDA7IGogPCBlbHMubGVuZ3RoOyBqKyspIHtcblx0XHRcdFx0XHRlbHNbal0ucmVtb3ZlKCk7XG5cdFx0XHRcdFx0aXRlbS5zdGFydEluZGV4LS07XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdH0sXG5cdFxuXHRfX2ZldGNoZWRJdGVtOiBmdW5jdGlvbihkYXRhKSB7XG5cdFx0bGV0IGl0ZW1faWQgPSBkYXRhWydlbGVtZW50J107XG5cdFx0bGV0IGl0ZW0gPSBjY2ZpbHRlci5nZXRPYmplY3RCeUZpbHRlcklkKHRoaXMuaXRlbXMsIGl0ZW1faWQpO1xuXHRcdGlmIChpdGVtKSB7XG5cdFx0XHRpdGVtLmZpbHRlci5zdGFydEluZGV4ICs9IGRhdGFbJ2RhdGEnXS5sZW5ndGg7XG5cdFx0XHRsZXQgZmV0Y2hfbmFtZSA9IGl0ZW0uZWwuZ2V0QXR0cmlidXRlKCdkYXRhLWZldGNoX25hbWUnKTtcblx0XHRcdGlmIChmZXRjaF9uYW1lKSB7XG5cdFx0XHRcdGRhdGEgPSBkYXRhLmRhdGFbMF07XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdGlmIChkYXRhKSB7XG5cdFx0XHRcdGlmIChkYXRhLm1ldGFkYXRhICYmIGRhdGEubWV0YWRhdGEuaXNSZWZyZXNoKSB7XG5cdFx0XHRcdFx0dGhpcy5fX3JlbW92ZU9sZERhdGEoaXRlbS5lbCk7XG5cdFx0XHRcdH1cblx0XHRcdFx0dGhpcy5fX3JlbmRlckRhdGEoaXRlbS5lbCwgZGF0YSwgZmV0Y2hfbmFtZSk7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHR9XG5cdH0sXG5cblx0X19jcmVhdGVJdGVtOiBmdW5jdGlvbihkYXRhKSB7XG5cdFx0bGV0IGNvbGxlY3Rpb24gPSBkYXRhWydjb2xsZWN0aW9uJ107XG5cdFx0Y29uc3Qgc2VsZiA9IHRoaXM7XG5cdFx0bGV0IGl0ZW1EYXRhID0gZGF0YS5kYXRhO1xuXHRcdGxldCByZW5kZXJfZGF0YSA9IGRhdGE7XG5cdFx0cmVuZGVyX2RhdGEuZGF0YSA9IFtpdGVtRGF0YV07XG5cblx0XHR0aGlzLml0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHtcblx0XHRcdGNvbnN0IHtmaWx0ZXJ9ID0gaXRlbTtcblx0XHRcdGxldCBpZHMgPSBbXTtcblx0XHRcdGl0ZW0uZmV0Y2hfaWRzID0gW107XG5cdFx0XHRpZiAoZmlsdGVyLmNvbGxlY3Rpb24gPT09IGNvbGxlY3Rpb24gJiYgIWl0ZW0uZWwuZ2V0QXR0cmlidXRlKCdkYXRhLWZldGNoX25hbWUnKSAmJiBzZWxmLl9fY2hlY2tJdGVtQnlGaWx0ZXJzKGl0ZW1EYXRhLCBmaWx0ZXIuZmlsdGVycykpIHtcblx0XHRcdFx0Ly8gaWRzLnB1c2goZGF0YVsnZG9jdW1lbnRfaWQnXSk7XG5cdFx0XHRcdHNlbGYuX19yZW5kZXJEYXRhKGl0ZW0uZWwsIHJlbmRlcl9kYXRhKVxuXHRcdFx0fVxuXHRcdH0pXG5cdH0sXG5cblx0ZmluZFRlbXBsYXRlRWxCeUNoaWxkOiBmdW5jdGlvbihlbGVtZW50KSB7XG5cdFx0cmV0dXJuIHV0aWxzLmdldFBhcmVudEZyb21FbGVtZW50KGVsZW1lbnQsIG51bGwsIFsnZGF0YS10ZW1wbGF0ZV9pZCcsICdkYXRhLWZldGNoX2NvbGxlY3Rpb24nXSk7XG5cdH0sXG5cdFxuXHR1cGRhdGVQYXJlbnRUZW1wbGF0ZU9mQ2hpbGQ6IGZ1bmN0aW9uKHRlbXBsYXRlLCBlbGVtZW50KSB7XG5cdFx0Y29uc3QgbmFtZSA9IHRlbXBsYXRlLmdldEF0dHJpYnV0ZSgnZGF0YS1maWx0ZXJfbmFtZScpXG5cdFx0Y29uc3QgdmFsdWUgPSB0ZW1wbGF0ZS5nZXRBdHRyaWJ1dGUoJ2RhdGEtZmlsdGVyX3ZhbHVlJylcblx0XHRjb25zdCBvcGVyYXRvciA9IHRlbXBsYXRlLmdldEF0dHJpYnV0ZSgnZGF0YS1maWx0ZXJfb3BlcmF0b3InKVxuXHRcdGlmICghbmFtZSB8fCBvcGVyYXRvciAhPSBcIiRlcVwiKSByZXR1cm47XG5cblx0XHRjcnVkLnVwZGF0ZURvY3VtZW50KHtcblx0XHRcdGNvbGxlY3Rpb25cdDogdGVtcGxhdGUuZ2V0QXR0cmlidXRlKCdkYXRhLWZldGNoX2NvbGxlY3Rpb24nKSwgXG5cdFx0XHRkb2N1bWVudF9pZCA6IGVsZW1lbnQuZ2V0QXR0cmlidXRlKCdkYXRhLWRvY3VtZW50X2lkJyksIFxuXHRcdFx0ZGF0YToge1xuXHRcdFx0XHRbbmFtZV06IHZhbHVlXHRcblx0XHRcdH0sXG5cdFx0XHRicm9hZGNhc3RcdDogZmFsc2Vcblx0XHR9KVxuXHR9LFxuXHRcblx0cmVvcmRlckNoaWxkcmVuT2ZUZW1wbGF0ZTogZnVuY3Rpb24gKHRlbXBsYXRlKSB7XG5cdFx0Y29uc3Qgb3JkZXJGaWVsZCA9IHRlbXBsYXRlLmdldEF0dHJpYnV0ZSgnZGF0YS1vcmRlcl9ieScpXG5cdFx0Y29uc3QgdGVtcGxhdGVfaWQgPSB0ZW1wbGF0ZS5nZXRBdHRyaWJ1dGUoJ2RhdGEtdGVtcGxhdGVfaWQnKVxuXHRcdGlmICghb3JkZXJGaWVsZCB8fCAhdGVtcGxhdGVfaWQpIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0Y29uc3QgY2hpbGRyZW4gPSB0ZW1wbGF0ZS5xdWVyeVNlbGVjdG9yQWxsKGBbZGF0YS10ZW1wbGF0ZV9pZD1cIiR7dGVtcGxhdGVfaWR9XCJdW2RhdGEtZG9jdW1lbnRfaWRdOm5vdCgudGVtcGxhdGUpYClcblx0XHRcblx0XHRjb25zdCBjb2ZmID0gdGVtcGxhdGUuZ2V0QXR0cmlidXRlKCdkYXRhLW9yZGVyX3R5cGUnKSAhPT0gJ2FzYycgPyAtMSA6IDE7XG5cdFx0Y2hpbGRyZW4uZm9yRWFjaCgoaXRlbSwgaW5kZXgpID0+IHtcblx0XHRcdGlmIChpdGVtLmNsYXNzTGlzdC5jb250YWlucygndGVtcGxhdGUnKSkge1xuXHRcdFx0XHRyZXR1cm5cblx0XHRcdH1cblx0XHRcdGNydWQudXBkYXRlRG9jdW1lbnQoe1xuXHRcdFx0XHRjb2xsZWN0aW9uIDogdGVtcGxhdGUuZ2V0QXR0cmlidXRlKCdkYXRhLWZldGNoX2NvbGxlY3Rpb24nKSwgXG5cdFx0XHRcdGRvY3VtZW50X2lkIDogaXRlbS5nZXRBdHRyaWJ1dGUoJ2RhdGEtZG9jdW1lbnRfaWQnKSwgXG5cdFx0XHRcdGRhdGE6IHtcblx0XHRcdFx0XHRbb3JkZXJGaWVsZF06IGluZGV4ICogY29mZlx0XG5cdFx0XHRcdH0sXG5cdFx0XHRcdGJyb2FkY2FzdDogZmFsc2UsXG5cdFx0XHR9KVxuXHRcdH0pXG5cdH0sXG5cdFxuXHRfX2NoZWNrSXRlbUJ5RmlsdGVyczogZnVuY3Rpb24oaXRlbSwgZmlsdGVycykge1xuXHRcdC8vLiAkY29udGFpbiwgJHJhbmdlLCAkZXEsICRuZSwgJGx0LCAkbHRlLCAkZ3QsICRndGUsICRpbiwgJG5pbiwgJGdlb1dpdGhpblxuXHRcdGxldCBmbGFnID0gdHJ1ZTtcblx0XHRpZiAoIWl0ZW0gfHwgIWZpbHRlcnMpIHtcblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9XG5cdFx0XG5cdFx0aWYgKEFycmF5LmlzQXJyYXkoaXRlbSkpIHJldHVybiBmYWxzZTtcblx0XHRmaWx0ZXJzLmZvckVhY2goKHtuYW1lLCBvcGVyYXRvciwgdHlwZSwgdmFsdWV9KSA9PiB7XG5cdFx0XHRcblx0XHRcdGNvbnN0IGZpZWxkVmFsdWUgPSBpdGVtW25hbWVdXG5cdFx0XHRpZiAoIWZsYWcpIHJldHVybjtcblx0XHRcdFxuXHRcdFx0c3dpdGNoIChvcGVyYXRvcikge1xuXHRcdFx0XHRjYXNlICckY29udGFpbic6XG5cdFx0XHRcdFx0aWYgKCFBcnJheS5pc0FycmF5KGZpZWxkVmFsdWUpIHx8ICFmaWVsZFZhbHVlLnNvbWUoeCA9PiB2YWx1ZS5pbmNsdWRlcyh4KSkpIGZsYWcgPSBmYWxzZTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSAnJHJhbmdlJzpcblx0XHRcdFx0XHRpZiAodmFsdWVbMF0gIT09IG51bGwgJiYgdmFsdWVbMV0gIT09IG51bGwpIHtcblx0XHRcdFx0XHRcdGlmICh2YWx1ZVswXSA+IGZpZWxkVmFsdWUgfHwgdmFsdWVbMV0gPD0gZmllbGRWYWx1ZSlcblx0XHRcdFx0XHRcdFx0ZmxhZyA9IGZhbHNlO1xuXHRcdFx0XHRcdH0gZWxzZSBpZiAoaXRlbS52YWx1ZVswXSA9PSBudWxsICYmIHZhbHVlWzFdID49IGZpZWxkVmFsdWUpIHtcblx0XHRcdFx0XHRcdGZsYWcgPSBmYWxzZTtcblx0XHRcdFx0XHR9IGVsc2UgaWYgKGl0ZW0udmFsdWVbMV0gPT0gbnVsbCAmJiB2YWx1ZVswXSA8PSBmaWVsZFZhbHVlKSB7XG5cdFx0XHRcdFx0XHRmbGFnID0gZmFsc2U7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlICckZXEnOlxuXHRcdFx0XHRcdGlmIChmaWVsZFZhbHVlICE9IHZhbHVlWzBdKSBmbGFnID0gZmFsc2U7IFxuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlICckbmUnOlxuXHRcdFx0XHRcdGlmIChmaWVsZFZhbHVlID09IG51bGwgfHwgZmllbGRWYWx1ZSA9PSB2YWx1ZVswXSkgZmxhZyA9IGZhbHNlO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlICckbHQnOlxuXHRcdFx0XHRcdGlmIChmaWVsZFZhbHVlID49IHZhbHVlWzBdKSBmbGFnID0gZmFsc2U7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgJyRsdGUnOlxuXHRcdFx0XHRcdGlmIChmaWVsZFZhbHVlID4gdmFsdWVbMF0pIGZsYWcgPSBmYWxzZTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSAnJGd0Jzpcblx0XHRcdFx0XHRpZiAoZmllbGRWYWx1ZSA8PSB2YWx1ZVswXSkgZmxhZyA9IGZhbHNlO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlICckZ3RlJzpcblx0XHRcdFx0XHRpZiAoZmllbGRWYWx1ZSA8IHZhbHVlWzBdKSBmbGFnID0gZmFsc2U7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgJyRpbic6XG5cdFx0XHRcdFx0aWYgKCFBcnJheS5pc0FycmF5KGZpZWxkVmFsdWUpIHx8ICFmaWVsZFZhbHVlLnNvbWUoeCA9PiB2YWx1ZS5pbmNsdWRlcyh4KSkpIGZsYWcgPSBmYWxzZTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSAnJG5pbic6XG5cdFx0XHRcdFx0aWYgKEFycmF5LmlzQXJyYXkoZmllbGRWYWx1ZSkgJiYgZmllbGRWYWx1ZS5zb21lKHggPT4gdmFsdWUuaW5jbHVkZXMoeCkpKSBmbGFnID0gZmFsc2U7XG5cdFx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdH1cblx0XHR9KVxuXHRcdHJldHVybiBmbGFnO1xuXHR9XG59XG5cblxuXG5vYnNlcnZlci5pbml0KHsgXG5cdG5hbWU6ICdDb0NyZWF0ZUZldGNoT2JzZXJ2ZXInLCBcblx0b2JzZXJ2ZTogWydhdHRyaWJ1dGVzJ10sXG5cdGF0dHJpYnV0ZXM6IFsnZGF0YS1mZXRjaF9jb2xsZWN0aW9uJywgJ2RhdGEtZmlsdGVyX25hbWUnXSxcblx0Y2FsbGJhY2s6IGZ1bmN0aW9uKG11dGF0aW9uKSB7XG5cdFx0Q29DcmVhdGVGZXRjaC5yZWZlcnNoRWxlbWVudChtdXRhdGlvbilcblx0fVxufSlcblxub2JzZXJ2ZXIuaW5pdCh7IFxuXHRuYW1lOiAnQ29DcmVhdGVGZXRjaEluaXQnLCBcblx0b2JzZXJ2ZTogWydzdWJ0cmVlJywgJ2NoaWxkTGlzdCddLFxuXHRpbmNsdWRlOiBcIltkYXRhLWZldGNoX2NvbGxlY3Rpb25dXCIsXG5cdGNhbGxiYWNrOiBmdW5jdGlvbihtdXRhdGlvbikge1xuXHRcdENvQ3JlYXRlRmV0Y2guaW5pdEVsZW1lbnQobXV0YXRpb24udGFyZ2V0KVxuXHR9XG59KVxuXG5Db0NyZWF0ZUZldGNoLmluaXQoKTtcblxuZXhwb3J0IGRlZmF1bHQgQ29DcmVhdGVGZXRjaDtcbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///../../CoCreateJS/node_modules/@cocreate/fetch/src/index.js\n")}}]);
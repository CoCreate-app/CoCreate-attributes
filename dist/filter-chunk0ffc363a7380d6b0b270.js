/*! For license information please see filter-chunk0ffc363a7380d6b0b270.js.LICENSE.txt */
(this.webpackChunkCoCreate_attributes=this.webpackChunkCoCreate_attributes||[]).push([["filter-chunk"],{"../../CoCreateJS/node_modules/@cocreate/filter/src/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _cocreate_utils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @cocreate/utils */ \"../../CoCreateJS/node_modules/@cocreate/utils/src/index.js\");\n/* harmony import */ var _cocreate_cocreatejs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @cocreate/cocreatejs */ \"../../CoCreateJS/node_modules/@cocreate/cocreatejs/src/index.js\");\n\n\n// import CoCreateSocket from '@cocreate/socket';\n// import CoCreateCrud from '@cocreate/crud';\n// import crudUtils from '@cocreate/crud/src/utils.crud.js'\n\n// let socket = new CoCreateSocket('ws');\n// let crud = CoCreateCrud(socket);\n\nconst CoCreateFilter = {\n\titems: [],\n\tioInstance: null,\n\tmoduleAttribues: [],\n\t\n\tmodule_items : [],\n\t\n\t/** start init processing **/\n\t__init: function() {\n\t\tthis.__initIntesection()\n\t\tthis.__initSocket()\n\t\tthis.__initEvents()\n\t},\n\t\n\t__initIntesection: function() {\n\t\tconst self = this;\n\t\tthis.ioInstance = new IntersectionObserver((entries, observer) => {\n\t\t\tentries.forEach(entry => {\n\t\t\t\tif (entry.isIntersecting) {\n\t\t\t\t\tconst attributeInfo = self.__getMainAttribue(entry.target);\n\t\t\t\t\tif (attributeInfo.id) {\n\t\t\t\t\t\tdocument.dispatchEvent(new CustomEvent('CoCreateFilter-loadMore', {\n\t\t\t\t\t\t\tdetail: {\n\t\t\t\t\t\t\t\tattrName: attributeInfo.name,\n\t\t\t\t\t\t\t\tattrId: attributeInfo.id\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}));\n\t\t\t\t\t}\n\t\t\t\t\tself.ioInstance.unobserve(entry.target)\n\t\t\t\t}\n\t\t\t})\n\t\t}, {\n\t\t\tthreshold: 1\n\t\t})\t\n\t},\n\t\n\t__runLoadMore: function(attrName, id) {\n\t\tif (!id || !attrName) return;\n\t\tlet item = this.items.find((item) => item.attrName === attrName && item.id === id)\n\t\tif (!item) return;\n\t\t\n\t\tif (item.count > 0) {\n\t\t\tthis.fetchData(item)\n\t\t}\n\t},\n\t\n\t__getMainAttribue: function(el) {\n\t\tconst attribute = this.moduleAttribues.find((attr) => (el.getAttribute(attr) || \"\") !== \"\" )\n\t\tif (attribute) {\n\t\t\treturn {\n\t\t\t\tname : attribute,\n\t\t\t\tid: el.getAttribute(attribute)\n\t\t\t}\n\t\t} else {\n\t\t\treturn {};\n\t\t}\n\t},\n\t\n\t__initSocket: function() {\n\t\tconst self = this;\n\t\t_cocreate_cocreatejs__WEBPACK_IMPORTED_MODULE_1__.crud.listenMessage('readDocumentList', function(data) {\n\t\t\tlet item_id = data['element'];\n\t\t\tlet item = self.items.find((item) => item.id === item_id);\n\t\t\tif (item) {\n\t\t\t\t// eObj.startIndex += data.result.length;\n\t\t\t\tconst result_data = data['data'];\n\t\t\t\t\n\t\t\t\t//. set the intersection observe element\n\t\t\t\tlet element = document.querySelector(`[${item.attrName}=\"${item.id}\"][data-fetch_type=\"scroll\"]`)\n\t\t\t\tif (result_data.length > 0 && element) {\n\t\t\t\t\tself.ioInstance.observe(element)\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t// /** render total count **/\n\t\t\t\tconst totalCount = data['operator'].total\n\t\t\t\tconst totalElements = document.querySelectorAll(`[${item.attrName}=\"${item.id}\"][data-fetch_type=\"total\"]`)\n\t\t\t\t\n\t\t\t\tif (totalElements) {\n\t\t\t\t\ttotalElements.forEach((el) => el.innerHTML = totalCount)\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\t},\n\t\n\t__initEvents: function() {\n\t\tconst self = this;\n\t\tdocument.addEventListener('CoCreateFilter-loadMore', function(event) {\n\t\t\tconst attrId = event.detail.attrId;\n\t\t\tconst attrName = event.detail.attrName\n\t\t\tself.__runLoadMore(attrName, attrId)\n\t\t})\n\t\t\n\t\tlet buttons = document.querySelectorAll('[data-fetch_type=\"loadmore\"]');\n\t\tbuttons.forEach((btn) => {\n\t\t\tbtn.addEventListener('click', function(e) {\n\t\t\t\te.preventDefault();\n\t\t\t\tconst attributeInfo = self.__getMainAttribue(btn);\n\n\t\t\t\tif (!attributeInfo.id) return;\n\t\t\t\tself.__runLoadMore(attributeInfo.attrName, attributeInfo.attrId)\n\t\t\t})\n\t\t});\n\t},\n\t\n\t/** ---  End --- **/\n\t\n\tsetFilter: function(el, mainAttr, type) {\n\t\t\t\n\t\tif (!mainAttr) {\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tlet id = el.getAttribute(mainAttr);\n\t\t\n\t\tif (!id) return;\n\t\t\n\t\tif (!this.moduleAttribues.includes(mainAttr)) this.moduleAttribues.push(mainAttr)\n\t\t\n\t\tlet collection = el.getAttribute('data-fetch_collection');\n\t\tlet fetch_type = el.getAttribute('data-fetch_value_type')\n\t\tlet fetch_collection = fetch_type == \"collection\" ? true : false;\n\t\t\n\t\tlet order_name = el.getAttribute('data-order_by')\n\t\tlet order_type = el.getAttribute('data-order_type') || 'asc';\n\n\t\tlet fetch_count = parseInt(el.getAttribute('data-fetch_count'));\n\t\t\n\t\tlet item = {\n\t\t\tel: el,\n\t\t\tid: id,\n\t\t\teId: id, // + this.items.length,\n\t\t\ttype: type,\n\t\t\t\n\t\t\tattrName: mainAttr,\n\t\t\t\n\t\t\tcollection: collection,\n\t\t\tstartIndex: 0,\n\t\t\toptions: {},\t/** return options **/\n\t\t\tfetch: {},\n\t\t\tis_collection: fetch_collection,\n\t\t\tsearch: {\n\t\t\t\ttype: 'or',\n\t\t\t\tvalue: []\n\t\t\t},\n\t\t\torders: [],\n\t\t\tfilters: []\n\t\t}\n\t\t\n\t\tif (!isNaN(fetch_count) && fetch_count > 0) {\n\t\t\titem.count = fetch_count;\n\t\t}\n\t\n\t\tif (order_name) {\n\t\t\titem.orders.push({name: order_name, type: order_type == 'asc' ? 1 : -1 })\n\t\t}\n\n\t\tthis._initFilter(item, id, mainAttr);\n\t\tthis._initOrder(item, id, mainAttr);\n\t\tthis.items.push(item);\n\t\tthis._initInputForm(item, mainAttr);\n\t\t\n\t\tthis._initExportImport(item, id, mainAttr);\n\t\treturn item;\n\t},\n\t\n\t_initFilter: function(item, id, attrName) {\n\t\tlet filter_objs = item.el.getRootNode().querySelectorAll('[' + attrName + '=\"' + id + '\"]');\n\t\tfor (var i = 0; i < filter_objs.length; i++) {\n\t\t\t\n\t\t\tlet f_el = filter_objs[i];\n\t\t\tlet filter_name = f_el.getAttribute('data-filter_name');\n\t\t\tlet filter_operator = f_el.getAttribute('data-filter_operator') ? f_el.getAttribute('data-filter_operator') : '$contain';\n\t\t\tlet value_type = f_el.getAttribute('data-filter_value_type') ? f_el.getAttribute('data-filter_value_type') : 'string';\n\t\t\tlet filter_type = f_el.getAttribute('data-filter_type');\n\t\t\tlet filter_value = f_el.getAttribute('data-filter_value');\n\t\t\tif (filter_value == null) {\n\t\t\t\tcontinue ;\n\t\t\t}\n\t\t\tif (value_type !== \"raw\") {\n\t\t\t\tfilter_value = filter_value.replace(/\\s/g, '').split(',');\n\t\t\t}\n\t\n\t\t\tif (!filter_name) {\n\t\t\t\titem.search.value = this._makeSearchOption(id, attrName);\n\t\t\t} else {\n\t\t\t\tlet idx = this.getFilterByName(item, filter_name, filter_operator);\n\t\t\t\tif (value_type != 'string') {\n\t\t\t\t\tfor (let i = 0; i < filter_value.length; i++) {\n\t\t\t\t\t\tfilter_value[i] = Number(filter_value[i]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.insertArrayObject(item.filters, idx, {name: filter_name, value: filter_value, operator: filter_operator, type: filter_type})\n\t\t\t}\n\t\t}\n\t},\n\t\n\t_initOrder: function(item, id, attrName) {\n\t\tlet filter_objs = item.el.getRootNode().querySelectorAll('[' + attrName + '=\"' + id + '\"]');\n\t\tconst _this = this;\n\t\tfor (var i = 0; i < filter_objs.length; i++) {\n\t\t\t\n\t\t\tlet f_el = filter_objs[i];\n\t\t\tlet order_name = f_el.getAttribute('data-order_by');\n\t\t\tlet order_value = f_el.getAttribute('value');\n\t\t\tif (!order_name || !order_value) {\n\t\t\t\tcontinue ;\n\t\t\t}\n\t\t\t\n\t\t\tif (['A', 'BUTTON'].includes(f_el.tagName)) {\n\t\t\t\tf_el.addEventListener('click', function(){\n\t\t\t\t\tlet name = this.getAttribute('data-order_by');\n\t\t\t\t\tlet value = this.getAttribute('value');\n\t\t\t\t\t_this._applyOrder(item, name, value)\n\t\t\t\t\tif (item.el) {\n\t\t\t\t\t\titem.el.dispatchEvent(new CustomEvent(\"changeFilterInput\", { detail: {type: 'order'} }))\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\t//. apply click event\n\t\t\t} else {\n\t\t\t\tthis._applyOrder(item, order_name, order_value);\n\t\t\t}\n\t\t}\n\t\t\n\t\tthis._initToggleOrderEvent(item, id, attrName);\n\t},\n\t\n\t_initToggleOrderEvent: function(item, id, attrName) {\n\t\tlet elements = document.querySelectorAll(`[${attrName}=\"${id}\"][data-toggle_order]`)\n\t\tconst self =this;\n\t\telements.forEach((element) => {\n\t\t\telement.addEventListener('click', function() {\n\t\t\t\tlet value = this.getAttribute('data-toggle_order') || '';\n\t\t\t\tlet order_name = this.getAttribute('data-order_by');\n\t\t\t\t\n\t\t\t\tvalue = value === 'asc' ? 'desc' : 'asc';\n\n\t\t\t\tfor (let i = 0; i < elements.length; i++) {\n\t\t\t\t\tif (elements[i] !== element) {\n\t\t\t\t\t\telements[i].setAttribute('data-toggle_order', '');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\titem.orders = [];\n\t\t\t\t\n\t\t\t\tself._applyOrder(item, order_name, value);\n\t\t\t\telement.setAttribute('data-toggle_order', value);\n\t\t\t\t\n\t\t\t\tif (item.el) {\n\t\t\t\t\titem.el.dispatchEvent(new CustomEvent(\"changeFilterInput\", { detail: {type: 'order'} }))\n\t\t\t\t}\n\t\t\t\t\n\t\t\t})\n\t\t})\n\t},\n\t\n\t_initExportImport: function(item, id, attrName) {\n\t\tlet export_button = document.querySelector(`[data-export_type][${attrName}=\"${id}\"]`);\n\t\tlet import_button = document.querySelector(`[data-import=\"true\"][${attrName}=\"${id}\"]`);\n\t\t\n\t\tconst self = this;\n\t\tif (export_button) {\n\t\t\t//. export_buttons action\n\t\t\texport_button.addEventListener('click', function() {\n\t\n\t\t\t\tif (!item) return;\n\t\t\t\t\n\t\t\t\tlet new_filter = self.makeFetchOptions(item)\n\t\t\t\t\n\t\t\t\tnew_filter.export = {\n\t\t\t\t\tcollection: new_filter.collection,\n\t\t\t\t\ttype: export_button.getAttribute('data-export_type') || 'json'\n\t\t\t\t}\n\t\t\t\t_cocreate_cocreatejs__WEBPACK_IMPORTED_MODULE_1__.crud.readDocumentList(new_filter);\n\t\t\t})\n\t\t\t\n\t\t}\n\t\t\n\t\tif (import_button) {\n\t\t\t//. import button action\n\t\t\timport_button.addEventListener('click', function() {\n\t\t\t\tvar input = document.createElement('input');\n\t\t\t\tinput.type = 'file';\n\t\n\t\t\t\tif (!item) return;\n\t\t\t\t\n\t\t\t\tlet collection = item.collection;\n\t\t\t\t\n\t\t\t\t//. or \n\t\t\t\t// collection = btn.getAttribute('data-collection');\n\t\n\t\t\t\tinput.onchange = e => {\n\t\t\t\t\tvar file = e.target.files[0];\n\t\t\t\t\t_cocreate_cocreatejs__WEBPACK_IMPORTED_MODULE_1__.crud.importCollection({\n\t\t\t\t\t\tcollection: collection,\n\t\t\t\t\t\tfile: file\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t\tinput.click();\n\t\t\t})\n\t\t}\n\n\t},\n\t\n\t_applyOrder: function(item, name, value) {\n\t\t\n\t\tif (!value) {\n\t\t\treturn;\n\t\t}\n\t\tlet order_type = 0;\n\t\tlet idx = this.getOrderByName(item, name);\n\t\t\n\t\tif (value == 'asc') {\n\t\t\torder_type = 1;   \n\t\t} else if (value == 'desc') {\n\t\t\torder_type = -1;\n\t\t} else {\n\t\t\torder_type = [];\n\t\t}\n\t\tthis.insertArrayObject(item.orders, idx, {name: name, type: order_type}, order_type)\n\t},\n\t\n\tchangeCollection: function(filter) {\n\t\tlet collection = filter.el.getAttribute('data-fetch_collection');\n\t\tfilter.collection = collection;\n\t\tfilter.startIndex = 0;\n\t},\n\t\n\t_makeSearchOption: function(id, attrName) {\n\t\tlet forms = document.querySelectorAll('form[' + attrName + '=' + id + ']');\n\t\t\n\t\tlet tmpSelector = '[' + attrName + '=' + id + ']';\n\t\tlet otherInputs = document.querySelectorAll('input' + tmpSelector + ',textarea' + tmpSelector + ', select' + tmpSelector);\n\t\t\n\t\tlet template_inputs = [];\n\n\t\tfor (let i=0; i < forms.length; i++) {\n\t\t\tlet form = forms[i];\n\t\t\tlet formInputs = form.querySelectorAll('input, textarea, select');\n\t\t\tformInputs = Array.prototype.slice.call(formInputs)\n\t\t\ttemplate_inputs = template_inputs.concat(formInputs);\n\t\t}\n\t\t\n\t\totherInputs = Array.prototype.slice.call(otherInputs);\n\t\ttemplate_inputs = template_inputs.concat(otherInputs)\n\t\t\n\t\tlet values = [];\n\t\t\n\t\tfor (var i = 0; i < template_inputs.length; i++) {\n\t\t\tlet filter_name = template_inputs[i].getAttribute('data-filter_name')\n\t\t\tlet order_name = template_inputs[i].getAttribute('data-order_by')\n\t\t\t\n\t\t\tlet input = template_inputs[i];\n\t\t\tlet value_type = input.getAttribute('data-value_type') ? input.getAttribute('data-value_type') : 'string';\n\t\t\tlet value = null;\n\t\t\t\n\t\t\tif (!filter_name && !order_name) {\n\t\t\t\tif (input.type == 'checkbox' && !input.checked) {\n\t\t\t\t\tvalue = null;\n\t\t\t\t} else {\n\t\t\t\t\tvalue = input.value;\n\t\t\t\t\tif (value_type != 'string') {\n\t\t\t\t\t\tvalue = Number(value);\n\t\t\t\t\t}\n\t\t\t\t\tif (value && !values.includes(value)) {\n\t\t\t\t\t\tvalues.push(value)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn values;\n\t},\n\t\n\t_initInputForm: function(item, attrName) {\n\t\n\t\tif (!item) return;\n\t\n\t\tlet tmpSelector = '[' + attrName + '=\"' + item.id + '\"]';\n\t\tlet formInputs = item.el.getRootNode().querySelectorAll('form'+ tmpSelector + ' input, form' + tmpSelector + ' textarea, form' + tmpSelector + ' select');\n\t\tlet otherInputs = item.el.getRootNode().querySelectorAll('input' + tmpSelector + ',textarea' + tmpSelector + ', select' + tmpSelector);\n\t\n\t\tthis.setCheckboxName(item.id, attrName);\n\t\t\n\t\tformInputs = Array.prototype.slice.call(formInputs);\n\t\totherInputs = Array.prototype.slice.call(otherInputs);\n\t\tformInputs = formInputs.concat(otherInputs);\n\n\t\t// console.log('input form', tmpSelector);\n\t\t\n\t\tfor (let i=0; i < formInputs.length; i++) {\n\t\t\tlet input = formInputs[i];\n\t\t\t\n\t\t\tlet order_by = input.getAttribute('data-order_by');\n\t\t\t\n\t\t\tif (order_by) {\n\t\t\t\tthis._initOrderInput(item, input);\n\t\t\t} else {\n\t\t\t\tthis._initFilterInput(item, input, item.id);\n\t\t\t}\n\t\t}\n\t},\n\t\n\t_initOrderInput: function(item, input) {\n\t\tvar _instance = this;\n\t\tinput.addEventListener('change', function(e) {\n\t\t\t\n\t\t\te.preventDefault();\n\t\t\t\n\t\t\tlet order_by = this.getAttribute('data-order_by');\n\t\t\tlet order_type = 0;\n\t\t\tlet idx = _instance.getOrderByName(item, order_by);\n\t\t\t\n\t\t\tif (this.value == 'asc') {\n\t\t\t\torder_type = 1;   \n\t\t\t} else if (this.value == 'desc') {\n\t\t\t\torder_type = -1;\n\t\t\t} else {\n\t\t\t\torder_type = [];\n\t\t\t}\n\t\t\t\n\t\t\t_instance.insertArrayObject(item.orders, idx, {name: order_by, type: order_type}, order_type)\n\t\t\t\n\t\t\tif (item.el) {\n\t\t\t\titem.el.dispatchEvent(new CustomEvent(\"changeFilterInput\", { detail: {type: 'order'} }))\n\t\t\t}\n\t\t})\n\t},\n\n\t_initFilterInput: function (item, input, id) {\n\t\tvar _instance = this;\n\t\tvar delayTimer;\n\t\tinput.addEventListener('input', function(e) {\n\t\t\te.preventDefault();\n\t\t\tlet filter_name = this.getAttribute('data-filter_name');\n\t\t\tlet filter_operator = this.getAttribute('data-filter_operator') || '$contain';\n\t\t\tlet filter_type = this.getAttribute('data-filter_type');\n\t\t\tlet value_type = this.getAttribute('data-filter_value_type') || 'string';\n\t\t\tclearTimeout(delayTimer);\n\t\t\tdelayTimer = setTimeout(function() {\n\t\t\t\t\n\t\t\t\tif (!filter_name) {\n\t\t\t\t\titem.search.value = _instance._makeSearchOption(id, item.attrName);\n\t\t\t\t} else {\n\t\t\t\t\t\n\t\t\t\t\tlet idx = _instance.getFilterByName(item, filter_name, filter_operator);\n\t\t\t\n\t\t\t\t\tlet inputType = input.type;\n\t\t\t\t\tlet filterValue = [];\n\t\t\t\t\n\t\t\t\t\tif (inputType == 'checkbox') {\n\t\t\t\t\t\tvar inputGroup = document.querySelectorAll(\"input[name=\" + input.name + \"]:checked\");\n\t\t\t\t\t\tfor (var i = 0; i < inputGroup.length; i++) {\n\t\t\t\t\t\t\tfilterValue.push(inputGroup[i].value);\n\t\t\t\t\t\t}\n\t\t\t\n\t\t\t\t\t} else if (inputType == 'raido') {\n\t\t\t\t\t\t\n\t\t\t\t\t} else if (inputType == 'range') {\n\t\t\t\t\t\tfilterValue = [Number(input.min), Number(input.value)];\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar value = input.value;\n\t\t\t\t\t\tif (value_type != 'string') {\n\t\t\t\t\t\t\tvalue = Number(value);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (value != \"none\") {\n\t\t\t\t\t\t\tfilterValue = [value];\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (value_type === \"raw\") {\n\t\t\t\t\t\t\tfilterValue = value;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t_instance.insertArrayObject(item.filters, idx, {name: filter_name, value: filterValue, operator: filter_operator, type: filter_type})\n\t\t\t\t}\n\t\t\t\tif (item.el) {\n\t\t\t\t\titem.el.dispatchEvent(new CustomEvent(\"changeFilterInput\", { detail: {type: 'filter'} }))\n\t\t\t\t}\n\t\t\t\n\t\t\t}, 500);\n\n\t\t})\n\t},\n\tsetCheckboxName: function (id, attrName) {\n\t\tvar forms = document.querySelectorAll('form[' + attrName + '=\"' + id + '\"]')\n\t\tfor (var k = 0; k < forms.length; k++) {\n\t\t\t\n\t\t\tvar elements = forms[k].querySelectorAll('input[type=checkbox], form input[type=radio]');\n\t\t\t\n\t\t\tfor (var i = 0; i < elements.length; i++) {\n\t\t\t\tvar el_name = elements[i].getAttribute('name');\n\t\t\t\tvar f_name = elements[i].getAttribute('data-filter_name');\n\t\t\t\tif (el_name || !f_name) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\telements[i].setAttribute('name', \"_\" + id +\"-\" + f_name + \"_\" + k);\n\t\t\t}\n\t\t\t\n\t\t}\n\t},\n\t\n\tgetFilterByName: function (item, filterName, filterOperator) {\n\t\tfor (var i = 0; i < item.filters.length; i++) {\n\t\t\tvar f = item.filters[i];\n\t\t\tif (f.name == filterName && f.operator == filterOperator) {\n\t\t\t\treturn i;\n\t\t\t}\n\t\t}\n\t\treturn -1;\n\t},\n\t\n\tinsertArrayObject: function(data, idx, obj, value) {\n\t\tif (!value) {\n\t\t\tvalue = obj.value;\n\t\t}\n\t\tif (typeof value == 'object'  && value.length == 0) {\n\t\t\tif (idx != -1) {\n\t\t\t\tdata.splice(idx, 1);\n\t\t\t}\n\t\t} else {\n\t\t\tif (idx != -1) {\n\t\t\t\tdata[idx] = obj;\n\t\t\t} else {\n\t\t\t\tdata.push(obj);\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn data;\n\t},\n\t\n\tgetOrderByName: function(item, name) {\n\t\tfor (var i = 0; i < item.orders.length; i++) {\n\t\t\tif (item.orders[i].name == name) {\n\t\t\t\treturn i;\n\t\t\t}\n\t\t}\n\t\treturn -1;\n\t},\n\t\n\t\n\tdefineEvent: function(item) {\n\t\titem.el.addEventListener('fetchFilterData', function(event) {\n\t\t\tconsole.log(event);\n\t\t});\n\t},\n\t\n\tfetchData:function (item) {\n\t\tlet json = this.makeFetchOptions(item);\n\t\t_cocreate_cocreatejs__WEBPACK_IMPORTED_MODULE_1__.crud.readDocumentList(json);\n\t},\n\t\n\tgetObjectByFilterId: function(obj, id) {\n\t\tfor (var i = 0; i < obj.length; i++) {\n\t\t\tlet filter = obj[i].filter;\n\t\t\tif (!filter) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\t\n\t\t\tif (filter.id == id) {\n\t\t\t\treturn obj[i];\n\t\t\t}\n\t\t}\n\t},\n\t\n\tgetObjectByElement: function(obj, el) {\n\t\tfor (var i = 0; i < obj.length; i++) {\n\t\t\tlet filter = obj[i].filter;\n\t\t\tif (!filter) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\t\n\t\t\tif (filter.el.isSameNode(el)) {\n\t\t\t\treturn obj[i];\n\t\t\t}\n\t\t}\n\t},\n\t\n\tmakeFetchOptions: function(item) {\n\t\tlet json = {\n\t\t\t\"collection\": item.collection,\n\t\t\t\"element\": item.eId,\n\t\t\t\"metadata\": {\n\t\t\t\tisRefresh: item.isRefresh\n\t\t\t},\n\t\t\t\"operator\" :  {\n\t\t\t\t\"filters\": item.filters,\n\t\t\t\t\"orders\": item.orders,\n\t\t\t\t\"search\": item.search,\n\t\t\t\t\"startIndex\": item.startIndex,\n\t\t\t},\n\t\t\t\"is_collection\": item.is_collection\n\t\t}\n\t\t\n\t\tif (item.count) {\n\t\t\tjson['operator'].count = item.count;\n\t\t}\n\t\treturn json;\n\t},\n\t\n\tinit: function({name, attribute, callback}) {\n\t\tlet elements = document.querySelectorAll(`[data-fetch_collection][${attribute}]`)\n\t\tconst self = this;\n\t\telements.forEach((el) => {\n\t\t\tself.__initFilterElement(el, attribute, name);\n\t\t});\n\t\t\n\t\t_cocreate_cocreatejs__WEBPACK_IMPORTED_MODULE_1__.socket.listen('readDocumentList', function(data) {\n\t\t\tcallback.call(null, data);\n\t\t})\n\t},\n\t\n\t__initFilterElement: function(el, attribute, name) {\n\t\tlet _id = el.getAttribute(attribute)\n\t\tconst self = this;\n\t\tif (!_id) return;\n\t\t\n\t\t//. restrict the duplication define\n\t\t// if (this.module_items.some(x => x.name == name && x.id == _id)) {\n\t\t// \treturn;\n\t\t// }\n\t\t\n\t\tlet filter = this.setFilter(el, attribute, name)\n\t\t\n\t\tif (filter) {\n\t\t\tthis.module_items.push({\n\t\t\t\tel: el,\n\t\t\t\tfilter: filter,\n\t\t\t\tid: _id,\n\t\t\t\tname: name\n\t\t\t})\n\t\t\t\n\t\t\tel.addEventListener('changeFilterInput', function(e) {\n\t\t\t\tself.fetchData(filter)\n\t\t\t})\n\t\t\t\n\t\t\tthis.fetchData(filter)\n\t\t}\n\t}\n}\n\nCoCreateFilter.__init();\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (CoCreateFilter);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9Db0NyZWF0ZS5hdHRyaWJ1dGVzLy4uLy4uL0NvQ3JlYXRlSlMvbm9kZV9tb2R1bGVzL0Bjb2NyZWF0ZS9maWx0ZXIvc3JjL2luZGV4LmpzPzRhZDgiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQW9DO0FBQ2M7QUFDbEQ7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSixHQUFHO0FBQ0g7QUFDQSxHQUFHO0FBQ0gsRUFBRTs7QUFFRjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQSxFQUFFLG9FQUFrQjtBQUNwQjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsNkNBQTZDLGNBQWMsSUFBSSxRQUFRO0FBQ3ZFO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0Esd0RBQXdELGNBQWMsSUFBSSxRQUFROztBQUVsRjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSCxFQUFFOztBQUVGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsSUFBSTtBQUNKLEdBQUc7QUFDSCxFQUFFOztBQUVGOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztB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OztBQUVGLGlCQUFpQiwwQkFBMEI7QUFDM0Msc0VBQXNFLFVBQVU7QUFDaEY7QUFDQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSCxFQUFFLCtEQUFhO0FBQ2Y7QUFDQSxHQUFHO0FBQ0gsRUFBRTs7QUFFRjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJOztBQUVKO0FBQ0E7QUFDQSxJQUFJOztBQUVKO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBLGlFQUFlLGNBQWMiLCJmaWxlIjoiLi4vLi4vQ29DcmVhdGVKUy9ub2RlX21vZHVsZXMvQGNvY3JlYXRlL2ZpbHRlci9zcmMvaW5kZXguanMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdXRpbHMgZnJvbSAnQGNvY3JlYXRlL3V0aWxzJztcbmltcG9ydCB7c29ja2V0LCBjcnVkfSBmcm9tICdAY29jcmVhdGUvY29jcmVhdGVqcyc7XG4vLyBpbXBvcnQgQ29DcmVhdGVTb2NrZXQgZnJvbSAnQGNvY3JlYXRlL3NvY2tldCc7XG4vLyBpbXBvcnQgQ29DcmVhdGVDcnVkIGZyb20gJ0Bjb2NyZWF0ZS9jcnVkJztcbi8vIGltcG9ydCBjcnVkVXRpbHMgZnJvbSAnQGNvY3JlYXRlL2NydWQvc3JjL3V0aWxzLmNydWQuanMnXG5cbi8vIGxldCBzb2NrZXQgPSBuZXcgQ29DcmVhdGVTb2NrZXQoJ3dzJyk7XG4vLyBsZXQgY3J1ZCA9IENvQ3JlYXRlQ3J1ZChzb2NrZXQpO1xuXG5jb25zdCBDb0NyZWF0ZUZpbHRlciA9IHtcblx0aXRlbXM6IFtdLFxuXHRpb0luc3RhbmNlOiBudWxsLFxuXHRtb2R1bGVBdHRyaWJ1ZXM6IFtdLFxuXHRcblx0bW9kdWxlX2l0ZW1zIDogW10sXG5cdFxuXHQvKiogc3RhcnQgaW5pdCBwcm9jZXNzaW5nICoqL1xuXHRfX2luaXQ6IGZ1bmN0aW9uKCkge1xuXHRcdHRoaXMuX19pbml0SW50ZXNlY3Rpb24oKVxuXHRcdHRoaXMuX19pbml0U29ja2V0KClcblx0XHR0aGlzLl9faW5pdEV2ZW50cygpXG5cdH0sXG5cdFxuXHRfX2luaXRJbnRlc2VjdGlvbjogZnVuY3Rpb24oKSB7XG5cdFx0Y29uc3Qgc2VsZiA9IHRoaXM7XG5cdFx0dGhpcy5pb0luc3RhbmNlID0gbmV3IEludGVyc2VjdGlvbk9ic2VydmVyKChlbnRyaWVzLCBvYnNlcnZlcikgPT4ge1xuXHRcdFx0ZW50cmllcy5mb3JFYWNoKGVudHJ5ID0+IHtcblx0XHRcdFx0aWYgKGVudHJ5LmlzSW50ZXJzZWN0aW5nKSB7XG5cdFx0XHRcdFx0Y29uc3QgYXR0cmlidXRlSW5mbyA9IHNlbGYuX19nZXRNYWluQXR0cmlidWUoZW50cnkudGFyZ2V0KTtcblx0XHRcdFx0XHRpZiAoYXR0cmlidXRlSW5mby5pZCkge1xuXHRcdFx0XHRcdFx0ZG9jdW1lbnQuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoJ0NvQ3JlYXRlRmlsdGVyLWxvYWRNb3JlJywge1xuXHRcdFx0XHRcdFx0XHRkZXRhaWw6IHtcblx0XHRcdFx0XHRcdFx0XHRhdHRyTmFtZTogYXR0cmlidXRlSW5mby5uYW1lLFxuXHRcdFx0XHRcdFx0XHRcdGF0dHJJZDogYXR0cmlidXRlSW5mby5pZFxuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9KSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdHNlbGYuaW9JbnN0YW5jZS51bm9ic2VydmUoZW50cnkudGFyZ2V0KVxuXHRcdFx0XHR9XG5cdFx0XHR9KVxuXHRcdH0sIHtcblx0XHRcdHRocmVzaG9sZDogMVxuXHRcdH0pXHRcblx0fSxcblx0XG5cdF9fcnVuTG9hZE1vcmU6IGZ1bmN0aW9uKGF0dHJOYW1lLCBpZCkge1xuXHRcdGlmICghaWQgfHwgIWF0dHJOYW1lKSByZXR1cm47XG5cdFx0bGV0IGl0ZW0gPSB0aGlzLml0ZW1zLmZpbmQoKGl0ZW0pID0+IGl0ZW0uYXR0ck5hbWUgPT09IGF0dHJOYW1lICYmIGl0ZW0uaWQgPT09IGlkKVxuXHRcdGlmICghaXRlbSkgcmV0dXJuO1xuXHRcdFxuXHRcdGlmIChpdGVtLmNvdW50ID4gMCkge1xuXHRcdFx0dGhpcy5mZXRjaERhdGEoaXRlbSlcblx0XHR9XG5cdH0sXG5cdFxuXHRfX2dldE1haW5BdHRyaWJ1ZTogZnVuY3Rpb24oZWwpIHtcblx0XHRjb25zdCBhdHRyaWJ1dGUgPSB0aGlzLm1vZHVsZUF0dHJpYnVlcy5maW5kKChhdHRyKSA9PiAoZWwuZ2V0QXR0cmlidXRlKGF0dHIpIHx8IFwiXCIpICE9PSBcIlwiIClcblx0XHRpZiAoYXR0cmlidXRlKSB7XG5cdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRuYW1lIDogYXR0cmlidXRlLFxuXHRcdFx0XHRpZDogZWwuZ2V0QXR0cmlidXRlKGF0dHJpYnV0ZSlcblx0XHRcdH1cblx0XHR9IGVsc2Uge1xuXHRcdFx0cmV0dXJuIHt9O1xuXHRcdH1cblx0fSxcblx0XG5cdF9faW5pdFNvY2tldDogZnVuY3Rpb24oKSB7XG5cdFx0Y29uc3Qgc2VsZiA9IHRoaXM7XG5cdFx0Y3J1ZC5saXN0ZW5NZXNzYWdlKCdyZWFkRG9jdW1lbnRMaXN0JywgZnVuY3Rpb24oZGF0YSkge1xuXHRcdFx0bGV0IGl0ZW1faWQgPSBkYXRhWydlbGVtZW50J107XG5cdFx0XHRsZXQgaXRlbSA9IHNlbGYuaXRlbXMuZmluZCgoaXRlbSkgPT4gaXRlbS5pZCA9PT0gaXRlbV9pZCk7XG5cdFx0XHRpZiAoaXRlbSkge1xuXHRcdFx0XHQvLyBlT2JqLnN0YXJ0SW5kZXggKz0gZGF0YS5yZXN1bHQubGVuZ3RoO1xuXHRcdFx0XHRjb25zdCByZXN1bHRfZGF0YSA9IGRhdGFbJ2RhdGEnXTtcblx0XHRcdFx0XG5cdFx0XHRcdC8vLiBzZXQgdGhlIGludGVyc2VjdGlvbiBvYnNlcnZlIGVsZW1lbnRcblx0XHRcdFx0bGV0IGVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBbJHtpdGVtLmF0dHJOYW1lfT1cIiR7aXRlbS5pZH1cIl1bZGF0YS1mZXRjaF90eXBlPVwic2Nyb2xsXCJdYClcblx0XHRcdFx0aWYgKHJlc3VsdF9kYXRhLmxlbmd0aCA+IDAgJiYgZWxlbWVudCkge1xuXHRcdFx0XHRcdHNlbGYuaW9JbnN0YW5jZS5vYnNlcnZlKGVsZW1lbnQpXG5cdFx0XHRcdH1cblx0XHRcdFx0XG5cdFx0XHRcdC8vIC8qKiByZW5kZXIgdG90YWwgY291bnQgKiovXG5cdFx0XHRcdGNvbnN0IHRvdGFsQ291bnQgPSBkYXRhWydvcGVyYXRvciddLnRvdGFsXG5cdFx0XHRcdGNvbnN0IHRvdGFsRWxlbWVudHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGBbJHtpdGVtLmF0dHJOYW1lfT1cIiR7aXRlbS5pZH1cIl1bZGF0YS1mZXRjaF90eXBlPVwidG90YWxcIl1gKVxuXHRcdFx0XHRcblx0XHRcdFx0aWYgKHRvdGFsRWxlbWVudHMpIHtcblx0XHRcdFx0XHR0b3RhbEVsZW1lbnRzLmZvckVhY2goKGVsKSA9PiBlbC5pbm5lckhUTUwgPSB0b3RhbENvdW50KVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSlcblx0fSxcblx0XG5cdF9faW5pdEV2ZW50czogZnVuY3Rpb24oKSB7XG5cdFx0Y29uc3Qgc2VsZiA9IHRoaXM7XG5cdFx0ZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignQ29DcmVhdGVGaWx0ZXItbG9hZE1vcmUnLCBmdW5jdGlvbihldmVudCkge1xuXHRcdFx0Y29uc3QgYXR0cklkID0gZXZlbnQuZGV0YWlsLmF0dHJJZDtcblx0XHRcdGNvbnN0IGF0dHJOYW1lID0gZXZlbnQuZGV0YWlsLmF0dHJOYW1lXG5cdFx0XHRzZWxmLl9fcnVuTG9hZE1vcmUoYXR0ck5hbWUsIGF0dHJJZClcblx0XHR9KVxuXHRcdFxuXHRcdGxldCBidXR0b25zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnW2RhdGEtZmV0Y2hfdHlwZT1cImxvYWRtb3JlXCJdJyk7XG5cdFx0YnV0dG9ucy5mb3JFYWNoKChidG4pID0+IHtcblx0XHRcdGJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcblx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHRjb25zdCBhdHRyaWJ1dGVJbmZvID0gc2VsZi5fX2dldE1haW5BdHRyaWJ1ZShidG4pO1xuXG5cdFx0XHRcdGlmICghYXR0cmlidXRlSW5mby5pZCkgcmV0dXJuO1xuXHRcdFx0XHRzZWxmLl9fcnVuTG9hZE1vcmUoYXR0cmlidXRlSW5mby5hdHRyTmFtZSwgYXR0cmlidXRlSW5mby5hdHRySWQpXG5cdFx0XHR9KVxuXHRcdH0pO1xuXHR9LFxuXHRcblx0LyoqIC0tLSAgRW5kIC0tLSAqKi9cblx0XG5cdHNldEZpbHRlcjogZnVuY3Rpb24oZWwsIG1haW5BdHRyLCB0eXBlKSB7XG5cdFx0XHRcblx0XHRpZiAoIW1haW5BdHRyKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHRcdFxuXHRcdGxldCBpZCA9IGVsLmdldEF0dHJpYnV0ZShtYWluQXR0cik7XG5cdFx0XG5cdFx0aWYgKCFpZCkgcmV0dXJuO1xuXHRcdFxuXHRcdGlmICghdGhpcy5tb2R1bGVBdHRyaWJ1ZXMuaW5jbHVkZXMobWFpbkF0dHIpKSB0aGlzLm1vZHVsZUF0dHJpYnVlcy5wdXNoKG1haW5BdHRyKVxuXHRcdFxuXHRcdGxldCBjb2xsZWN0aW9uID0gZWwuZ2V0QXR0cmlidXRlKCdkYXRhLWZldGNoX2NvbGxlY3Rpb24nKTtcblx0XHRsZXQgZmV0Y2hfdHlwZSA9IGVsLmdldEF0dHJpYnV0ZSgnZGF0YS1mZXRjaF92YWx1ZV90eXBlJylcblx0XHRsZXQgZmV0Y2hfY29sbGVjdGlvbiA9IGZldGNoX3R5cGUgPT0gXCJjb2xsZWN0aW9uXCIgPyB0cnVlIDogZmFsc2U7XG5cdFx0XG5cdFx0bGV0IG9yZGVyX25hbWUgPSBlbC5nZXRBdHRyaWJ1dGUoJ2RhdGEtb3JkZXJfYnknKVxuXHRcdGxldCBvcmRlcl90eXBlID0gZWwuZ2V0QXR0cmlidXRlKCdkYXRhLW9yZGVyX3R5cGUnKSB8fCAnYXNjJztcblxuXHRcdGxldCBmZXRjaF9jb3VudCA9IHBhcnNlSW50KGVsLmdldEF0dHJpYnV0ZSgnZGF0YS1mZXRjaF9jb3VudCcpKTtcblx0XHRcblx0XHRsZXQgaXRlbSA9IHtcblx0XHRcdGVsOiBlbCxcblx0XHRcdGlkOiBpZCxcblx0XHRcdGVJZDogaWQsIC8vICsgdGhpcy5pdGVtcy5sZW5ndGgsXG5cdFx0XHR0eXBlOiB0eXBlLFxuXHRcdFx0XG5cdFx0XHRhdHRyTmFtZTogbWFpbkF0dHIsXG5cdFx0XHRcblx0XHRcdGNvbGxlY3Rpb246IGNvbGxlY3Rpb24sXG5cdFx0XHRzdGFydEluZGV4OiAwLFxuXHRcdFx0b3B0aW9uczoge30sXHQvKiogcmV0dXJuIG9wdGlvbnMgKiovXG5cdFx0XHRmZXRjaDoge30sXG5cdFx0XHRpc19jb2xsZWN0aW9uOiBmZXRjaF9jb2xsZWN0aW9uLFxuXHRcdFx0c2VhcmNoOiB7XG5cdFx0XHRcdHR5cGU6ICdvcicsXG5cdFx0XHRcdHZhbHVlOiBbXVxuXHRcdFx0fSxcblx0XHRcdG9yZGVyczogW10sXG5cdFx0XHRmaWx0ZXJzOiBbXVxuXHRcdH1cblx0XHRcblx0XHRpZiAoIWlzTmFOKGZldGNoX2NvdW50KSAmJiBmZXRjaF9jb3VudCA+IDApIHtcblx0XHRcdGl0ZW0uY291bnQgPSBmZXRjaF9jb3VudDtcblx0XHR9XG5cdFxuXHRcdGlmIChvcmRlcl9uYW1lKSB7XG5cdFx0XHRpdGVtLm9yZGVycy5wdXNoKHtuYW1lOiBvcmRlcl9uYW1lLCB0eXBlOiBvcmRlcl90eXBlID09ICdhc2MnID8gMSA6IC0xIH0pXG5cdFx0fVxuXG5cdFx0dGhpcy5faW5pdEZpbHRlcihpdGVtLCBpZCwgbWFpbkF0dHIpO1xuXHRcdHRoaXMuX2luaXRPcmRlcihpdGVtLCBpZCwgbWFpbkF0dHIpO1xuXHRcdHRoaXMuaXRlbXMucHVzaChpdGVtKTtcblx0XHR0aGlzLl9pbml0SW5wdXRGb3JtKGl0ZW0sIG1haW5BdHRyKTtcblx0XHRcblx0XHR0aGlzLl9pbml0RXhwb3J0SW1wb3J0KGl0ZW0sIGlkLCBtYWluQXR0cik7XG5cdFx0cmV0dXJuIGl0ZW07XG5cdH0sXG5cdFxuXHRfaW5pdEZpbHRlcjogZnVuY3Rpb24oaXRlbSwgaWQsIGF0dHJOYW1lKSB7XG5cdFx0bGV0IGZpbHRlcl9vYmpzID0gaXRlbS5lbC5nZXRSb290Tm9kZSgpLnF1ZXJ5U2VsZWN0b3JBbGwoJ1snICsgYXR0ck5hbWUgKyAnPVwiJyArIGlkICsgJ1wiXScpO1xuXHRcdGZvciAodmFyIGkgPSAwOyBpIDwgZmlsdGVyX29ianMubGVuZ3RoOyBpKyspIHtcblx0XHRcdFxuXHRcdFx0bGV0IGZfZWwgPSBmaWx0ZXJfb2Jqc1tpXTtcblx0XHRcdGxldCBmaWx0ZXJfbmFtZSA9IGZfZWwuZ2V0QXR0cmlidXRlKCdkYXRhLWZpbHRlcl9uYW1lJyk7XG5cdFx0XHRsZXQgZmlsdGVyX29wZXJhdG9yID0gZl9lbC5nZXRBdHRyaWJ1dGUoJ2RhdGEtZmlsdGVyX29wZXJhdG9yJykgPyBmX2VsLmdldEF0dHJpYnV0ZSgnZGF0YS1maWx0ZXJfb3BlcmF0b3InKSA6ICckY29udGFpbic7XG5cdFx0XHRsZXQgdmFsdWVfdHlwZSA9IGZfZWwuZ2V0QXR0cmlidXRlKCdkYXRhLWZpbHRlcl92YWx1ZV90eXBlJykgPyBmX2VsLmdldEF0dHJpYnV0ZSgnZGF0YS1maWx0ZXJfdmFsdWVfdHlwZScpIDogJ3N0cmluZyc7XG5cdFx0XHRsZXQgZmlsdGVyX3R5cGUgPSBmX2VsLmdldEF0dHJpYnV0ZSgnZGF0YS1maWx0ZXJfdHlwZScpO1xuXHRcdFx0bGV0IGZpbHRlcl92YWx1ZSA9IGZfZWwuZ2V0QXR0cmlidXRlKCdkYXRhLWZpbHRlcl92YWx1ZScpO1xuXHRcdFx0aWYgKGZpbHRlcl92YWx1ZSA9PSBudWxsKSB7XG5cdFx0XHRcdGNvbnRpbnVlIDtcblx0XHRcdH1cblx0XHRcdGlmICh2YWx1ZV90eXBlICE9PSBcInJhd1wiKSB7XG5cdFx0XHRcdGZpbHRlcl92YWx1ZSA9IGZpbHRlcl92YWx1ZS5yZXBsYWNlKC9cXHMvZywgJycpLnNwbGl0KCcsJyk7XG5cdFx0XHR9XG5cdFxuXHRcdFx0aWYgKCFmaWx0ZXJfbmFtZSkge1xuXHRcdFx0XHRpdGVtLnNlYXJjaC52YWx1ZSA9IHRoaXMuX21ha2VTZWFyY2hPcHRpb24oaWQsIGF0dHJOYW1lKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGxldCBpZHggPSB0aGlzLmdldEZpbHRlckJ5TmFtZShpdGVtLCBmaWx0ZXJfbmFtZSwgZmlsdGVyX29wZXJhdG9yKTtcblx0XHRcdFx0aWYgKHZhbHVlX3R5cGUgIT0gJ3N0cmluZycpIHtcblx0XHRcdFx0XHRmb3IgKGxldCBpID0gMDsgaSA8IGZpbHRlcl92YWx1ZS5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdFx0ZmlsdGVyX3ZhbHVlW2ldID0gTnVtYmVyKGZpbHRlcl92YWx1ZVtpXSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHRcdHRoaXMuaW5zZXJ0QXJyYXlPYmplY3QoaXRlbS5maWx0ZXJzLCBpZHgsIHtuYW1lOiBmaWx0ZXJfbmFtZSwgdmFsdWU6IGZpbHRlcl92YWx1ZSwgb3BlcmF0b3I6IGZpbHRlcl9vcGVyYXRvciwgdHlwZTogZmlsdGVyX3R5cGV9KVxuXHRcdFx0fVxuXHRcdH1cblx0fSxcblx0XG5cdF9pbml0T3JkZXI6IGZ1bmN0aW9uKGl0ZW0sIGlkLCBhdHRyTmFtZSkge1xuXHRcdGxldCBmaWx0ZXJfb2JqcyA9IGl0ZW0uZWwuZ2V0Um9vdE5vZGUoKS5xdWVyeVNlbGVjdG9yQWxsKCdbJyArIGF0dHJOYW1lICsgJz1cIicgKyBpZCArICdcIl0nKTtcblx0XHRjb25zdCBfdGhpcyA9IHRoaXM7XG5cdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBmaWx0ZXJfb2Jqcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XG5cdFx0XHRsZXQgZl9lbCA9IGZpbHRlcl9vYmpzW2ldO1xuXHRcdFx0bGV0IG9yZGVyX25hbWUgPSBmX2VsLmdldEF0dHJpYnV0ZSgnZGF0YS1vcmRlcl9ieScpO1xuXHRcdFx0bGV0IG9yZGVyX3ZhbHVlID0gZl9lbC5nZXRBdHRyaWJ1dGUoJ3ZhbHVlJyk7XG5cdFx0XHRpZiAoIW9yZGVyX25hbWUgfHwgIW9yZGVyX3ZhbHVlKSB7XG5cdFx0XHRcdGNvbnRpbnVlIDtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0aWYgKFsnQScsICdCVVRUT04nXS5pbmNsdWRlcyhmX2VsLnRhZ05hbWUpKSB7XG5cdFx0XHRcdGZfZWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbigpe1xuXHRcdFx0XHRcdGxldCBuYW1lID0gdGhpcy5nZXRBdHRyaWJ1dGUoJ2RhdGEtb3JkZXJfYnknKTtcblx0XHRcdFx0XHRsZXQgdmFsdWUgPSB0aGlzLmdldEF0dHJpYnV0ZSgndmFsdWUnKTtcblx0XHRcdFx0XHRfdGhpcy5fYXBwbHlPcmRlcihpdGVtLCBuYW1lLCB2YWx1ZSlcblx0XHRcdFx0XHRpZiAoaXRlbS5lbCkge1xuXHRcdFx0XHRcdFx0aXRlbS5lbC5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudChcImNoYW5nZUZpbHRlcklucHV0XCIsIHsgZGV0YWlsOiB7dHlwZTogJ29yZGVyJ30gfSkpXG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KTtcblx0XHRcdFx0Ly8uIGFwcGx5IGNsaWNrIGV2ZW50XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR0aGlzLl9hcHBseU9yZGVyKGl0ZW0sIG9yZGVyX25hbWUsIG9yZGVyX3ZhbHVlKTtcblx0XHRcdH1cblx0XHR9XG5cdFx0XG5cdFx0dGhpcy5faW5pdFRvZ2dsZU9yZGVyRXZlbnQoaXRlbSwgaWQsIGF0dHJOYW1lKTtcblx0fSxcblx0XG5cdF9pbml0VG9nZ2xlT3JkZXJFdmVudDogZnVuY3Rpb24oaXRlbSwgaWQsIGF0dHJOYW1lKSB7XG5cdFx0bGV0IGVsZW1lbnRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChgWyR7YXR0ck5hbWV9PVwiJHtpZH1cIl1bZGF0YS10b2dnbGVfb3JkZXJdYClcblx0XHRjb25zdCBzZWxmID10aGlzO1xuXHRcdGVsZW1lbnRzLmZvckVhY2goKGVsZW1lbnQpID0+IHtcblx0XHRcdGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0bGV0IHZhbHVlID0gdGhpcy5nZXRBdHRyaWJ1dGUoJ2RhdGEtdG9nZ2xlX29yZGVyJykgfHwgJyc7XG5cdFx0XHRcdGxldCBvcmRlcl9uYW1lID0gdGhpcy5nZXRBdHRyaWJ1dGUoJ2RhdGEtb3JkZXJfYnknKTtcblx0XHRcdFx0XG5cdFx0XHRcdHZhbHVlID0gdmFsdWUgPT09ICdhc2MnID8gJ2Rlc2MnIDogJ2FzYyc7XG5cblx0XHRcdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCBlbGVtZW50cy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdGlmIChlbGVtZW50c1tpXSAhPT0gZWxlbWVudCkge1xuXHRcdFx0XHRcdFx0ZWxlbWVudHNbaV0uc2V0QXR0cmlidXRlKCdkYXRhLXRvZ2dsZV9vcmRlcicsICcnKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdFx0XG5cdFx0XHRcdGl0ZW0ub3JkZXJzID0gW107XG5cdFx0XHRcdFxuXHRcdFx0XHRzZWxmLl9hcHBseU9yZGVyKGl0ZW0sIG9yZGVyX25hbWUsIHZhbHVlKTtcblx0XHRcdFx0ZWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2RhdGEtdG9nZ2xlX29yZGVyJywgdmFsdWUpO1xuXHRcdFx0XHRcblx0XHRcdFx0aWYgKGl0ZW0uZWwpIHtcblx0XHRcdFx0XHRpdGVtLmVsLmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KFwiY2hhbmdlRmlsdGVySW5wdXRcIiwgeyBkZXRhaWw6IHt0eXBlOiAnb3JkZXInfSB9KSlcblx0XHRcdFx0fVxuXHRcdFx0XHRcblx0XHRcdH0pXG5cdFx0fSlcblx0fSxcblx0XG5cdF9pbml0RXhwb3J0SW1wb3J0OiBmdW5jdGlvbihpdGVtLCBpZCwgYXR0ck5hbWUpIHtcblx0XHRsZXQgZXhwb3J0X2J1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYFtkYXRhLWV4cG9ydF90eXBlXVske2F0dHJOYW1lfT1cIiR7aWR9XCJdYCk7XG5cdFx0bGV0IGltcG9ydF9idXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBbZGF0YS1pbXBvcnQ9XCJ0cnVlXCJdWyR7YXR0ck5hbWV9PVwiJHtpZH1cIl1gKTtcblx0XHRcblx0XHRjb25zdCBzZWxmID0gdGhpcztcblx0XHRpZiAoZXhwb3J0X2J1dHRvbikge1xuXHRcdFx0Ly8uIGV4cG9ydF9idXR0b25zIGFjdGlvblxuXHRcdFx0ZXhwb3J0X2J1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKCkge1xuXHRcblx0XHRcdFx0aWYgKCFpdGVtKSByZXR1cm47XG5cdFx0XHRcdFxuXHRcdFx0XHRsZXQgbmV3X2ZpbHRlciA9IHNlbGYubWFrZUZldGNoT3B0aW9ucyhpdGVtKVxuXHRcdFx0XHRcblx0XHRcdFx0bmV3X2ZpbHRlci5leHBvcnQgPSB7XG5cdFx0XHRcdFx0Y29sbGVjdGlvbjogbmV3X2ZpbHRlci5jb2xsZWN0aW9uLFxuXHRcdFx0XHRcdHR5cGU6IGV4cG9ydF9idXR0b24uZ2V0QXR0cmlidXRlKCdkYXRhLWV4cG9ydF90eXBlJykgfHwgJ2pzb24nXG5cdFx0XHRcdH1cblx0XHRcdFx0Y3J1ZC5yZWFkRG9jdW1lbnRMaXN0KG5ld19maWx0ZXIpO1xuXHRcdFx0fSlcblx0XHRcdFxuXHRcdH1cblx0XHRcblx0XHRpZiAoaW1wb3J0X2J1dHRvbikge1xuXHRcdFx0Ly8uIGltcG9ydCBidXR0b24gYWN0aW9uXG5cdFx0XHRpbXBvcnRfYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHZhciBpbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7XG5cdFx0XHRcdGlucHV0LnR5cGUgPSAnZmlsZSc7XG5cdFxuXHRcdFx0XHRpZiAoIWl0ZW0pIHJldHVybjtcblx0XHRcdFx0XG5cdFx0XHRcdGxldCBjb2xsZWN0aW9uID0gaXRlbS5jb2xsZWN0aW9uO1xuXHRcdFx0XHRcblx0XHRcdFx0Ly8uIG9yIFxuXHRcdFx0XHQvLyBjb2xsZWN0aW9uID0gYnRuLmdldEF0dHJpYnV0ZSgnZGF0YS1jb2xsZWN0aW9uJyk7XG5cdFxuXHRcdFx0XHRpbnB1dC5vbmNoYW5nZSA9IGUgPT4ge1xuXHRcdFx0XHRcdHZhciBmaWxlID0gZS50YXJnZXQuZmlsZXNbMF07XG5cdFx0XHRcdFx0Y3J1ZC5pbXBvcnRDb2xsZWN0aW9uKHtcblx0XHRcdFx0XHRcdGNvbGxlY3Rpb246IGNvbGxlY3Rpb24sXG5cdFx0XHRcdFx0XHRmaWxlOiBmaWxlXG5cdFx0XHRcdFx0fSlcblx0XHRcdFx0fVxuXHRcdFx0XHRpbnB1dC5jbGljaygpO1xuXHRcdFx0fSlcblx0XHR9XG5cblx0fSxcblx0XG5cdF9hcHBseU9yZGVyOiBmdW5jdGlvbihpdGVtLCBuYW1lLCB2YWx1ZSkge1xuXHRcdFxuXHRcdGlmICghdmFsdWUpIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0bGV0IG9yZGVyX3R5cGUgPSAwO1xuXHRcdGxldCBpZHggPSB0aGlzLmdldE9yZGVyQnlOYW1lKGl0ZW0sIG5hbWUpO1xuXHRcdFxuXHRcdGlmICh2YWx1ZSA9PSAnYXNjJykge1xuXHRcdFx0b3JkZXJfdHlwZSA9IDE7ICAgXG5cdFx0fSBlbHNlIGlmICh2YWx1ZSA9PSAnZGVzYycpIHtcblx0XHRcdG9yZGVyX3R5cGUgPSAtMTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0b3JkZXJfdHlwZSA9IFtdO1xuXHRcdH1cblx0XHR0aGlzLmluc2VydEFycmF5T2JqZWN0KGl0ZW0ub3JkZXJzLCBpZHgsIHtuYW1lOiBuYW1lLCB0eXBlOiBvcmRlcl90eXBlfSwgb3JkZXJfdHlwZSlcblx0fSxcblx0XG5cdGNoYW5nZUNvbGxlY3Rpb246IGZ1bmN0aW9uKGZpbHRlcikge1xuXHRcdGxldCBjb2xsZWN0aW9uID0gZmlsdGVyLmVsLmdldEF0dHJpYnV0ZSgnZGF0YS1mZXRjaF9jb2xsZWN0aW9uJyk7XG5cdFx0ZmlsdGVyLmNvbGxlY3Rpb24gPSBjb2xsZWN0aW9uO1xuXHRcdGZpbHRlci5zdGFydEluZGV4ID0gMDtcblx0fSxcblx0XG5cdF9tYWtlU2VhcmNoT3B0aW9uOiBmdW5jdGlvbihpZCwgYXR0ck5hbWUpIHtcblx0XHRsZXQgZm9ybXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdmb3JtWycgKyBhdHRyTmFtZSArICc9JyArIGlkICsgJ10nKTtcblx0XHRcblx0XHRsZXQgdG1wU2VsZWN0b3IgPSAnWycgKyBhdHRyTmFtZSArICc9JyArIGlkICsgJ10nO1xuXHRcdGxldCBvdGhlcklucHV0cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2lucHV0JyArIHRtcFNlbGVjdG9yICsgJyx0ZXh0YXJlYScgKyB0bXBTZWxlY3RvciArICcsIHNlbGVjdCcgKyB0bXBTZWxlY3Rvcik7XG5cdFx0XG5cdFx0bGV0IHRlbXBsYXRlX2lucHV0cyA9IFtdO1xuXG5cdFx0Zm9yIChsZXQgaT0wOyBpIDwgZm9ybXMubGVuZ3RoOyBpKyspIHtcblx0XHRcdGxldCBmb3JtID0gZm9ybXNbaV07XG5cdFx0XHRsZXQgZm9ybUlucHV0cyA9IGZvcm0ucXVlcnlTZWxlY3RvckFsbCgnaW5wdXQsIHRleHRhcmVhLCBzZWxlY3QnKTtcblx0XHRcdGZvcm1JbnB1dHMgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChmb3JtSW5wdXRzKVxuXHRcdFx0dGVtcGxhdGVfaW5wdXRzID0gdGVtcGxhdGVfaW5wdXRzLmNvbmNhdChmb3JtSW5wdXRzKTtcblx0XHR9XG5cdFx0XG5cdFx0b3RoZXJJbnB1dHMgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChvdGhlcklucHV0cyk7XG5cdFx0dGVtcGxhdGVfaW5wdXRzID0gdGVtcGxhdGVfaW5wdXRzLmNvbmNhdChvdGhlcklucHV0cylcblx0XHRcblx0XHRsZXQgdmFsdWVzID0gW107XG5cdFx0XG5cdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCB0ZW1wbGF0ZV9pbnB1dHMubGVuZ3RoOyBpKyspIHtcblx0XHRcdGxldCBmaWx0ZXJfbmFtZSA9IHRlbXBsYXRlX2lucHV0c1tpXS5nZXRBdHRyaWJ1dGUoJ2RhdGEtZmlsdGVyX25hbWUnKVxuXHRcdFx0bGV0IG9yZGVyX25hbWUgPSB0ZW1wbGF0ZV9pbnB1dHNbaV0uZ2V0QXR0cmlidXRlKCdkYXRhLW9yZGVyX2J5Jylcblx0XHRcdFxuXHRcdFx0bGV0IGlucHV0ID0gdGVtcGxhdGVfaW5wdXRzW2ldO1xuXHRcdFx0bGV0IHZhbHVlX3R5cGUgPSBpbnB1dC5nZXRBdHRyaWJ1dGUoJ2RhdGEtdmFsdWVfdHlwZScpID8gaW5wdXQuZ2V0QXR0cmlidXRlKCdkYXRhLXZhbHVlX3R5cGUnKSA6ICdzdHJpbmcnO1xuXHRcdFx0bGV0IHZhbHVlID0gbnVsbDtcblx0XHRcdFxuXHRcdFx0aWYgKCFmaWx0ZXJfbmFtZSAmJiAhb3JkZXJfbmFtZSkge1xuXHRcdFx0XHRpZiAoaW5wdXQudHlwZSA9PSAnY2hlY2tib3gnICYmICFpbnB1dC5jaGVja2VkKSB7XG5cdFx0XHRcdFx0dmFsdWUgPSBudWxsO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHZhbHVlID0gaW5wdXQudmFsdWU7XG5cdFx0XHRcdFx0aWYgKHZhbHVlX3R5cGUgIT0gJ3N0cmluZycpIHtcblx0XHRcdFx0XHRcdHZhbHVlID0gTnVtYmVyKHZhbHVlKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0aWYgKHZhbHVlICYmICF2YWx1ZXMuaW5jbHVkZXModmFsdWUpKSB7XG5cdFx0XHRcdFx0XHR2YWx1ZXMucHVzaCh2YWx1ZSlcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdFx0cmV0dXJuIHZhbHVlcztcblx0fSxcblx0XG5cdF9pbml0SW5wdXRGb3JtOiBmdW5jdGlvbihpdGVtLCBhdHRyTmFtZSkge1xuXHRcblx0XHRpZiAoIWl0ZW0pIHJldHVybjtcblx0XG5cdFx0bGV0IHRtcFNlbGVjdG9yID0gJ1snICsgYXR0ck5hbWUgKyAnPVwiJyArIGl0ZW0uaWQgKyAnXCJdJztcblx0XHRsZXQgZm9ybUlucHV0cyA9IGl0ZW0uZWwuZ2V0Um9vdE5vZGUoKS5xdWVyeVNlbGVjdG9yQWxsKCdmb3JtJysgdG1wU2VsZWN0b3IgKyAnIGlucHV0LCBmb3JtJyArIHRtcFNlbGVjdG9yICsgJyB0ZXh0YXJlYSwgZm9ybScgKyB0bXBTZWxlY3RvciArICcgc2VsZWN0Jyk7XG5cdFx0bGV0IG90aGVySW5wdXRzID0gaXRlbS5lbC5nZXRSb290Tm9kZSgpLnF1ZXJ5U2VsZWN0b3JBbGwoJ2lucHV0JyArIHRtcFNlbGVjdG9yICsgJyx0ZXh0YXJlYScgKyB0bXBTZWxlY3RvciArICcsIHNlbGVjdCcgKyB0bXBTZWxlY3Rvcik7XG5cdFxuXHRcdHRoaXMuc2V0Q2hlY2tib3hOYW1lKGl0ZW0uaWQsIGF0dHJOYW1lKTtcblx0XHRcblx0XHRmb3JtSW5wdXRzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZm9ybUlucHV0cyk7XG5cdFx0b3RoZXJJbnB1dHMgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChvdGhlcklucHV0cyk7XG5cdFx0Zm9ybUlucHV0cyA9IGZvcm1JbnB1dHMuY29uY2F0KG90aGVySW5wdXRzKTtcblxuXHRcdC8vIGNvbnNvbGUubG9nKCdpbnB1dCBmb3JtJywgdG1wU2VsZWN0b3IpO1xuXHRcdFxuXHRcdGZvciAobGV0IGk9MDsgaSA8IGZvcm1JbnB1dHMubGVuZ3RoOyBpKyspIHtcblx0XHRcdGxldCBpbnB1dCA9IGZvcm1JbnB1dHNbaV07XG5cdFx0XHRcblx0XHRcdGxldCBvcmRlcl9ieSA9IGlucHV0LmdldEF0dHJpYnV0ZSgnZGF0YS1vcmRlcl9ieScpO1xuXHRcdFx0XG5cdFx0XHRpZiAob3JkZXJfYnkpIHtcblx0XHRcdFx0dGhpcy5faW5pdE9yZGVySW5wdXQoaXRlbSwgaW5wdXQpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dGhpcy5faW5pdEZpbHRlcklucHV0KGl0ZW0sIGlucHV0LCBpdGVtLmlkKTtcblx0XHRcdH1cblx0XHR9XG5cdH0sXG5cdFxuXHRfaW5pdE9yZGVySW5wdXQ6IGZ1bmN0aW9uKGl0ZW0sIGlucHV0KSB7XG5cdFx0dmFyIF9pbnN0YW5jZSA9IHRoaXM7XG5cdFx0aW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgZnVuY3Rpb24oZSkge1xuXHRcdFx0XG5cdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcblx0XHRcdGxldCBvcmRlcl9ieSA9IHRoaXMuZ2V0QXR0cmlidXRlKCdkYXRhLW9yZGVyX2J5Jyk7XG5cdFx0XHRsZXQgb3JkZXJfdHlwZSA9IDA7XG5cdFx0XHRsZXQgaWR4ID0gX2luc3RhbmNlLmdldE9yZGVyQnlOYW1lKGl0ZW0sIG9yZGVyX2J5KTtcblx0XHRcdFxuXHRcdFx0aWYgKHRoaXMudmFsdWUgPT0gJ2FzYycpIHtcblx0XHRcdFx0b3JkZXJfdHlwZSA9IDE7ICAgXG5cdFx0XHR9IGVsc2UgaWYgKHRoaXMudmFsdWUgPT0gJ2Rlc2MnKSB7XG5cdFx0XHRcdG9yZGVyX3R5cGUgPSAtMTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdG9yZGVyX3R5cGUgPSBbXTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0X2luc3RhbmNlLmluc2VydEFycmF5T2JqZWN0KGl0ZW0ub3JkZXJzLCBpZHgsIHtuYW1lOiBvcmRlcl9ieSwgdHlwZTogb3JkZXJfdHlwZX0sIG9yZGVyX3R5cGUpXG5cdFx0XHRcblx0XHRcdGlmIChpdGVtLmVsKSB7XG5cdFx0XHRcdGl0ZW0uZWwuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoXCJjaGFuZ2VGaWx0ZXJJbnB1dFwiLCB7IGRldGFpbDoge3R5cGU6ICdvcmRlcid9IH0pKVxuXHRcdFx0fVxuXHRcdH0pXG5cdH0sXG5cblx0X2luaXRGaWx0ZXJJbnB1dDogZnVuY3Rpb24gKGl0ZW0sIGlucHV0LCBpZCkge1xuXHRcdHZhciBfaW5zdGFuY2UgPSB0aGlzO1xuXHRcdHZhciBkZWxheVRpbWVyO1xuXHRcdGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgZnVuY3Rpb24oZSkge1xuXHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0bGV0IGZpbHRlcl9uYW1lID0gdGhpcy5nZXRBdHRyaWJ1dGUoJ2RhdGEtZmlsdGVyX25hbWUnKTtcblx0XHRcdGxldCBmaWx0ZXJfb3BlcmF0b3IgPSB0aGlzLmdldEF0dHJpYnV0ZSgnZGF0YS1maWx0ZXJfb3BlcmF0b3InKSB8fCAnJGNvbnRhaW4nO1xuXHRcdFx0bGV0IGZpbHRlcl90eXBlID0gdGhpcy5nZXRBdHRyaWJ1dGUoJ2RhdGEtZmlsdGVyX3R5cGUnKTtcblx0XHRcdGxldCB2YWx1ZV90eXBlID0gdGhpcy5nZXRBdHRyaWJ1dGUoJ2RhdGEtZmlsdGVyX3ZhbHVlX3R5cGUnKSB8fCAnc3RyaW5nJztcblx0XHRcdGNsZWFyVGltZW91dChkZWxheVRpbWVyKTtcblx0XHRcdGRlbGF5VGltZXIgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcblx0XHRcdFx0aWYgKCFmaWx0ZXJfbmFtZSkge1xuXHRcdFx0XHRcdGl0ZW0uc2VhcmNoLnZhbHVlID0gX2luc3RhbmNlLl9tYWtlU2VhcmNoT3B0aW9uKGlkLCBpdGVtLmF0dHJOYW1lKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHRsZXQgaWR4ID0gX2luc3RhbmNlLmdldEZpbHRlckJ5TmFtZShpdGVtLCBmaWx0ZXJfbmFtZSwgZmlsdGVyX29wZXJhdG9yKTtcblx0XHRcdFxuXHRcdFx0XHRcdGxldCBpbnB1dFR5cGUgPSBpbnB1dC50eXBlO1xuXHRcdFx0XHRcdGxldCBmaWx0ZXJWYWx1ZSA9IFtdO1xuXHRcdFx0XHRcblx0XHRcdFx0XHRpZiAoaW5wdXRUeXBlID09ICdjaGVja2JveCcpIHtcblx0XHRcdFx0XHRcdHZhciBpbnB1dEdyb3VwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcImlucHV0W25hbWU9XCIgKyBpbnB1dC5uYW1lICsgXCJdOmNoZWNrZWRcIik7XG5cdFx0XHRcdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IGlucHV0R3JvdXAubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHRcdFx0ZmlsdGVyVmFsdWUucHVzaChpbnB1dEdyb3VwW2ldLnZhbHVlKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFxuXHRcdFx0XHRcdH0gZWxzZSBpZiAoaW5wdXRUeXBlID09ICdyYWlkbycpIHtcblx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdH0gZWxzZSBpZiAoaW5wdXRUeXBlID09ICdyYW5nZScpIHtcblx0XHRcdFx0XHRcdGZpbHRlclZhbHVlID0gW051bWJlcihpbnB1dC5taW4pLCBOdW1iZXIoaW5wdXQudmFsdWUpXTtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0dmFyIHZhbHVlID0gaW5wdXQudmFsdWU7XG5cdFx0XHRcdFx0XHRpZiAodmFsdWVfdHlwZSAhPSAnc3RyaW5nJykge1xuXHRcdFx0XHRcdFx0XHR2YWx1ZSA9IE51bWJlcih2YWx1ZSk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRpZiAodmFsdWUgIT0gXCJub25lXCIpIHtcblx0XHRcdFx0XHRcdFx0ZmlsdGVyVmFsdWUgPSBbdmFsdWVdO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHRpZiAodmFsdWVfdHlwZSA9PT0gXCJyYXdcIikge1xuXHRcdFx0XHRcdFx0XHRmaWx0ZXJWYWx1ZSA9IHZhbHVlO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcblx0XHRcdFx0XHRfaW5zdGFuY2UuaW5zZXJ0QXJyYXlPYmplY3QoaXRlbS5maWx0ZXJzLCBpZHgsIHtuYW1lOiBmaWx0ZXJfbmFtZSwgdmFsdWU6IGZpbHRlclZhbHVlLCBvcGVyYXRvcjogZmlsdGVyX29wZXJhdG9yLCB0eXBlOiBmaWx0ZXJfdHlwZX0pXG5cdFx0XHRcdH1cblx0XHRcdFx0aWYgKGl0ZW0uZWwpIHtcblx0XHRcdFx0XHRpdGVtLmVsLmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KFwiY2hhbmdlRmlsdGVySW5wdXRcIiwgeyBkZXRhaWw6IHt0eXBlOiAnZmlsdGVyJ30gfSkpXG5cdFx0XHRcdH1cblx0XHRcdFxuXHRcdFx0fSwgNTAwKTtcblxuXHRcdH0pXG5cdH0sXG5cdHNldENoZWNrYm94TmFtZTogZnVuY3Rpb24gKGlkLCBhdHRyTmFtZSkge1xuXHRcdHZhciBmb3JtcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2Zvcm1bJyArIGF0dHJOYW1lICsgJz1cIicgKyBpZCArICdcIl0nKVxuXHRcdGZvciAodmFyIGsgPSAwOyBrIDwgZm9ybXMubGVuZ3RoOyBrKyspIHtcblx0XHRcdFxuXHRcdFx0dmFyIGVsZW1lbnRzID0gZm9ybXNba10ucXVlcnlTZWxlY3RvckFsbCgnaW5wdXRbdHlwZT1jaGVja2JveF0sIGZvcm0gaW5wdXRbdHlwZT1yYWRpb10nKTtcblx0XHRcdFxuXHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBlbGVtZW50cy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHR2YXIgZWxfbmFtZSA9IGVsZW1lbnRzW2ldLmdldEF0dHJpYnV0ZSgnbmFtZScpO1xuXHRcdFx0XHR2YXIgZl9uYW1lID0gZWxlbWVudHNbaV0uZ2V0QXR0cmlidXRlKCdkYXRhLWZpbHRlcl9uYW1lJyk7XG5cdFx0XHRcdGlmIChlbF9uYW1lIHx8ICFmX25hbWUpIHtcblx0XHRcdFx0XHRjb250aW51ZTtcblx0XHRcdFx0fVxuXHRcdFx0XHRlbGVtZW50c1tpXS5zZXRBdHRyaWJ1dGUoJ25hbWUnLCBcIl9cIiArIGlkICtcIi1cIiArIGZfbmFtZSArIFwiX1wiICsgayk7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHR9XG5cdH0sXG5cdFxuXHRnZXRGaWx0ZXJCeU5hbWU6IGZ1bmN0aW9uIChpdGVtLCBmaWx0ZXJOYW1lLCBmaWx0ZXJPcGVyYXRvcikge1xuXHRcdGZvciAodmFyIGkgPSAwOyBpIDwgaXRlbS5maWx0ZXJzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHR2YXIgZiA9IGl0ZW0uZmlsdGVyc1tpXTtcblx0XHRcdGlmIChmLm5hbWUgPT0gZmlsdGVyTmFtZSAmJiBmLm9wZXJhdG9yID09IGZpbHRlck9wZXJhdG9yKSB7XG5cdFx0XHRcdHJldHVybiBpO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRyZXR1cm4gLTE7XG5cdH0sXG5cdFxuXHRpbnNlcnRBcnJheU9iamVjdDogZnVuY3Rpb24oZGF0YSwgaWR4LCBvYmosIHZhbHVlKSB7XG5cdFx0aWYgKCF2YWx1ZSkge1xuXHRcdFx0dmFsdWUgPSBvYmoudmFsdWU7XG5cdFx0fVxuXHRcdGlmICh0eXBlb2YgdmFsdWUgPT0gJ29iamVjdCcgICYmIHZhbHVlLmxlbmd0aCA9PSAwKSB7XG5cdFx0XHRpZiAoaWR4ICE9IC0xKSB7XG5cdFx0XHRcdGRhdGEuc3BsaWNlKGlkeCwgMSk7XG5cdFx0XHR9XG5cdFx0fSBlbHNlIHtcblx0XHRcdGlmIChpZHggIT0gLTEpIHtcblx0XHRcdFx0ZGF0YVtpZHhdID0gb2JqO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0ZGF0YS5wdXNoKG9iaik7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdFxuXHRcdHJldHVybiBkYXRhO1xuXHR9LFxuXHRcblx0Z2V0T3JkZXJCeU5hbWU6IGZ1bmN0aW9uKGl0ZW0sIG5hbWUpIHtcblx0XHRmb3IgKHZhciBpID0gMDsgaSA8IGl0ZW0ub3JkZXJzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRpZiAoaXRlbS5vcmRlcnNbaV0ubmFtZSA9PSBuYW1lKSB7XG5cdFx0XHRcdHJldHVybiBpO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRyZXR1cm4gLTE7XG5cdH0sXG5cdFxuXHRcblx0ZGVmaW5lRXZlbnQ6IGZ1bmN0aW9uKGl0ZW0pIHtcblx0XHRpdGVtLmVsLmFkZEV2ZW50TGlzdGVuZXIoJ2ZldGNoRmlsdGVyRGF0YScsIGZ1bmN0aW9uKGV2ZW50KSB7XG5cdFx0XHRjb25zb2xlLmxvZyhldmVudCk7XG5cdFx0fSk7XG5cdH0sXG5cdFxuXHRmZXRjaERhdGE6ZnVuY3Rpb24gKGl0ZW0pIHtcblx0XHRsZXQganNvbiA9IHRoaXMubWFrZUZldGNoT3B0aW9ucyhpdGVtKTtcblx0XHRjcnVkLnJlYWREb2N1bWVudExpc3QoanNvbik7XG5cdH0sXG5cdFxuXHRnZXRPYmplY3RCeUZpbHRlcklkOiBmdW5jdGlvbihvYmosIGlkKSB7XG5cdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBvYmoubGVuZ3RoOyBpKyspIHtcblx0XHRcdGxldCBmaWx0ZXIgPSBvYmpbaV0uZmlsdGVyO1xuXHRcdFx0aWYgKCFmaWx0ZXIpIHtcblx0XHRcdFx0Y29udGludWU7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdGlmIChmaWx0ZXIuaWQgPT0gaWQpIHtcblx0XHRcdFx0cmV0dXJuIG9ialtpXTtcblx0XHRcdH1cblx0XHR9XG5cdH0sXG5cdFxuXHRnZXRPYmplY3RCeUVsZW1lbnQ6IGZ1bmN0aW9uKG9iaiwgZWwpIHtcblx0XHRmb3IgKHZhciBpID0gMDsgaSA8IG9iai5sZW5ndGg7IGkrKykge1xuXHRcdFx0bGV0IGZpbHRlciA9IG9ialtpXS5maWx0ZXI7XG5cdFx0XHRpZiAoIWZpbHRlcikge1xuXHRcdFx0XHRjb250aW51ZTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0aWYgKGZpbHRlci5lbC5pc1NhbWVOb2RlKGVsKSkge1xuXHRcdFx0XHRyZXR1cm4gb2JqW2ldO1xuXHRcdFx0fVxuXHRcdH1cblx0fSxcblx0XG5cdG1ha2VGZXRjaE9wdGlvbnM6IGZ1bmN0aW9uKGl0ZW0pIHtcblx0XHRsZXQganNvbiA9IHtcblx0XHRcdFwiY29sbGVjdGlvblwiOiBpdGVtLmNvbGxlY3Rpb24sXG5cdFx0XHRcImVsZW1lbnRcIjogaXRlbS5lSWQsXG5cdFx0XHRcIm1ldGFkYXRhXCI6IHtcblx0XHRcdFx0aXNSZWZyZXNoOiBpdGVtLmlzUmVmcmVzaFxuXHRcdFx0fSxcblx0XHRcdFwib3BlcmF0b3JcIiA6ICB7XG5cdFx0XHRcdFwiZmlsdGVyc1wiOiBpdGVtLmZpbHRlcnMsXG5cdFx0XHRcdFwib3JkZXJzXCI6IGl0ZW0ub3JkZXJzLFxuXHRcdFx0XHRcInNlYXJjaFwiOiBpdGVtLnNlYXJjaCxcblx0XHRcdFx0XCJzdGFydEluZGV4XCI6IGl0ZW0uc3RhcnRJbmRleCxcblx0XHRcdH0sXG5cdFx0XHRcImlzX2NvbGxlY3Rpb25cIjogaXRlbS5pc19jb2xsZWN0aW9uXG5cdFx0fVxuXHRcdFxuXHRcdGlmIChpdGVtLmNvdW50KSB7XG5cdFx0XHRqc29uWydvcGVyYXRvciddLmNvdW50ID0gaXRlbS5jb3VudDtcblx0XHR9XG5cdFx0cmV0dXJuIGpzb247XG5cdH0sXG5cdFxuXHRpbml0OiBmdW5jdGlvbih7bmFtZSwgYXR0cmlidXRlLCBjYWxsYmFja30pIHtcblx0XHRsZXQgZWxlbWVudHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGBbZGF0YS1mZXRjaF9jb2xsZWN0aW9uXVske2F0dHJpYnV0ZX1dYClcblx0XHRjb25zdCBzZWxmID0gdGhpcztcblx0XHRlbGVtZW50cy5mb3JFYWNoKChlbCkgPT4ge1xuXHRcdFx0c2VsZi5fX2luaXRGaWx0ZXJFbGVtZW50KGVsLCBhdHRyaWJ1dGUsIG5hbWUpO1xuXHRcdH0pO1xuXHRcdFxuXHRcdHNvY2tldC5saXN0ZW4oJ3JlYWREb2N1bWVudExpc3QnLCBmdW5jdGlvbihkYXRhKSB7XG5cdFx0XHRjYWxsYmFjay5jYWxsKG51bGwsIGRhdGEpO1xuXHRcdH0pXG5cdH0sXG5cdFxuXHRfX2luaXRGaWx0ZXJFbGVtZW50OiBmdW5jdGlvbihlbCwgYXR0cmlidXRlLCBuYW1lKSB7XG5cdFx0bGV0IF9pZCA9IGVsLmdldEF0dHJpYnV0ZShhdHRyaWJ1dGUpXG5cdFx0Y29uc3Qgc2VsZiA9IHRoaXM7XG5cdFx0aWYgKCFfaWQpIHJldHVybjtcblx0XHRcblx0XHQvLy4gcmVzdHJpY3QgdGhlIGR1cGxpY2F0aW9uIGRlZmluZVxuXHRcdC8vIGlmICh0aGlzLm1vZHVsZV9pdGVtcy5zb21lKHggPT4geC5uYW1lID09IG5hbWUgJiYgeC5pZCA9PSBfaWQpKSB7XG5cdFx0Ly8gXHRyZXR1cm47XG5cdFx0Ly8gfVxuXHRcdFxuXHRcdGxldCBmaWx0ZXIgPSB0aGlzLnNldEZpbHRlcihlbCwgYXR0cmlidXRlLCBuYW1lKVxuXHRcdFxuXHRcdGlmIChmaWx0ZXIpIHtcblx0XHRcdHRoaXMubW9kdWxlX2l0ZW1zLnB1c2goe1xuXHRcdFx0XHRlbDogZWwsXG5cdFx0XHRcdGZpbHRlcjogZmlsdGVyLFxuXHRcdFx0XHRpZDogX2lkLFxuXHRcdFx0XHRuYW1lOiBuYW1lXG5cdFx0XHR9KVxuXHRcdFx0XG5cdFx0XHRlbC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2VGaWx0ZXJJbnB1dCcsIGZ1bmN0aW9uKGUpIHtcblx0XHRcdFx0c2VsZi5mZXRjaERhdGEoZmlsdGVyKVxuXHRcdFx0fSlcblx0XHRcdFxuXHRcdFx0dGhpcy5mZXRjaERhdGEoZmlsdGVyKVxuXHRcdH1cblx0fVxufVxuXG5Db0NyZWF0ZUZpbHRlci5fX2luaXQoKTtcblxuZXhwb3J0IGRlZmF1bHQgQ29DcmVhdGVGaWx0ZXI7Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///../../CoCreateJS/node_modules/@cocreate/filter/src/index.js\n")}}]);
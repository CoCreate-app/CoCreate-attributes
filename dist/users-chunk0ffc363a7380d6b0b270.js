/*! For license information please see users-chunk0ffc363a7380d6b0b270.js.LICENSE.txt */
(this.webpackChunkCoCreate_attributes=this.webpackChunkCoCreate_attributes||[]).push([["users-chunk"],{"../../CoCreateJS/node_modules/@cocreate/users/src/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\nvar permissionClass = 'checkPermission';\nvar usersCollection = 'users';\nvar orgCollection = \"organizations\";\nvar createdUserId = \"\";\nvar createdOrgId = \"\";\n\n\nvar redirectClass = 'redirectLink';\n\ncheckSession();\ninitSocketsForUsers();\nfetchUser();\ninitLoginForms();\ninitCurrentOrgEles();\ninitLogoutBtn();\n//initRegisterForms();\n\nvar getOrg = false;\nvar updatedCurrentOrg = false;\n\n\nfunction initSocketsForUsers() {\n  CoCreate.socket.listen('fetchedUser', function(data) {\n    fetchedUser(data);\n  })\n  \n  CoCreate.socket.listen('login', function (data) {\n    loginResult(data);\n  })\n  \n  CoCreate.socket.listen('createDocument', function(data) {\n    registerResult(data);\n  })\n  \n  CoCreate.socket.listen('usersCurrentOrg', function(data) {\n\n    updatedCurrentOrg = true;\n    getOrg = true;\n    \n    localStorage.setItem('apiKey', data['apiKey']);\n    localStorage.setItem('securityKey', data['securityKey']);\n    localStorage.setItem('organization_id', data['current_org']);\n    \n    localStorage.setItem('adminUI_id', data['adminUI_id']);\n    localStorage.setItem('builderUI_id', data['builderUI_id']);\n\n    //. fire fetchedUsersCurrentOrg\n    document.dispatchEvent(new CustomEvent('fetchedUsersCurrentOrg'));\n\n    if (data.href) {\n      window.location.href = data.href;\n    }\n  })\n  \n  CoCreate.crud.listenMessage('changedUserStatus', function(data) {\n    changedUserStatus(data)\n  })\n}\n\nfunction fetchUser() {\n  \n  var user_id = localStorage.getItem('user_id');\n\n  if (user_id) {\n    var json = {\n      \"apiKey\": config.apiKey,\n      \"securityKey\": config.securityKey,\n      \"organization_id\": config.organization_Id,\n      \"data-collection\": usersCollection,\n      \"user_id\": user_id\n    }\n    \n    CoCreate.socket.send('fetchUser', json);\n  }\n}\n\nfunction fetchedUser(data) {\n  console.log(data);\n  \n  checkPermissions(data);\n}\n\nfunction checkPermissions(data) {\n  var tags = document.querySelectorAll('.' + permissionClass);\n  \n  console.log(tags);\n  \n  for (var i=0; i<tags.length; i++) {\n    var tag = tags[i];\n    \n    var module_id = tag.getAttribute('data-document_id') ? tag.getAttribute('data-document_id'): tag.getAttribute('data-pass_document_id');\n    var data_permission = tag.getAttribute('data-permission');\n    \n    var userPermission = data['permission-' + module_id];\n    \n    console.log(userPermission);\n    \n    if (userPermission.indexOf(data_permission) == -1) {\n      switch (data_permission) {\n        case 'create':\n          tag.style.display = 'none';\n          break;\n        case 'read':\n          tag.style.display = 'none';\n          break;\n        case 'delete':\n          tag.style.display = 'none';\n          break;\n        case 'delete':\n          tag.readOnly = true;\n          break;\n        default:\n          // code\n      }\n    } else  {\n      switch (data_permission) {\n        \n          // code\n      }\n    }\n  }\n}\n\nfunction initLoginForms() {\n  var forms = document.querySelectorAll('form');\n  \n  for (var i=0; i < forms.length; i++) {\n    initLoginForm(forms[i]);\n  }\n}\n\nfunction initLoginForm(form) {\n\n  var loginBtn = form.querySelector('.loginBtn');\n  \n  if (!loginBtn) return;\n  \n  loginBtn.addEventListener('click', function(e) {\n    e.preventDefault();\n    e.stopPropagation();\n\n    let collection = form.getAttribute('data-collection') || 'module_activity';\n    let loginData = {};\n    \n    const inputs = form.querySelectorAll('input, textarea');\n\n    inputs.forEach((input) => {\n      const name = input.getAttribute('name');\n      let value = input.value;\n      if (input.type == 'password') {\n        value = btoa(value);\n      }\n      collection = input.getAttribute('data-collection') || collection;\n      \n      if (name) {\n        loginData[name] = value;\n      }\n    })\n    \n    var json = {\n      \"apiKey\": config.apiKey,\n      \"securityKey\": config.securityKey,\n      \"organization_id\": config.organization_Id,\n      \"data-collection\": collection,\n      \"loginData\": loginData\n    }\n\n    CoCreate.socket.send('login', json);\n  })\n}\n\nfunction loginResult(data) {\n  const {success, status, message } = data;\n  \n  CoCreate.render.data({\n    selector: \"[data-template_id='afterLoginResponse']\", \n    render: data\n  })\n\n  if (data.success) {\n    localStorage.setItem('user_id', data['id']);\n    let href = \"\";\n    let aTag = document.querySelector(\"form .loginBtn a\");\n    if (aTag) {\n      href = aTag.getAttribute('href');\n    }\n    getCurrentOrg(data['id'], data['collection'], href);\n\n  } else {\n    //. render data\n    \n  }\n}\n\n\nfunction getCurrentOrg(user_id, collection, href) {\n  var json = {\n    \"data-collection\": collection || usersCollection,\n    \"user_id\": user_id,\n    \"href\": href\n  }\n  \n  CoCreate.socket.send('usersCurrentOrg', json);\n}\n\nfunction userRegisterAction(el) {\n  if (!el) return;\n  var form = el.closest('form');\n  if (!form) return;\n  CoCreate.form.request({ form });\n}\n\nfunction registerResult(data) {\n\n  if (data['collection'] === orgCollection) {\n    createdOrgId = data['document_id'];\n  }\n  \n  if (data['collection'] === usersCollection) {\n    createdUserId = data['document_id'];\n  }\n  \n  if (createdOrgId && createdUserId) {\n    CoCreate.crud.updateDocument({\n      broadcast: false,\n      collection: usersCollection,\n      document_id: createdUserId,\n      data: {\n        current_org: createdOrgId,\n        connected_orgs: [createdOrgId]\n      }, \n      broadcast: false\n    })\n\n    localStorage.setItem('user_id', createdUserId)\n    // let aTag = document.querySelector(\".registerBtn > a\");\n    // let href = \"\";\n    // if (aTag) {\n    //   href= aTag.getAttribute(\"href\");\n    // }\n    \n    getCurrentOrg(createdUserId, usersCollection, null);\n  }\n}\n\nfunction initCurrentOrgEles() {\n  var user_id = localStorage.getItem('user_id');\n  \n  if (!user_id) return;\n  \n  let orgChangers = document.querySelectorAll('.org-changer');\n  \n  for (let i=0; i < orgChangers.length; i++) {\n    let orgChanger = orgChangers[i];\n    \n    var collection = orgChanger.getAttribute('data-collection') ? orgChanger.getAttribute('data-collection'): 'module_activity';\n    var id = orgChanger.getAttribute('data-document_id');\n    \n    if (collection == 'users' && id == user_id) {\n      orgChanger.addEventListener('selectedValue', function(e) {    \n\n        setTimeout(function() {\n          getCurrentOrg(user_id);\n          \n          var timer = setInterval(function() {\n            if (updatedCurrentOrg) {\n              location.reload();\n              \n              clearInterval(timer);\n            }\n          }, 100)\n        }, 300)\n      })\n    }\n  }\n}\n\nfunction initLogoutBtn() {\n  let logoutBtns = document.querySelectorAll('.logoutBtn');\n  \n  for (let i=0; i<logoutBtns.length; i++) {\n    let logoutBtn = logoutBtns[i];\n    \n    logoutBtn.addEventListener('click', function(e) {\n      e.preventDefault();\n      \n      localStorage.clear();\n      \n      let href = this.getAttribute('href');\n      if (href) document.location.href = href;\n    })\n  }\n}\n\nfunction checkSession() {\n  \n  var user_id = localStorage.getItem('user_id');\n  \n  if (user_id) {\n    var redirectTag = document.querySelector('.sessionTrue');\n\n    if (redirectTag) {\n      let redirectLink = redirectTag.getAttribute('href');\n      if (redirectLink) {\n        document.location.href = redirectLink\n      } \n    }\n  } else {\n    var redirectTag = document.querySelector('.sessionFalse');\n  \n    if (redirectTag) {\n      let redirectLink = redirectTag.getAttribute('href');\n      if (redirectLink) {\n        localStorage.clear();\n        document.location.href = redirectLink \n      }\n    }\n  }\n}\n\nfunction changedUserStatus(data) {\n  if (!data.user_id) {\n    return;\n  }\n  let statusEls = document.querySelectorAll(`[data-user_status][data-document_id='${data['user_id']}']`)\n  \n  statusEls.forEach((el) => {\n    el.setAttribute('data-user_status', data['status']);\n  })\n}\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({initSocketsForUsers, fetchUser, fetchedUser, checkPermissions, initLoginForms, initLoginForm, \nloginResult, getCurrentOrg, userRegisterAction, registerResult, initCurrentOrgEles, \ninitLogoutBtn, checkSession, changedUserStatus});//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9Db0NyZWF0ZS5hdHRyaWJ1dGVzLy4uLy4uL0NvQ3JlYXRlSlMvbm9kZV9tb2R1bGVzL0Bjb2NyZWF0ZS91c2Vycy9zcmMvaW5kZXguanM/NjQxMSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBO0FBQ0EsR0FBRzs7QUFFSDs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBO0FBQ0EsR0FBRztBQUNIOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBLGVBQWUsZUFBZTtBQUM5Qjs7QUFFQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBLGVBQWUsa0JBQWtCO0FBQ2pDO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxLQUFLOztBQUVMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsR0FBRztBQUNIOztBQUVBO0FBQ0EsU0FBUywwQkFBMEI7O0FBRW5DO0FBQ0E7QUFDQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxHQUFHO0FBQ0g7O0FBRUE7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsT0FBTztBQUNoQzs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxLQUFLOztBQUVMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQSxlQUFlLHdCQUF3QjtBQUN2Qzs7QUFFQTtBQUNBOztBQUVBO0FBQ0EsZ0U7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLFdBQVc7QUFDWCxTQUFTO0FBQ1QsT0FBTztBQUNQO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBLGVBQWUscUJBQXFCO0FBQ3BDOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0ZBQW9GLGdCQUFnQjs7QUFFcEc7QUFDQTtBQUNBLEdBQUc7QUFDSDs7QUFFQSxpRUFBZSxDQUFDO0FBQ2hCO0FBQ0EsK0NBQStDIiwiZmlsZSI6Ii4uLy4uL0NvQ3JlYXRlSlMvbm9kZV9tb2R1bGVzL0Bjb2NyZWF0ZS91c2Vycy9zcmMvaW5kZXguanMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgcGVybWlzc2lvbkNsYXNzID0gJ2NoZWNrUGVybWlzc2lvbic7XG52YXIgdXNlcnNDb2xsZWN0aW9uID0gJ3VzZXJzJztcbnZhciBvcmdDb2xsZWN0aW9uID0gXCJvcmdhbml6YXRpb25zXCI7XG52YXIgY3JlYXRlZFVzZXJJZCA9IFwiXCI7XG52YXIgY3JlYXRlZE9yZ0lkID0gXCJcIjtcblxuXG52YXIgcmVkaXJlY3RDbGFzcyA9ICdyZWRpcmVjdExpbmsnO1xuXG5jaGVja1Nlc3Npb24oKTtcbmluaXRTb2NrZXRzRm9yVXNlcnMoKTtcbmZldGNoVXNlcigpO1xuaW5pdExvZ2luRm9ybXMoKTtcbmluaXRDdXJyZW50T3JnRWxlcygpO1xuaW5pdExvZ291dEJ0bigpO1xuLy9pbml0UmVnaXN0ZXJGb3JtcygpO1xuXG52YXIgZ2V0T3JnID0gZmFsc2U7XG52YXIgdXBkYXRlZEN1cnJlbnRPcmcgPSBmYWxzZTtcblxuXG5mdW5jdGlvbiBpbml0U29ja2V0c0ZvclVzZXJzKCkge1xuICBDb0NyZWF0ZS5zb2NrZXQubGlzdGVuKCdmZXRjaGVkVXNlcicsIGZ1bmN0aW9uKGRhdGEpIHtcbiAgICBmZXRjaGVkVXNlcihkYXRhKTtcbiAgfSlcbiAgXG4gIENvQ3JlYXRlLnNvY2tldC5saXN0ZW4oJ2xvZ2luJywgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICBsb2dpblJlc3VsdChkYXRhKTtcbiAgfSlcbiAgXG4gIENvQ3JlYXRlLnNvY2tldC5saXN0ZW4oJ2NyZWF0ZURvY3VtZW50JywgZnVuY3Rpb24oZGF0YSkge1xuICAgIHJlZ2lzdGVyUmVzdWx0KGRhdGEpO1xuICB9KVxuICBcbiAgQ29DcmVhdGUuc29ja2V0Lmxpc3RlbigndXNlcnNDdXJyZW50T3JnJywgZnVuY3Rpb24oZGF0YSkge1xuXG4gICAgdXBkYXRlZEN1cnJlbnRPcmcgPSB0cnVlO1xuICAgIGdldE9yZyA9IHRydWU7XG4gICAgXG4gICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2FwaUtleScsIGRhdGFbJ2FwaUtleSddKTtcbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnc2VjdXJpdHlLZXknLCBkYXRhWydzZWN1cml0eUtleSddKTtcbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnb3JnYW5pemF0aW9uX2lkJywgZGF0YVsnY3VycmVudF9vcmcnXSk7XG4gICAgXG4gICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2FkbWluVUlfaWQnLCBkYXRhWydhZG1pblVJX2lkJ10pO1xuICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdidWlsZGVyVUlfaWQnLCBkYXRhWydidWlsZGVyVUlfaWQnXSk7XG5cbiAgICAvLy4gZmlyZSBmZXRjaGVkVXNlcnNDdXJyZW50T3JnXG4gICAgZG9jdW1lbnQuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoJ2ZldGNoZWRVc2Vyc0N1cnJlbnRPcmcnKSk7XG5cbiAgICBpZiAoZGF0YS5ocmVmKSB7XG4gICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IGRhdGEuaHJlZjtcbiAgICB9XG4gIH0pXG4gIFxuICBDb0NyZWF0ZS5jcnVkLmxpc3Rlbk1lc3NhZ2UoJ2NoYW5nZWRVc2VyU3RhdHVzJywgZnVuY3Rpb24oZGF0YSkge1xuICAgIGNoYW5nZWRVc2VyU3RhdHVzKGRhdGEpXG4gIH0pXG59XG5cbmZ1bmN0aW9uIGZldGNoVXNlcigpIHtcbiAgXG4gIHZhciB1c2VyX2lkID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3VzZXJfaWQnKTtcblxuICBpZiAodXNlcl9pZCkge1xuICAgIHZhciBqc29uID0ge1xuICAgICAgXCJhcGlLZXlcIjogY29uZmlnLmFwaUtleSxcbiAgICAgIFwic2VjdXJpdHlLZXlcIjogY29uZmlnLnNlY3VyaXR5S2V5LFxuICAgICAgXCJvcmdhbml6YXRpb25faWRcIjogY29uZmlnLm9yZ2FuaXphdGlvbl9JZCxcbiAgICAgIFwiZGF0YS1jb2xsZWN0aW9uXCI6IHVzZXJzQ29sbGVjdGlvbixcbiAgICAgIFwidXNlcl9pZFwiOiB1c2VyX2lkXG4gICAgfVxuICAgIFxuICAgIENvQ3JlYXRlLnNvY2tldC5zZW5kKCdmZXRjaFVzZXInLCBqc29uKTtcbiAgfVxufVxuXG5mdW5jdGlvbiBmZXRjaGVkVXNlcihkYXRhKSB7XG4gIGNvbnNvbGUubG9nKGRhdGEpO1xuICBcbiAgY2hlY2tQZXJtaXNzaW9ucyhkYXRhKTtcbn1cblxuZnVuY3Rpb24gY2hlY2tQZXJtaXNzaW9ucyhkYXRhKSB7XG4gIHZhciB0YWdzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLicgKyBwZXJtaXNzaW9uQ2xhc3MpO1xuICBcbiAgY29uc29sZS5sb2codGFncyk7XG4gIFxuICBmb3IgKHZhciBpPTA7IGk8dGFncy5sZW5ndGg7IGkrKykge1xuICAgIHZhciB0YWcgPSB0YWdzW2ldO1xuICAgIFxuICAgIHZhciBtb2R1bGVfaWQgPSB0YWcuZ2V0QXR0cmlidXRlKCdkYXRhLWRvY3VtZW50X2lkJykgPyB0YWcuZ2V0QXR0cmlidXRlKCdkYXRhLWRvY3VtZW50X2lkJyk6IHRhZy5nZXRBdHRyaWJ1dGUoJ2RhdGEtcGFzc19kb2N1bWVudF9pZCcpO1xuICAgIHZhciBkYXRhX3Blcm1pc3Npb24gPSB0YWcuZ2V0QXR0cmlidXRlKCdkYXRhLXBlcm1pc3Npb24nKTtcbiAgICBcbiAgICB2YXIgdXNlclBlcm1pc3Npb24gPSBkYXRhWydwZXJtaXNzaW9uLScgKyBtb2R1bGVfaWRdO1xuICAgIFxuICAgIGNvbnNvbGUubG9nKHVzZXJQZXJtaXNzaW9uKTtcbiAgICBcbiAgICBpZiAodXNlclBlcm1pc3Npb24uaW5kZXhPZihkYXRhX3Blcm1pc3Npb24pID09IC0xKSB7XG4gICAgICBzd2l0Y2ggKGRhdGFfcGVybWlzc2lvbikge1xuICAgICAgICBjYXNlICdjcmVhdGUnOlxuICAgICAgICAgIHRhZy5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdyZWFkJzpcbiAgICAgICAgICB0YWcuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnZGVsZXRlJzpcbiAgICAgICAgICB0YWcuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnZGVsZXRlJzpcbiAgICAgICAgICB0YWcucmVhZE9ubHkgPSB0cnVlO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgIC8vIGNvZGVcbiAgICAgIH1cbiAgICB9IGVsc2UgIHtcbiAgICAgIHN3aXRjaCAoZGF0YV9wZXJtaXNzaW9uKSB7XG4gICAgICAgIFxuICAgICAgICAgIC8vIGNvZGVcbiAgICAgIH1cbiAgICB9XG4gIH1cbn1cblxuZnVuY3Rpb24gaW5pdExvZ2luRm9ybXMoKSB7XG4gIHZhciBmb3JtcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2Zvcm0nKTtcbiAgXG4gIGZvciAodmFyIGk9MDsgaSA8IGZvcm1zLmxlbmd0aDsgaSsrKSB7XG4gICAgaW5pdExvZ2luRm9ybShmb3Jtc1tpXSk7XG4gIH1cbn1cblxuZnVuY3Rpb24gaW5pdExvZ2luRm9ybShmb3JtKSB7XG5cbiAgdmFyIGxvZ2luQnRuID0gZm9ybS5xdWVyeVNlbGVjdG9yKCcubG9naW5CdG4nKTtcbiAgXG4gIGlmICghbG9naW5CdG4pIHJldHVybjtcbiAgXG4gIGxvZ2luQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuXG4gICAgbGV0IGNvbGxlY3Rpb24gPSBmb3JtLmdldEF0dHJpYnV0ZSgnZGF0YS1jb2xsZWN0aW9uJykgfHwgJ21vZHVsZV9hY3Rpdml0eSc7XG4gICAgbGV0IGxvZ2luRGF0YSA9IHt9O1xuICAgIFxuICAgIGNvbnN0IGlucHV0cyA9IGZvcm0ucXVlcnlTZWxlY3RvckFsbCgnaW5wdXQsIHRleHRhcmVhJyk7XG5cbiAgICBpbnB1dHMuZm9yRWFjaCgoaW5wdXQpID0+IHtcbiAgICAgIGNvbnN0IG5hbWUgPSBpbnB1dC5nZXRBdHRyaWJ1dGUoJ25hbWUnKTtcbiAgICAgIGxldCB2YWx1ZSA9IGlucHV0LnZhbHVlO1xuICAgICAgaWYgKGlucHV0LnR5cGUgPT0gJ3Bhc3N3b3JkJykge1xuICAgICAgICB2YWx1ZSA9IGJ0b2EodmFsdWUpO1xuICAgICAgfVxuICAgICAgY29sbGVjdGlvbiA9IGlucHV0LmdldEF0dHJpYnV0ZSgnZGF0YS1jb2xsZWN0aW9uJykgfHwgY29sbGVjdGlvbjtcbiAgICAgIFxuICAgICAgaWYgKG5hbWUpIHtcbiAgICAgICAgbG9naW5EYXRhW25hbWVdID0gdmFsdWU7XG4gICAgICB9XG4gICAgfSlcbiAgICBcbiAgICB2YXIganNvbiA9IHtcbiAgICAgIFwiYXBpS2V5XCI6IGNvbmZpZy5hcGlLZXksXG4gICAgICBcInNlY3VyaXR5S2V5XCI6IGNvbmZpZy5zZWN1cml0eUtleSxcbiAgICAgIFwib3JnYW5pemF0aW9uX2lkXCI6IGNvbmZpZy5vcmdhbml6YXRpb25fSWQsXG4gICAgICBcImRhdGEtY29sbGVjdGlvblwiOiBjb2xsZWN0aW9uLFxuICAgICAgXCJsb2dpbkRhdGFcIjogbG9naW5EYXRhXG4gICAgfVxuXG4gICAgQ29DcmVhdGUuc29ja2V0LnNlbmQoJ2xvZ2luJywganNvbik7XG4gIH0pXG59XG5cbmZ1bmN0aW9uIGxvZ2luUmVzdWx0KGRhdGEpIHtcbiAgY29uc3Qge3N1Y2Nlc3MsIHN0YXR1cywgbWVzc2FnZSB9ID0gZGF0YTtcbiAgXG4gIENvQ3JlYXRlLnJlbmRlci5kYXRhKHtcbiAgICBzZWxlY3RvcjogXCJbZGF0YS10ZW1wbGF0ZV9pZD0nYWZ0ZXJMb2dpblJlc3BvbnNlJ11cIiwgXG4gICAgcmVuZGVyOiBkYXRhXG4gIH0pXG5cbiAgaWYgKGRhdGEuc3VjY2Vzcykge1xuICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCd1c2VyX2lkJywgZGF0YVsnaWQnXSk7XG4gICAgbGV0IGhyZWYgPSBcIlwiO1xuICAgIGxldCBhVGFnID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcImZvcm0gLmxvZ2luQnRuIGFcIik7XG4gICAgaWYgKGFUYWcpIHtcbiAgICAgIGhyZWYgPSBhVGFnLmdldEF0dHJpYnV0ZSgnaHJlZicpO1xuICAgIH1cbiAgICBnZXRDdXJyZW50T3JnKGRhdGFbJ2lkJ10sIGRhdGFbJ2NvbGxlY3Rpb24nXSwgaHJlZik7XG5cbiAgfSBlbHNlIHtcbiAgICAvLy4gcmVuZGVyIGRhdGFcbiAgICBcbiAgfVxufVxuXG5cbmZ1bmN0aW9uIGdldEN1cnJlbnRPcmcodXNlcl9pZCwgY29sbGVjdGlvbiwgaHJlZikge1xuICB2YXIganNvbiA9IHtcbiAgICBcImRhdGEtY29sbGVjdGlvblwiOiBjb2xsZWN0aW9uIHx8IHVzZXJzQ29sbGVjdGlvbixcbiAgICBcInVzZXJfaWRcIjogdXNlcl9pZCxcbiAgICBcImhyZWZcIjogaHJlZlxuICB9XG4gIFxuICBDb0NyZWF0ZS5zb2NrZXQuc2VuZCgndXNlcnNDdXJyZW50T3JnJywganNvbik7XG59XG5cbmZ1bmN0aW9uIHVzZXJSZWdpc3RlckFjdGlvbihlbCkge1xuICBpZiAoIWVsKSByZXR1cm47XG4gIHZhciBmb3JtID0gZWwuY2xvc2VzdCgnZm9ybScpO1xuICBpZiAoIWZvcm0pIHJldHVybjtcbiAgQ29DcmVhdGUuZm9ybS5yZXF1ZXN0KHsgZm9ybSB9KTtcbn1cblxuZnVuY3Rpb24gcmVnaXN0ZXJSZXN1bHQoZGF0YSkge1xuXG4gIGlmIChkYXRhWydjb2xsZWN0aW9uJ10gPT09IG9yZ0NvbGxlY3Rpb24pIHtcbiAgICBjcmVhdGVkT3JnSWQgPSBkYXRhWydkb2N1bWVudF9pZCddO1xuICB9XG4gIFxuICBpZiAoZGF0YVsnY29sbGVjdGlvbiddID09PSB1c2Vyc0NvbGxlY3Rpb24pIHtcbiAgICBjcmVhdGVkVXNlcklkID0gZGF0YVsnZG9jdW1lbnRfaWQnXTtcbiAgfVxuICBcbiAgaWYgKGNyZWF0ZWRPcmdJZCAmJiBjcmVhdGVkVXNlcklkKSB7XG4gICAgQ29DcmVhdGUuY3J1ZC51cGRhdGVEb2N1bWVudCh7XG4gICAgICBicm9hZGNhc3Q6IGZhbHNlLFxuICAgICAgY29sbGVjdGlvbjogdXNlcnNDb2xsZWN0aW9uLFxuICAgICAgZG9jdW1lbnRfaWQ6IGNyZWF0ZWRVc2VySWQsXG4gICAgICBkYXRhOiB7XG4gICAgICAgIGN1cnJlbnRfb3JnOiBjcmVhdGVkT3JnSWQsXG4gICAgICAgIGNvbm5lY3RlZF9vcmdzOiBbY3JlYXRlZE9yZ0lkXVxuICAgICAgfSwgXG4gICAgICBicm9hZGNhc3Q6IGZhbHNlXG4gICAgfSlcblxuICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCd1c2VyX2lkJywgY3JlYXRlZFVzZXJJZClcbiAgICAvLyBsZXQgYVRhZyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucmVnaXN0ZXJCdG4gPiBhXCIpO1xuICAgIC8vIGxldCBocmVmID0gXCJcIjtcbiAgICAvLyBpZiAoYVRhZykge1xuICAgIC8vICAgaHJlZj0gYVRhZy5nZXRBdHRyaWJ1dGUoXCJocmVmXCIpO1xuICAgIC8vIH1cbiAgICBcbiAgICBnZXRDdXJyZW50T3JnKGNyZWF0ZWRVc2VySWQsIHVzZXJzQ29sbGVjdGlvbiwgbnVsbCk7XG4gIH1cbn1cblxuZnVuY3Rpb24gaW5pdEN1cnJlbnRPcmdFbGVzKCkge1xuICB2YXIgdXNlcl9pZCA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd1c2VyX2lkJyk7XG4gIFxuICBpZiAoIXVzZXJfaWQpIHJldHVybjtcbiAgXG4gIGxldCBvcmdDaGFuZ2VycyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5vcmctY2hhbmdlcicpO1xuICBcbiAgZm9yIChsZXQgaT0wOyBpIDwgb3JnQ2hhbmdlcnMubGVuZ3RoOyBpKyspIHtcbiAgICBsZXQgb3JnQ2hhbmdlciA9IG9yZ0NoYW5nZXJzW2ldO1xuICAgIFxuICAgIHZhciBjb2xsZWN0aW9uID0gb3JnQ2hhbmdlci5nZXRBdHRyaWJ1dGUoJ2RhdGEtY29sbGVjdGlvbicpID8gb3JnQ2hhbmdlci5nZXRBdHRyaWJ1dGUoJ2RhdGEtY29sbGVjdGlvbicpOiAnbW9kdWxlX2FjdGl2aXR5JztcbiAgICB2YXIgaWQgPSBvcmdDaGFuZ2VyLmdldEF0dHJpYnV0ZSgnZGF0YS1kb2N1bWVudF9pZCcpO1xuICAgIFxuICAgIGlmIChjb2xsZWN0aW9uID09ICd1c2VycycgJiYgaWQgPT0gdXNlcl9pZCkge1xuICAgICAgb3JnQ2hhbmdlci5hZGRFdmVudExpc3RlbmVyKCdzZWxlY3RlZFZhbHVlJywgZnVuY3Rpb24oZSkgeyAgICBcblxuICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgIGdldEN1cnJlbnRPcmcodXNlcl9pZCk7XG4gICAgICAgICAgXG4gICAgICAgICAgdmFyIHRpbWVyID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBpZiAodXBkYXRlZEN1cnJlbnRPcmcpIHtcbiAgICAgICAgICAgICAgbG9jYXRpb24ucmVsb2FkKCk7XG4gICAgICAgICAgICAgIFxuICAgICAgICAgICAgICBjbGVhckludGVydmFsKHRpbWVyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LCAxMDApXG4gICAgICAgIH0sIDMwMClcbiAgICAgIH0pXG4gICAgfVxuICB9XG59XG5cbmZ1bmN0aW9uIGluaXRMb2dvdXRCdG4oKSB7XG4gIGxldCBsb2dvdXRCdG5zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmxvZ291dEJ0bicpO1xuICBcbiAgZm9yIChsZXQgaT0wOyBpPGxvZ291dEJ0bnMubGVuZ3RoOyBpKyspIHtcbiAgICBsZXQgbG9nb3V0QnRuID0gbG9nb3V0QnRuc1tpXTtcbiAgICBcbiAgICBsb2dvdXRCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihlKSB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICBcbiAgICAgIGxvY2FsU3RvcmFnZS5jbGVhcigpO1xuICAgICAgXG4gICAgICBsZXQgaHJlZiA9IHRoaXMuZ2V0QXR0cmlidXRlKCdocmVmJyk7XG4gICAgICBpZiAoaHJlZikgZG9jdW1lbnQubG9jYXRpb24uaHJlZiA9IGhyZWY7XG4gICAgfSlcbiAgfVxufVxuXG5mdW5jdGlvbiBjaGVja1Nlc3Npb24oKSB7XG4gIFxuICB2YXIgdXNlcl9pZCA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd1c2VyX2lkJyk7XG4gIFxuICBpZiAodXNlcl9pZCkge1xuICAgIHZhciByZWRpcmVjdFRhZyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zZXNzaW9uVHJ1ZScpO1xuXG4gICAgaWYgKHJlZGlyZWN0VGFnKSB7XG4gICAgICBsZXQgcmVkaXJlY3RMaW5rID0gcmVkaXJlY3RUYWcuZ2V0QXR0cmlidXRlKCdocmVmJyk7XG4gICAgICBpZiAocmVkaXJlY3RMaW5rKSB7XG4gICAgICAgIGRvY3VtZW50LmxvY2F0aW9uLmhyZWYgPSByZWRpcmVjdExpbmtcbiAgICAgIH0gXG4gICAgfVxuICB9IGVsc2Uge1xuICAgIHZhciByZWRpcmVjdFRhZyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zZXNzaW9uRmFsc2UnKTtcbiAgXG4gICAgaWYgKHJlZGlyZWN0VGFnKSB7XG4gICAgICBsZXQgcmVkaXJlY3RMaW5rID0gcmVkaXJlY3RUYWcuZ2V0QXR0cmlidXRlKCdocmVmJyk7XG4gICAgICBpZiAocmVkaXJlY3RMaW5rKSB7XG4gICAgICAgIGxvY2FsU3RvcmFnZS5jbGVhcigpO1xuICAgICAgICBkb2N1bWVudC5sb2NhdGlvbi5ocmVmID0gcmVkaXJlY3RMaW5rIFxuICAgICAgfVxuICAgIH1cbiAgfVxufVxuXG5mdW5jdGlvbiBjaGFuZ2VkVXNlclN0YXR1cyhkYXRhKSB7XG4gIGlmICghZGF0YS51c2VyX2lkKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIGxldCBzdGF0dXNFbHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGBbZGF0YS11c2VyX3N0YXR1c11bZGF0YS1kb2N1bWVudF9pZD0nJHtkYXRhWyd1c2VyX2lkJ119J11gKVxuICBcbiAgc3RhdHVzRWxzLmZvckVhY2goKGVsKSA9PiB7XG4gICAgZWwuc2V0QXR0cmlidXRlKCdkYXRhLXVzZXJfc3RhdHVzJywgZGF0YVsnc3RhdHVzJ10pO1xuICB9KVxufVxuXG5leHBvcnQgZGVmYXVsdCB7aW5pdFNvY2tldHNGb3JVc2VycywgZmV0Y2hVc2VyLCBmZXRjaGVkVXNlciwgY2hlY2tQZXJtaXNzaW9ucywgaW5pdExvZ2luRm9ybXMsIGluaXRMb2dpbkZvcm0sIFxubG9naW5SZXN1bHQsIGdldEN1cnJlbnRPcmcsIHVzZXJSZWdpc3RlckFjdGlvbiwgcmVnaXN0ZXJSZXN1bHQsIGluaXRDdXJyZW50T3JnRWxlcywgXG5pbml0TG9nb3V0QnRuLCBjaGVja1Nlc3Npb24sIGNoYW5nZWRVc2VyU3RhdHVzfTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///../../CoCreateJS/node_modules/@cocreate/users/src/index.js\n")}}]);
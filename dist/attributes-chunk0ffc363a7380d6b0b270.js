/*! For license information please see attributes-chunk0ffc363a7380d6b0b270.js.LICENSE.txt */
(this.webpackChunkCoCreate_attributes=this.webpackChunkCoCreate_attributes||[]).push([["attributes-chunk"],{"../../CoCreateJS/node_modules/@cocreate/attributes/src/common.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   "parseClassRules": () => (/* binding */ parseClassRules),\n/* harmony export */   "getCoCreateStyle": () => (/* binding */ getCoCreateStyle),\n/* harmony export */   "setStyleClassIfDif": () => (/* binding */ setStyleClassIfDif),\n/* harmony export */   "setAttributeIfDif": () => (/* binding */ setAttributeIfDif),\n/* harmony export */   "setStyleIfDif": () => (/* binding */ setStyleIfDif),\n/* harmony export */   "removeAllSelectedOptions": () => (/* binding */ removeAllSelectedOptions),\n/* harmony export */   "renderOptions": () => (/* binding */ renderOptions),\n/* harmony export */   "parseCssRules": () => (/* binding */ parseCssRules),\n/* harmony export */   "rgba2hex": () => (/* binding */ rgba2hex),\n/* harmony export */   "parseUnit": () => (/* binding */ parseUnit),\n/* harmony export */   "toCamelCase": () => (/* binding */ toCamelCase),\n/* harmony export */   "elStore": () => (/* binding */ elStore)\n/* harmony export */ });\n/* harmony import */ var _cocreate_select__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @cocreate/select */ "../../CoCreateJS/node_modules/@cocreate/select/src/index.js");\n/*global CoCreate*/\n\nfunction parseClassRules(str) {\n    return str.split(\' \').filter(cln => cln);\n\n}\n\nfunction getCoCreateStyle(classList) {\n    let styles = {};\n    classList.forEach((classname) => {\n        let [name, value] = classname.split(":");\n        styles[toCamelCase(name)] = value;\n    });\n\n    return styles;\n}\n\n\n\n\nfunction setStyleClassIfDif(element, { property, camelProperty, value, computedStyles }) {\n    let classList = element.classList;\n    let styleList = new Map();\n    classList.forEach((classname) => {\n        let [name, value] = classname.split(":");\n        value && styleList.set(name, value);\n    });\n\n    let elValue = styleList.get(property);\n\n    if (value) {\n        if (elValue) {\n            if (elValue != value)\n                return classList.replace(`${property}:${elValue}`, `${property}:${value}`);\n        }\n        else if (computedStyles[camelProperty] != value && !classList.contains(`${property}:${value}`))\n        {\n            classList.add(`${property}:${value}`);\n            return true;\n        }\n\n    }\n    else {\n        if (classList.contains(`${property}:${elValue}`)) {\n            classList.remove(`${property}:${elValue}`);\n            return true;\n        }\n\n    }\n\n    return false\n}\n\n\nfunction setAttributeIfDif(property, value) {\n    if (this.getAttribute(property) !== value) {\n        if (value)\n            this.setAttribute(property, value);\n        else\n            this.removeAttribute(property)\n        return true;\n    }\n    return false;\n}\n\nfunction setStyleIfDif({ property, camelProperty, value, computedStyles }) {\n    if (computedStyles[camelProperty] && computedStyles[camelProperty] !== value) {\n        this.style[property] = value;\n        return true;\n    }\n    else return false;\n}\n\n\n// CoCreate Select helper\n// export function getAllSelectedOptions() {\n//     let options = this.querySelectorAll(":scope > [selected]");\n//     return Array.from(options).map((o) => o.getAttribute("value"));\n// };\n\nfunction removeAllSelectedOptions() {\n    let options = this.querySelectorAll(":scope > [selected]");\n    return Array.from(options).forEach((o) => o.remove());\n};\n\n// export function getAllOptions() {\n//     let options = this.querySelectorAll(":scope > ul > [value]");\n//     return Array.from(options).map((o) => o.getAttribute("value"));\n// };\n\nfunction renderOptions(input, arrValue) {\n    if (arrValue && arrValue.length)\n        _cocreate_select__WEBPACK_IMPORTED_MODULE_0__.default.renderValue(input, arrValue)\n    else\n        removeAllSelectedOptions.call(input)\n}\n// CoCreate Select helper end  \nfunction parseCssRules(str) {\n    let styleObject = {};\n    if (str.split)\n        str.split(";").forEach((rule) => {\n            let ruleSplit = rule.split(":");\n            let key = ruleSplit.shift().trim();\n            let value = ruleSplit.join().trim();\n            if (key) styleObject[key] = value;\n        });\n\n    return styleObject;\n}\n\n\n\n\n\n\n\n\n\n\n\n\nfunction rgba2hex(orig) {\n    let a, isPercent,\n        rgb = orig.replace(/\\s/g, \'\').match(/^rgba?\\((\\d+),(\\d+),(\\d+),?([^,\\s)]+)?/i),\n        alpha = (rgb && rgb[4] || "").trim(),\n        hex = rgb ?\n        (rgb[1] | 1 << 8).toString(16).slice(1) +\n        (rgb[2] | 1 << 8).toString(16).slice(1) +\n        (rgb[3] | 1 << 8).toString(16).slice(1) : orig;\n\n    if (alpha !== "") {\n        a = alpha;\n    }\n    else {\n        a = 1;\n    }\n    // multiply before convert to HEX\n    a = ((a * 255) | 1 << 8).toString(16).slice(1)\n    hex = hex + a;\n\n    return hex;\n}\n\n\n\nfunction parseUnit(style) {\n    let value = parseFloat(style);\n    if (isNaN(value))\n        return [style, \'\']\n    else {\n        let valueLength = (value + "").length;\n        return [value, style.substr(valueLength)];\n\n    }\n}\n\n\nfunction toCamelCase(str) {\n    let index = 0;\n    do {\n        index = str.indexOf("-", index);\n        if (index !== -1) {\n            let t = str.substring(0, index);\n            t += String.fromCharCode(str.charCodeAt(index + 1) - 32);\n            t += str.substr(index + 2);\n            str = t;\n        }\n        else break;\n    } while (true);\n    return str;\n}\n\n// export function setCCStyle({ property, camelProperty, value, computedStyles }) {\n//     let hasChanged = false;\n//     if (computedStyles[camelProperty]  && computedStyles[camelProperty] !== value) {\n//         for (let classname of this.classList) {\n//             let [name, styleValue] = classname.split(":");\n//             if (name === property && styleValue) {\n//                 if (value)\n//                     this.classList.replace(classname, property + ":" + value);\n//                 else\n//                     this.classList.remove(classname)\n//                 hasChanged = true;\n//                 break;\n//             }\n//         }\n//         if (!hasChanged)\n//             this.classList.add(property + ":" + value);\n//         return true;\n//     } else\n//         return false;\n// }\n\n\n\n\n\n\n\nfunction elStore() {\n    this.cache = new Map();\n    this.spread = function set(key, object) {\n        this.cache.set(key, { ...this.cache.get(key), ...object })\n    }\n    this.set = function set(key, property, value) {\n        this.cache.set(key, { ...this.cache.get(key), [property]: value })\n    }\n    this.get = function get(key, property) {\n        let value = this.cache.get(key)\n        return value ? value[property] : undefined;\n    }\n    this.reset = function reset(key) {\n        this.cache.delete(key)\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9Db0NyZWF0ZS5hdHRyaWJ1dGVzLy4uLy4uL0NvQ3JlYXRlSlMvbm9kZV9tb2R1bGVzL0Bjb2NyZWF0ZS9hdHRyaWJ1dGVzL3NyYy9jb21tb24uanM/ZTRlMyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFDcUM7QUFDOUI7QUFDUDs7QUFFQTs7QUFFTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBOzs7OztBQUtPLHNDQUFzQyxpREFBaUQ7QUFDOUY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7O0FBRUw7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsNENBQTRDLFNBQVMsR0FBRyxRQUFRLE1BQU0sU0FBUyxHQUFHLE1BQU07QUFDeEY7QUFDQSxrRkFBa0YsU0FBUyxHQUFHLE1BQU07QUFDcEc7QUFDQSw2QkFBNkIsU0FBUyxHQUFHLE1BQU07QUFDL0M7QUFDQTs7QUFFQTtBQUNBO0FBQ0Esa0NBQWtDLFNBQVMsR0FBRyxRQUFRO0FBQ3RELGdDQUFnQyxTQUFTLEdBQUcsUUFBUTtBQUNwRDtBQUNBOztBQUVBOztBQUVBO0FBQ0E7OztBQUdPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVPLHdCQUF3QixpREFBaUQ7QUFDaEY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVPO0FBQ1A7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVPO0FBQ1A7QUFDQSxRQUFRLGlFQUFrQjtBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBLG9CQUFvQjtBQUNwQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7O0FBRVQ7QUFDQTs7Ozs7Ozs7Ozs7OztBQWFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7Ozs7QUFJTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOzs7QUFHTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7O0FBRUEsK0JBQStCLGlEQUFpRDtBQUNoRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBOzs7Ozs7OztBQVFPO0FBQ1A7QUFDQTtBQUNBLDZCQUE2QixvQ0FBb0M7QUFDakU7QUFDQTtBQUNBLDZCQUE2Qiw0Q0FBNEM7QUFDekU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6Ii4uLy4uL0NvQ3JlYXRlSlMvbm9kZV9tb2R1bGVzL0Bjb2NyZWF0ZS9hdHRyaWJ1dGVzL3NyYy9jb21tb24uanMuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKmdsb2JhbCBDb0NyZWF0ZSovXG5pbXBvcnQgc2VsZWN0IGZyb20gJ0Bjb2NyZWF0ZS9zZWxlY3QnXG5leHBvcnQgZnVuY3Rpb24gcGFyc2VDbGFzc1J1bGVzKHN0cikge1xuICAgIHJldHVybiBzdHIuc3BsaXQoJyAnKS5maWx0ZXIoY2xuID0+IGNsbik7XG5cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldENvQ3JlYXRlU3R5bGUoY2xhc3NMaXN0KSB7XG4gICAgbGV0IHN0eWxlcyA9IHt9O1xuICAgIGNsYXNzTGlzdC5mb3JFYWNoKChjbGFzc25hbWUpID0+IHtcbiAgICAgICAgbGV0IFtuYW1lLCB2YWx1ZV0gPSBjbGFzc25hbWUuc3BsaXQoXCI6XCIpO1xuICAgICAgICBzdHlsZXNbdG9DYW1lbENhc2UobmFtZSldID0gdmFsdWU7XG4gICAgfSk7XG5cbiAgICByZXR1cm4gc3R5bGVzO1xufVxuXG5cblxuXG5leHBvcnQgZnVuY3Rpb24gc2V0U3R5bGVDbGFzc0lmRGlmKGVsZW1lbnQsIHsgcHJvcGVydHksIGNhbWVsUHJvcGVydHksIHZhbHVlLCBjb21wdXRlZFN0eWxlcyB9KSB7XG4gICAgbGV0IGNsYXNzTGlzdCA9IGVsZW1lbnQuY2xhc3NMaXN0O1xuICAgIGxldCBzdHlsZUxpc3QgPSBuZXcgTWFwKCk7XG4gICAgY2xhc3NMaXN0LmZvckVhY2goKGNsYXNzbmFtZSkgPT4ge1xuICAgICAgICBsZXQgW25hbWUsIHZhbHVlXSA9IGNsYXNzbmFtZS5zcGxpdChcIjpcIik7XG4gICAgICAgIHZhbHVlICYmIHN0eWxlTGlzdC5zZXQobmFtZSwgdmFsdWUpO1xuICAgIH0pO1xuXG4gICAgbGV0IGVsVmFsdWUgPSBzdHlsZUxpc3QuZ2V0KHByb3BlcnR5KTtcblxuICAgIGlmICh2YWx1ZSkge1xuICAgICAgICBpZiAoZWxWYWx1ZSkge1xuICAgICAgICAgICAgaWYgKGVsVmFsdWUgIT0gdmFsdWUpXG4gICAgICAgICAgICAgICAgcmV0dXJuIGNsYXNzTGlzdC5yZXBsYWNlKGAke3Byb3BlcnR5fToke2VsVmFsdWV9YCwgYCR7cHJvcGVydHl9OiR7dmFsdWV9YCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoY29tcHV0ZWRTdHlsZXNbY2FtZWxQcm9wZXJ0eV0gIT0gdmFsdWUgJiYgIWNsYXNzTGlzdC5jb250YWlucyhgJHtwcm9wZXJ0eX06JHt2YWx1ZX1gKSlcbiAgICAgICAge1xuICAgICAgICAgICAgY2xhc3NMaXN0LmFkZChgJHtwcm9wZXJ0eX06JHt2YWx1ZX1gKTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG5cbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGlmIChjbGFzc0xpc3QuY29udGFpbnMoYCR7cHJvcGVydHl9OiR7ZWxWYWx1ZX1gKSkge1xuICAgICAgICAgICAgY2xhc3NMaXN0LnJlbW92ZShgJHtwcm9wZXJ0eX06JHtlbFZhbHVlfWApO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cblxuICAgIH1cblxuICAgIHJldHVybiBmYWxzZVxufVxuXG5cbmV4cG9ydCBmdW5jdGlvbiBzZXRBdHRyaWJ1dGVJZkRpZihwcm9wZXJ0eSwgdmFsdWUpIHtcbiAgICBpZiAodGhpcy5nZXRBdHRyaWJ1dGUocHJvcGVydHkpICE9PSB2YWx1ZSkge1xuICAgICAgICBpZiAodmFsdWUpXG4gICAgICAgICAgICB0aGlzLnNldEF0dHJpYnV0ZShwcm9wZXJ0eSwgdmFsdWUpO1xuICAgICAgICBlbHNlXG4gICAgICAgICAgICB0aGlzLnJlbW92ZUF0dHJpYnV0ZShwcm9wZXJ0eSlcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHNldFN0eWxlSWZEaWYoeyBwcm9wZXJ0eSwgY2FtZWxQcm9wZXJ0eSwgdmFsdWUsIGNvbXB1dGVkU3R5bGVzIH0pIHtcbiAgICBpZiAoY29tcHV0ZWRTdHlsZXNbY2FtZWxQcm9wZXJ0eV0gJiYgY29tcHV0ZWRTdHlsZXNbY2FtZWxQcm9wZXJ0eV0gIT09IHZhbHVlKSB7XG4gICAgICAgIHRoaXMuc3R5bGVbcHJvcGVydHldID0gdmFsdWU7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICBlbHNlIHJldHVybiBmYWxzZTtcbn1cblxuXG4vLyBDb0NyZWF0ZSBTZWxlY3QgaGVscGVyXG4vLyBleHBvcnQgZnVuY3Rpb24gZ2V0QWxsU2VsZWN0ZWRPcHRpb25zKCkge1xuLy8gICAgIGxldCBvcHRpb25zID0gdGhpcy5xdWVyeVNlbGVjdG9yQWxsKFwiOnNjb3BlID4gW3NlbGVjdGVkXVwiKTtcbi8vICAgICByZXR1cm4gQXJyYXkuZnJvbShvcHRpb25zKS5tYXAoKG8pID0+IG8uZ2V0QXR0cmlidXRlKFwidmFsdWVcIikpO1xuLy8gfTtcblxuZXhwb3J0IGZ1bmN0aW9uIHJlbW92ZUFsbFNlbGVjdGVkT3B0aW9ucygpIHtcbiAgICBsZXQgb3B0aW9ucyA9IHRoaXMucXVlcnlTZWxlY3RvckFsbChcIjpzY29wZSA+IFtzZWxlY3RlZF1cIik7XG4gICAgcmV0dXJuIEFycmF5LmZyb20ob3B0aW9ucykuZm9yRWFjaCgobykgPT4gby5yZW1vdmUoKSk7XG59O1xuXG4vLyBleHBvcnQgZnVuY3Rpb24gZ2V0QWxsT3B0aW9ucygpIHtcbi8vICAgICBsZXQgb3B0aW9ucyA9IHRoaXMucXVlcnlTZWxlY3RvckFsbChcIjpzY29wZSA+IHVsID4gW3ZhbHVlXVwiKTtcbi8vICAgICByZXR1cm4gQXJyYXkuZnJvbShvcHRpb25zKS5tYXAoKG8pID0+IG8uZ2V0QXR0cmlidXRlKFwidmFsdWVcIikpO1xuLy8gfTtcblxuZXhwb3J0IGZ1bmN0aW9uIHJlbmRlck9wdGlvbnMoaW5wdXQsIGFyclZhbHVlKSB7XG4gICAgaWYgKGFyclZhbHVlICYmIGFyclZhbHVlLmxlbmd0aClcbiAgICAgICAgc2VsZWN0LnJlbmRlclZhbHVlKGlucHV0LCBhcnJWYWx1ZSlcbiAgICBlbHNlXG4gICAgICAgIHJlbW92ZUFsbFNlbGVjdGVkT3B0aW9ucy5jYWxsKGlucHV0KVxufVxuLy8gQ29DcmVhdGUgU2VsZWN0IGhlbHBlciBlbmQgIFxuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlQ3NzUnVsZXMoc3RyKSB7XG4gICAgbGV0IHN0eWxlT2JqZWN0ID0ge307XG4gICAgaWYgKHN0ci5zcGxpdClcbiAgICAgICAgc3RyLnNwbGl0KFwiO1wiKS5mb3JFYWNoKChydWxlKSA9PiB7XG4gICAgICAgICAgICBsZXQgcnVsZVNwbGl0ID0gcnVsZS5zcGxpdChcIjpcIik7XG4gICAgICAgICAgICBsZXQga2V5ID0gcnVsZVNwbGl0LnNoaWZ0KCkudHJpbSgpO1xuICAgICAgICAgICAgbGV0IHZhbHVlID0gcnVsZVNwbGl0LmpvaW4oKS50cmltKCk7XG4gICAgICAgICAgICBpZiAoa2V5KSBzdHlsZU9iamVjdFtrZXldID0gdmFsdWU7XG4gICAgICAgIH0pO1xuXG4gICAgcmV0dXJuIHN0eWxlT2JqZWN0O1xufVxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuZXhwb3J0IGZ1bmN0aW9uIHJnYmEyaGV4KG9yaWcpIHtcbiAgICBsZXQgYSwgaXNQZXJjZW50LFxuICAgICAgICByZ2IgPSBvcmlnLnJlcGxhY2UoL1xccy9nLCAnJykubWF0Y2goL15yZ2JhP1xcKChcXGQrKSwoXFxkKyksKFxcZCspLD8oW14sXFxzKV0rKT8vaSksXG4gICAgICAgIGFscGhhID0gKHJnYiAmJiByZ2JbNF0gfHwgXCJcIikudHJpbSgpLFxuICAgICAgICBoZXggPSByZ2IgP1xuICAgICAgICAocmdiWzFdIHwgMSA8PCA4KS50b1N0cmluZygxNikuc2xpY2UoMSkgK1xuICAgICAgICAocmdiWzJdIHwgMSA8PCA4KS50b1N0cmluZygxNikuc2xpY2UoMSkgK1xuICAgICAgICAocmdiWzNdIHwgMSA8PCA4KS50b1N0cmluZygxNikuc2xpY2UoMSkgOiBvcmlnO1xuXG4gICAgaWYgKGFscGhhICE9PSBcIlwiKSB7XG4gICAgICAgIGEgPSBhbHBoYTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGEgPSAxO1xuICAgIH1cbiAgICAvLyBtdWx0aXBseSBiZWZvcmUgY29udmVydCB0byBIRVhcbiAgICBhID0gKChhICogMjU1KSB8IDEgPDwgOCkudG9TdHJpbmcoMTYpLnNsaWNlKDEpXG4gICAgaGV4ID0gaGV4ICsgYTtcblxuICAgIHJldHVybiBoZXg7XG59XG5cblxuXG5leHBvcnQgZnVuY3Rpb24gcGFyc2VVbml0KHN0eWxlKSB7XG4gICAgbGV0IHZhbHVlID0gcGFyc2VGbG9hdChzdHlsZSk7XG4gICAgaWYgKGlzTmFOKHZhbHVlKSlcbiAgICAgICAgcmV0dXJuIFtzdHlsZSwgJyddXG4gICAgZWxzZSB7XG4gICAgICAgIGxldCB2YWx1ZUxlbmd0aCA9ICh2YWx1ZSArIFwiXCIpLmxlbmd0aDtcbiAgICAgICAgcmV0dXJuIFt2YWx1ZSwgc3R5bGUuc3Vic3RyKHZhbHVlTGVuZ3RoKV07XG5cbiAgICB9XG59XG5cblxuZXhwb3J0IGZ1bmN0aW9uIHRvQ2FtZWxDYXNlKHN0cikge1xuICAgIGxldCBpbmRleCA9IDA7XG4gICAgZG8ge1xuICAgICAgICBpbmRleCA9IHN0ci5pbmRleE9mKFwiLVwiLCBpbmRleCk7XG4gICAgICAgIGlmIChpbmRleCAhPT0gLTEpIHtcbiAgICAgICAgICAgIGxldCB0ID0gc3RyLnN1YnN0cmluZygwLCBpbmRleCk7XG4gICAgICAgICAgICB0ICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoc3RyLmNoYXJDb2RlQXQoaW5kZXggKyAxKSAtIDMyKTtcbiAgICAgICAgICAgIHQgKz0gc3RyLnN1YnN0cihpbmRleCArIDIpO1xuICAgICAgICAgICAgc3RyID0gdDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGJyZWFrO1xuICAgIH0gd2hpbGUgKHRydWUpO1xuICAgIHJldHVybiBzdHI7XG59XG5cbi8vIGV4cG9ydCBmdW5jdGlvbiBzZXRDQ1N0eWxlKHsgcHJvcGVydHksIGNhbWVsUHJvcGVydHksIHZhbHVlLCBjb21wdXRlZFN0eWxlcyB9KSB7XG4vLyAgICAgbGV0IGhhc0NoYW5nZWQgPSBmYWxzZTtcbi8vICAgICBpZiAoY29tcHV0ZWRTdHlsZXNbY2FtZWxQcm9wZXJ0eV0gICYmIGNvbXB1dGVkU3R5bGVzW2NhbWVsUHJvcGVydHldICE9PSB2YWx1ZSkge1xuLy8gICAgICAgICBmb3IgKGxldCBjbGFzc25hbWUgb2YgdGhpcy5jbGFzc0xpc3QpIHtcbi8vICAgICAgICAgICAgIGxldCBbbmFtZSwgc3R5bGVWYWx1ZV0gPSBjbGFzc25hbWUuc3BsaXQoXCI6XCIpO1xuLy8gICAgICAgICAgICAgaWYgKG5hbWUgPT09IHByb3BlcnR5ICYmIHN0eWxlVmFsdWUpIHtcbi8vICAgICAgICAgICAgICAgICBpZiAodmFsdWUpXG4vLyAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2xhc3NMaXN0LnJlcGxhY2UoY2xhc3NuYW1lLCBwcm9wZXJ0eSArIFwiOlwiICsgdmFsdWUpO1xuLy8gICAgICAgICAgICAgICAgIGVsc2Vcbi8vICAgICAgICAgICAgICAgICAgICAgdGhpcy5jbGFzc0xpc3QucmVtb3ZlKGNsYXNzbmFtZSlcbi8vICAgICAgICAgICAgICAgICBoYXNDaGFuZ2VkID0gdHJ1ZTtcbi8vICAgICAgICAgICAgICAgICBicmVhaztcbi8vICAgICAgICAgICAgIH1cbi8vICAgICAgICAgfVxuLy8gICAgICAgICBpZiAoIWhhc0NoYW5nZWQpXG4vLyAgICAgICAgICAgICB0aGlzLmNsYXNzTGlzdC5hZGQocHJvcGVydHkgKyBcIjpcIiArIHZhbHVlKTtcbi8vICAgICAgICAgcmV0dXJuIHRydWU7XG4vLyAgICAgfSBlbHNlXG4vLyAgICAgICAgIHJldHVybiBmYWxzZTtcbi8vIH1cblxuXG5cblxuXG5cblxuZXhwb3J0IGZ1bmN0aW9uIGVsU3RvcmUoKSB7XG4gICAgdGhpcy5jYWNoZSA9IG5ldyBNYXAoKTtcbiAgICB0aGlzLnNwcmVhZCA9IGZ1bmN0aW9uIHNldChrZXksIG9iamVjdCkge1xuICAgICAgICB0aGlzLmNhY2hlLnNldChrZXksIHsgLi4udGhpcy5jYWNoZS5nZXQoa2V5KSwgLi4ub2JqZWN0IH0pXG4gICAgfVxuICAgIHRoaXMuc2V0ID0gZnVuY3Rpb24gc2V0KGtleSwgcHJvcGVydHksIHZhbHVlKSB7XG4gICAgICAgIHRoaXMuY2FjaGUuc2V0KGtleSwgeyAuLi50aGlzLmNhY2hlLmdldChrZXkpLCBbcHJvcGVydHldOiB2YWx1ZSB9KVxuICAgIH1cbiAgICB0aGlzLmdldCA9IGZ1bmN0aW9uIGdldChrZXksIHByb3BlcnR5KSB7XG4gICAgICAgIGxldCB2YWx1ZSA9IHRoaXMuY2FjaGUuZ2V0KGtleSlcbiAgICAgICAgcmV0dXJuIHZhbHVlID8gdmFsdWVbcHJvcGVydHldIDogdW5kZWZpbmVkO1xuICAgIH1cbiAgICB0aGlzLnJlc2V0ID0gZnVuY3Rpb24gcmVzZXQoa2V5KSB7XG4gICAgICAgIHRoaXMuY2FjaGUuZGVsZXRlKGtleSlcbiAgICB9XG59XG4iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///../../CoCreateJS/node_modules/@cocreate/attributes/src/common.js\n')},"../../CoCreateJS/node_modules/@cocreate/attributes/src/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _common_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./common.js */ \"../../CoCreateJS/node_modules/@cocreate/attributes/src/common.js\");\n/* harmony import */ var _cocreate_observer__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @cocreate/observer */ \"../../CoCreateJS/node_modules/@cocreate/observer/src/index.js\");\n/* harmony import */ var _cocreate_crdt__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @cocreate/crdt */ \"../../CoCreateJS/node_modules/@cocreate/crdt/src/index.js\");\n/* harmony import */ var _cocreate_pickr__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @cocreate/pickr */ \"../../CoCreateJS/node_modules/@cocreate/pickr/src/index.js\");\n/* harmony import */ var _cocreate_cocreatejs__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @cocreate/cocreatejs */ \"../../CoCreateJS/node_modules/@cocreate/cocreatejs/src/index.js\");\n/*global CoCreate*/\n\n\n\n\n\n\n\n// // dev start\n// import '@cocreate/select'\n// import selected from '@cocreate/selected'\n// import domToText from '@cocreate/domToText'\n\n\n// selected.config({\n//     srcDocument: document,\n//     destDocument: document,\n//     selector: \"#container *\",\n//     target: \"[data-attributes]:not(.styleunit)\",\n//     callback: (element, target) => {\n//         target.setAttribute('data-attributes_target', `[data-element_id=${element.getAttribute('data-element_id')}]`);\n//         target.setAttribute('name', target.id + '-' + element.getAttribute('data-element_id'))\n//     }\n// });\n\n\n\n\n\n\n// //profile observer\n// let profile = []\n\n// function profileObserver(mutation, extra = {}) {\n\n//     // get time\n//     let date = new Date();\n//     let time = date.getSeconds() + '.' + date.getMilliseconds()\n//     profile.push({ time, ...extra, ...mutation })\n// }\n\n\n// // dev end\n\nlet cache = new _common_js__WEBPACK_IMPORTED_MODULE_0__.elStore();\nlet types = ['attribute', 'classstyle', 'style', 'innerText']\n\nfunction attributes({ document: initDocument, exclude = \"\", callback = () => {} }) {\n    this.exclude = exclude;\n    this.callback = callback;\n    this.initDocument = initDocument;\n\n}\n\n\nattributes.prototype.init = function init() {\n\n\n    this.scanNewElement()\n    // this.initDocument.defaultView.CoCreate.observer.init({\n    _cocreate_observer__WEBPACK_IMPORTED_MODULE_1__.default.init({\n        name: \"ccAttribute\",\n        observe: [\"attributes\"],\n        attributes: [\"data-attributes_target\", \"value\", \"data-attributes_unit\"],\n        include: \"INPUT, .pickr, cocreate-select\",\n        callback: async m => await this.watchInputChange(m),\n    });\n    this.initDocument.addEventListener(\"input\", async(e) => {\n        let input = e.target;\n        // input.tagName == \"COCREATE-SELECT\" && \n        this.perInput(input, (inputMeta, element) =>\n            this.updateElement({ ...inputMeta, input, element, isColl: true }))\n    });\n\n\n    // observer elements change to reflect inputs (data-units)\n    this.observerElements(this.initDocument.defaultView);\n\n    _cocreate_cocreatejs__WEBPACK_IMPORTED_MODULE_4__.socket.listen(\"ccStyle\", (args) => this.listen(args));\n\n\n\n}\n\n\nattributes.prototype.listen = async function listen({\n    value,\n    unit,\n    type,\n    property,\n    camelProperty,\n    elementId,\n    elementSelector\n}) {\n\n\n    let selector = property ? `[data-attributes=${type}][data-attributes_property=${property}]:not(${this.exclude})` : `[data-attributes=${type}]:not(${this.exclude})`;\n\n    let input = this.initDocument.querySelector(\n        selector\n    );\n    // if (selector.indexOf(';') !== -1)\n    // let element\n    let element = await this.complexSelector(elementSelector,\n        (canvasDoc, selector) => canvasDoc.querySelector(selector));\n    // else\n    //     element = this.initDocument.querySelector(elementSelector)\n\n    this.updateElement({ type, property, camelProperty, input, element, collValue: value, unit, isColl: false })\n\n\n}\n\nattributes.prototype.collaborate = function collaborate({\n    element,\n    ...rest\n}) {\n    // if (value != input.value) return;\n    let elementId = element.getAttribute('data-element_id');\n    if (!elementId)\n        return console.warn('no element id, collaboration skiped');\n    let elementSelector = rest.input.getAttribute('data-attributes_target');\n\n\n\n    _cocreate_cocreatejs__WEBPACK_IMPORTED_MODULE_4__.message.send({\n        broadcast_sender: false,\n        rooms: \"\",\n        emit: {\n            message: \"ccStyle\",\n            data: {\n                ...rest,\n                elementId,\n                elementSelector\n            },\n\n        },\n    });\n}\n\nattributes.prototype.scanNewElement = function scanNewElement() {\n    this.initDocument.querySelectorAll(`[data-attributes]:not(${this.exclude})`).forEach(async(input) => {\n        this.perInput(input, (inputMeta, element) =>\n            this.updateInput({ ...inputMeta, input, element, isColl: true }))\n    });\n}\nattributes.prototype.observerElements = function observerElements(initWindow) {\n    // initWindow.CoCreate.observer.init({\n    // let observer = initWindow.CoCreate.observer ?\n    _cocreate_observer__WEBPACK_IMPORTED_MODULE_1__.default.init({\n        name: 'ccAttribute',\n        observe: [\"attributes\", \"characterData\"],\n        callback: (mutation) => {\n            let element = mutation.target;\n            if (!element) return;\n            this.getInputFromElement(mutation.target).forEach(input => {\n                let inputMeta = this.validateInput(input);\n                if (!inputMeta) return;\n                this.updateInput({ ...inputMeta, input, element });\n            })\n\n        },\n    });\n}\n\n//convention based (all elements should use data-elememet_id and it's faster)\n// made it also support \"id\"\nattributes.prototype.getInputFromElement = function getInputFromElement(element) {\n\n\n    let elId = element.getAttribute('data-element_id') || element.id && `\"#${element.id }\"`;\n    if (elId)\n        return this.initDocument.querySelectorAll(`[data-attributes_target=${elId}]`)\n    return []\n\n}\n\n// todo: discuss with\n// attributes.prototype.getInputFromElement = function getInputFromElement(element) {\n\n//     // let inputs = [];\n\n//     //todo: fix add textarea\n//     let elId = element.getAttribute('data-element_id');\n//     if(elId)\n//      this.initDocument.querySelectorAll(`[data-attributes_target]`).forEach\n\n// }\n\nattributes.prototype.watchInputChange = async function watchInputChange(mutation) {\n    try {\n        // return;\n        let element, input = mutation.target;\n        let inputMeta = this.validateInput(input);\n\n\n        element = inputMeta && await this.getElementFromInput(input);\n\n        if (!element) return\n\n\n        if (mutation.attributeName === \"data-attributes_target\") {\n            // if (element) \n            this.updateInput({ ...inputMeta, input, element });\n            // element.isFirst = element.isFirst === true ? false : true;\n        }\n        else if (mutation.attributeName === \"data-attributes_unit\") {\n            // if (element.isFirst) return;\n            this.updateElement({ ...inputMeta, input, element, isColl: true })\n        }\n    }\n    catch (err) {\n\n    }\n\n}\n\n\nattributes.prototype.perInput = async function perInput(input, callback) {\n\n\n    try {\n        let inputMeta, element;\n        inputMeta = this.validateInput(input);\n        element = inputMeta && await this.getElementFromInput(input);\n        if (!element) return;\n        callback(inputMeta, element)\n    }\n    catch (error) {\n        console.error(error)\n    }\n\n}\n\n\n\n\nattributes.prototype.validateInput = function validateInput(input) {\n    let type = input.getAttribute(\"data-attributes\");\n    if (!type) {\n        // console.warn(\"cc-style: input doesn't have data-attributes\")\n        return;\n    }\n    type = type.toLowerCase();\n\n\n    let camelProperty, property = input.getAttribute(\"data-attributes_property\");\n    if (property) {\n        camelProperty = (0,_common_js__WEBPACK_IMPORTED_MODULE_0__.toCamelCase)(property);\n        property = property.toLowerCase();\n    }\n\n\n    return {\n        type,\n        property,\n        camelProperty,\n\n    };\n}\n\n\nattributes.prototype.updateElementByValue = function updateElementByValue({ type, property, camelProperty, input, element, inputValue, hasCollValue }) {\n    let computedStyles, value, removeValue, hasUpdated, unit, parsedInt;\n    switch (type) {\n\n\n\n        case 'classstyle':\n            parsedInt = parseInt(value)\n\n            unit = (input.getAttribute('data-attributes_unit') || '');\n            value = inputValue && !hasCollValue ? inputValue + unit : inputValue;\n            value = value || '';\n            computedStyles = this.getRealStaticCompStyle(element);\n            return (0,_common_js__WEBPACK_IMPORTED_MODULE_0__.setStyleClassIfDif)(element, {\n                property,\n                camelProperty,\n                value,\n                computedStyles\n            })\n\n\n        case 'style':\n            unit = (input.getAttribute('data-attributes_unit') || '');\n            value = inputValue && !hasCollValue ? inputValue + unit : inputValue;\n            value = value || '';\n            computedStyles = this.getRealStaticCompStyle(element);\n            return _common_js__WEBPACK_IMPORTED_MODULE_0__.setStyleIfDif.call(element, { property, camelProperty, value, computedStyles })\n\n        case 'innerText':\n            if (element.innerText != inputValue) {\n                element.innerText = inputValue;\n                return true;\n            }\n            else return false;\n        default:\n            if (typeof inputValue == 'string') {\n\n                return _common_js__WEBPACK_IMPORTED_MODULE_0__.setAttributeIfDif.call(element, type, inputValue)\n            }\n            else {\n                for (let inputSValue of inputValue) {\n                    if (inputSValue.checked) {\n                        // unconventional change\n                        if (type === 'data-attributes_unit' && ['auto', 'inherit', 'initial'].includes(inputSValue.value)) {\n                            element.value = inputSValue.value;\n                            _common_js__WEBPACK_IMPORTED_MODULE_0__.removeAllSelectedOptions.call(input)\n                        }\n                        else\n                            // unconventional change\n                            return _common_js__WEBPACK_IMPORTED_MODULE_0__.setAttributeIfDif.call(element, type, inputSValue.value)\n\n                    }\n\n                }\n\n\n            }\n\n            break;\n\n    }\n\n\n}\n\n\nattributes.prototype.removeZeros = function removeZeros(str) {\n    let i = 0;\n    for (let len = str.length; i < len; i++) {\n        if (str[i] !== '0')\n            break;\n    }\n    return str.substr(i) || str && '0';\n}\n\nattributes.prototype.updateElement = function updateElement({ input, element, collValue, isColl, unit, type, property, ...rest }) {\n\n\n\n    let inputValue = collValue != undefined ? collValue : this.getInputValue(input);\n\n    if (!Array.isArray(inputValue)) {\n        inputValue = unit && inputValue ? inputValue + unit : inputValue;\n        inputValue = this.removeZeros(inputValue)\n    }\n    else\n        inputValue.forEach(a => this.removeZeros(a.value))\n\n    let hasUpdated = this.updateElementByValue({ ...rest, type, property, input, element, inputValue, hasCollValue: collValue != undefined })\n\n    cache.reset(element)\n\n    // attribute is default when it's not attribute\n\n\n\n    hasUpdated &&\n        isColl &&\n        this.collaborate({\n            value: inputValue,\n            unit: input.getAttribute('data-attributes_unit'),\n            input,\n            element,\n            type,\n            property,\n            ...rest,\n\n        });\n    if (!types.includes(type)) {\n        property = type;\n        type = 'attribute';\n    }\n\n    hasUpdated &&\n        isColl &&\n        this.callback({\n            value: Array.isArray(inputValue) ? inputValue[0].value : inputValue,\n            unit: input.getAttribute('data-attributes_unit'),\n            input,\n            element,\n            type,\n            property,\n            ...rest,\n\n        });\n\n    // not needed since crdt\n    // when function called on collboration\n    // todo: use setInputValue directly in updateElementByValue\n    // if (newValue) {\n    //     updateInput({...rest, element, input, })\n    // }\n\n}\n\nattributes.prototype.updateInput = function updateInput({ type, property, camelProperty, element, input }) {\n    let computedStyles, value, value2, styleValue, unit;\n    if (!input) return console.error('CoCreate Attributes: input not found/dev')\n    switch (type) {\n        case 'classstyle':\n            let ccStyle = (0,_common_js__WEBPACK_IMPORTED_MODULE_0__.getCoCreateStyle)(element.classList);\n            if (ccStyle[camelProperty])\n                value2 = ccStyle[camelProperty];\n            else {\n                computedStyles = this.getRealStaticCompStyle(element);\n                value2 = computedStyles[camelProperty];\n            }\n            if (!value2) {\n                return console.warn(`\"${property}\" can not be found in style object`)\n            }\n            ([styleValue, unit] = (0,_common_js__WEBPACK_IMPORTED_MODULE_0__.parseUnit)(value2));\n            value = styleValue;\n            _common_js__WEBPACK_IMPORTED_MODULE_0__.setAttributeIfDif.call(input, \"data-attributes_unit\", unit);\n            break;\n        case 'style':\n            computedStyles = this.getRealStaticCompStyle(element);\n            value2 = computedStyles[camelProperty];\n            if (!value2) {\n                return console.warn(`\"${property}\" can not be found in style object`)\n            }\n            ([styleValue, unit] = (0,_common_js__WEBPACK_IMPORTED_MODULE_0__.parseUnit)(value2));\n            value = styleValue;\n            _common_js__WEBPACK_IMPORTED_MODULE_0__.setAttributeIfDif.call(input, \"data-attributes_unit\", unit);\n        case 'innerText':\n            value = element.innerText;\n            break;\n        default:\n            value = element.getAttribute(type);\n            break;\n    }\n\n    this.setInputValue(input, value != undefined ? value : '');\n\n}\n\nattributes.prototype.setInputValue = function setInputValue(input, value) {\n    // console.log(input.getAttribute('name'))\n\n    let inputType = input.tagName.toLowerCase() || input.classList.has('.pickr') && 'pickr';\n    switch (inputType) {\n        // case 'input':\n        //     switch (input.type) {\n        //         case 'checkbox':\n        //         case 'radio':\n        //             input.checked = value == input.value ? true : false;\n        //             break;\n        //         default:\n        //             input.value = value;\n        //     }\n        //     break;\n        // case \"textarea\":\n        //     input.value = value;\n        //     break;\n        case 'select':\n            let options = Array.from(input.options)\n            options.forEach(option => {\n                if (value == option.value)\n                    input.selectedIndex = options.indexOf(option);\n            })\n            break;\n        case 'cocreate-select':\n            (0,_common_js__WEBPACK_IMPORTED_MODULE_0__.renderOptions)(input, value)\n            break;\n        case 'pickr':\n            // todo: how to perform validation\n            let pickrIns = _cocreate_pickr__WEBPACK_IMPORTED_MODULE_3__.default.refs.get(input);\n            _cocreate_pickr__WEBPACK_IMPORTED_MODULE_3__.default.disabledEvent = true;\n            pickrIns.setColor(value); // todo: style or value\n            _cocreate_pickr__WEBPACK_IMPORTED_MODULE_3__.default.disabledEvent = false;\n\n        default:\n            _cocreate_crdt__WEBPACK_IMPORTED_MODULE_2__.default.replaceText({\n                collection: 'aaaaa',\n                document_id: 'null',\n                name: input.getAttribute('name'),\n                value: value + '',\n                position: '0',\n            })\n            // console.warn('CoCreateStyle: unidentified input: ', inputType, 'input ', input)\n    }\n}\n\n\n\n\nattributes.prototype.packMultiValue = function packMultiValue({\n    inputs,\n    stateProperty,\n    valueProperty = \"value\",\n    forceState,\n}) {\n    let value = [];\n    Array.from(inputs).forEach(input => {\n        value.push({ checked: forceState || input[stateProperty], value: input[valueProperty] || input.getAttribute(valueProperty) })\n    })\n    return value\n}\n\nattributes.prototype.getInputValue = function getInputValue(input) {\n    if (!input) return;\n    let inputType = input.tagName.toLowerCase() || input.classList.has('.pickr') && 'pickr';\n\n    switch (inputType) {\n        case 'input':\n            switch (input.type) {\n                case 'checkbox':\n                case 'radio':\n                    return this.packMultiValue({\n                        inputs: this.initDocument.getElementsByName(input.name),\n                        stateProperty: 'checked',\n                    });\n\n                default:\n                    return input.value;\n\n            }\n\n        case \"textarea\":\n            return input.value;\n\n        case 'select':\n            return this.packMultiValue({\n                inputs: input.options,\n                stateProperty: 'selected'\n            })\n\n        case 'cocreate-select':\n            return this.packMultiValue({\n                inputs: input.querySelectorAll(\":scope > [selected]\"),\n                forceState: true\n            });\n\n        case 'pickr':\n            // todo: how to perform validation\n            // if (!CoCreate.pickr.refs.has(input)) return; \n            let pickrIns = _cocreate_pickr__WEBPACK_IMPORTED_MODULE_3__.default.refs.get(input);\n            return pickrIns ? pickrIns.getColor().toHEXA().toString() : '';\n\n\n\n        default:\n            console.warn('CoCreateStyle: unidentified input');\n            break;\n    }\n\n\n}\n\n\n\nattributes.prototype.getElementFromInput = async function getElementFromInput(input) {\n    let id = input.getAttribute(\"data-attributes_target\");\n\n    if (id) {\n        if (id.indexOf(';') !== -1) {\n            let el = await this.complexSelector(id,\n                (canvasDoc, selector) => canvasDoc.querySelector(selector));\n            return el;\n        }\n        else\n            return this.initDocument.querySelector(id)\n    }\n    else\n        return false;\n\n}\n\n\n\nattributes.prototype.getRealStaticCompStyle = function getRealStaticCompStyle(element) {\n    if (cache.get(element, 'valid'))\n        return cache.get(element, 'computedStyles');\n    setTimeout(() => {\n        cache.reset(element)\n    }, 5000);\n    let oldDispaly = element.style.display;\n    element.style.display = \"none\";\n    let computedStylesLive = window.getComputedStyle(element);\n    let computedStyles = Object.assign({}, computedStylesLive);\n    computedStyles.display = oldDispaly;\n\n    element.style.display = oldDispaly;\n    if (element.getAttribute(\"style\") == \"\") element.removeAttribute(\"style\");\n    element.removeAttribute('no-observe')\n    cache.spread(element, { computedStyles, valid: true })\n    return computedStyles;\n}\n\n\nattributes.prototype.complexSelector = async function complexSelector(comSelector, callback) {\n    let [canvasSelector, selector] = comSelector.split(';');\n    let canvas = document.querySelector(canvasSelector);\n    if (!canvas) {\n        console.warn('complex selector canvas now found for', comSelector)\n        return\n    }\n\n    if ( /*!canvas.contentWindow.observedByCCAttributes &&*/ canvas.contentDocument.readyState === 'loading') {\n        try {\n            await new Promise((resolve, reject) => {\n                canvas.contentWindow.addEventListener('load', (e) => resolve())\n            });\n        }\n        catch (err) {\n            console.error('iframe can not be loaded')\n        }\n        // this.observerElements(canvas.contentWindow)\n        // canvas.contentWindow.observedByCCAttributes = true;\n    }\n\n    return callback(canvas.contentWindow.document, selector);\n}\n\n\n\n\n\n\n\n// attributes.prototype.getInputs = function getInputs(element) {\n//     let inputs = [];\n//     let allInputs = Array.from(document.getElementsByTagName(\"input\"));\n//     allInputs.forEach((inputCandidate) => {\n//         let inputMeta = getInputMetaData(inputCandidate);\n//         if (!inputMeta) return;\n\n//         let allReferencedEl = allFrame((frame) =>\n//             frame.querySelectorAll(\n//                 inputMeta.input.getAttribute(\"data-attributes_target\")\n//             )\n//         );\n//         if (Array.from(allReferencedEl).includes(element)) {\n//             inputs.push(inputMeta.input);\n//         }\n//     });\n//     return inputs;\n// }\n//attributes.prototype.perInput =  async function perInput(input, callback) {\n//     let inputMeta, element, group = input.getAttribute(\"data-attributes_group\");\n//     if (group) {\n//         [inputMeta, element] = getInputsMetaData(input);\n//     } else {\n//         inputMeta = validateInput(input);\n//         element = await getElementFromInput(input);\n//     }\n\n//     if (!inputMeta || !element) return;\n\n//     if (Array.isArray(inputMeta))\n//         inputMeta.forEach(async(metas) => callback(metas, element))\n//     else\n//         callback(inputMeta, element)\n// }\n\n//attributes.prototype.getInputsMetaData =  function getInputsMetaData(input) {\n//     let list = [],\n//         inputs = [];\n//     let element = getElementFromInput(input)\n//     let realInputs = input.querySelectorAll(group);\n//     realInputs.forEach(inp => {\n//         \n//         inputs.push(inp)\n//         list.push(validateInput(inp))\n//     })\n//     groupEl.set(input, inputs);\n//     return [list, element];\n// }\n\n\n\n// window.addEventListener('load', () => {\n//     let attribute = new attributes({ document, exclude: '#ghostEffect,.vdom-item ',\n//       callback: ({\n//         value,\n//         type,\n//         property,\n//         element,\n//     }) => {\n//           if (document.contains(element))\n//         domToText.domToText({\n//           method: type == 'attribute' ? 'setAttribute' : type, \n//           property: property,\n//           target: element.getAttribute(\"data-element_id\"),\n//           tagName: element.tagName,\n//           value,\n//           ...crdtCon\n//         })\n\n//     },})\n//     attribute.init()\n// })\n\n// let s = new attributes({\n//     document,\n//     exclude: '#ghostEffect,.vdom-item ',\n//     callback: ({\n//         value,\n//         type,\n//         property,\n//         element,\n//     }) => {\n//           if (document.contains(element))\n//         domToText.domToText({\n//           method: type == 'attribute' ? 'setAttribute' : type, \n//           property: property,\n//           target: element.getAttribute(\"data-element_id\"),\n//           tagName: element.tagName,\n//           value,\n//           ...crdtCon\n//         })\n\n//     },\n// })\n// s.init();\n\n\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({\n    init: (params) => {\n        let s = new attributes(params)\n        s.init();\n        return s;\n    }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9Db0NyZWF0ZS5hdHRyaWJ1dGVzLy4uLy4uL0NvQ3JlYXRlSlMvbm9kZV9tb2R1bGVzL0Bjb2NyZWF0ZS9hdHRyaWJ1dGVzL3NyYy9pbmRleC5qcz8wZWJhIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUFBOztBQWVtQjs7QUFFc0I7QUFDUjtBQUNFO0FBQ21CO0FBQ3REO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2RUFBNkUsd0NBQXdDO0FBQ3JIO0FBQ0E7QUFDQSxJQUFJOzs7Ozs7O0FBT0o7QUFDQTs7QUFFQSxnREFBZ0Q7O0FBRWhEO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQiw4QkFBOEI7QUFDbkQ7OztBQUdBOztBQUVBLGdCQUFnQiwrQ0FBTztBQUN2Qjs7QUFFQSxxQkFBcUIsMERBQTBELEVBQUU7QUFDakY7QUFDQTtBQUNBOztBQUVBOzs7QUFHQTs7O0FBR0E7QUFDQTtBQUNBLElBQUksNERBQWE7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdDQUFnQyw2Q0FBNkM7QUFDN0UsS0FBSzs7O0FBR0w7QUFDQTs7QUFFQSxJQUFJLCtEQUFhOzs7O0FBSWpCOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQzs7O0FBR0Qsa0RBQWtELEtBQUssNkJBQTZCLFNBQVMsUUFBUSxhQUFhLHlCQUF5QixLQUFLLFFBQVEsYUFBYTs7QUFFcks7QUFDQTtBQUNBO0FBQ0EsOEJBQThCO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsd0JBQXdCLHVGQUF1Rjs7O0FBRy9HOztBQUVBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FBSUEsSUFBSSw4REFBWTtBQUNoQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtB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QUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTs7OztBQUlBO0FBQ0EsdUNBQXVDO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7O0FBRVosUUFBUSxFQUFFO0FBQ1Y7QUFDQSxJQUFJOztBQUVKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7O0FBRVosUUFBUTtBQUNSLElBQUk7QUFDSjs7OztBQUlBLGlFQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsRUFBQyIsImZpbGUiOiIuLi8uLi9Db0NyZWF0ZUpTL25vZGVfbW9kdWxlcy9AY29jcmVhdGUvYXR0cmlidXRlcy9zcmMvaW5kZXguanMuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKmdsb2JhbCBDb0NyZWF0ZSovXG5cbmltcG9ydCB7XG4gICAgZWxTdG9yZSxcbiAgICBwYXJzZUNzc1J1bGVzLFxuICAgIHJlbmRlck9wdGlvbnMsXG4gICAgcmVtb3ZlQWxsU2VsZWN0ZWRPcHRpb25zLFxuICAgIHNldFN0eWxlSWZEaWYsXG4gICAgc2V0QXR0cmlidXRlSWZEaWYsXG4gICAgc2V0U3R5bGVDbGFzc0lmRGlmLFxuICAgIGdldENvQ3JlYXRlU3R5bGUsXG4gICAgdG9DYW1lbENhc2UsXG4gICAgcGFyc2VVbml0LFxuICAgIHJnYmEyaGV4XG59XG5mcm9tICcuL2NvbW1vbi5qcyc7XG5cbmltcG9ydCBvYnNlcnZlciBmcm9tICdAY29jcmVhdGUvb2JzZXJ2ZXInXG5pbXBvcnQgY3JkdCBmcm9tICdAY29jcmVhdGUvY3JkdCdcbmltcG9ydCBwaWNrciBmcm9tICdAY29jcmVhdGUvcGlja3InXG5pbXBvcnQgeyBzb2NrZXQsIG1lc3NhZ2UgfSBmcm9tICdAY29jcmVhdGUvY29jcmVhdGVqcydcbi8vIC8vIGRldiBzdGFydFxuLy8gaW1wb3J0ICdAY29jcmVhdGUvc2VsZWN0J1xuLy8gaW1wb3J0IHNlbGVjdGVkIGZyb20gJ0Bjb2NyZWF0ZS9zZWxlY3RlZCdcbi8vIGltcG9ydCBkb21Ub1RleHQgZnJvbSAnQGNvY3JlYXRlL2RvbVRvVGV4dCdcblxuXG4vLyBzZWxlY3RlZC5jb25maWcoe1xuLy8gICAgIHNyY0RvY3VtZW50OiBkb2N1bWVudCxcbi8vICAgICBkZXN0RG9jdW1lbnQ6IGRvY3VtZW50LFxuLy8gICAgIHNlbGVjdG9yOiBcIiNjb250YWluZXIgKlwiLFxuLy8gICAgIHRhcmdldDogXCJbZGF0YS1hdHRyaWJ1dGVzXTpub3QoLnN0eWxldW5pdClcIixcbi8vICAgICBjYWxsYmFjazogKGVsZW1lbnQsIHRhcmdldCkgPT4ge1xuLy8gICAgICAgICB0YXJnZXQuc2V0QXR0cmlidXRlKCdkYXRhLWF0dHJpYnV0ZXNfdGFyZ2V0JywgYFtkYXRhLWVsZW1lbnRfaWQ9JHtlbGVtZW50LmdldEF0dHJpYnV0ZSgnZGF0YS1lbGVtZW50X2lkJyl9XWApO1xuLy8gICAgICAgICB0YXJnZXQuc2V0QXR0cmlidXRlKCduYW1lJywgdGFyZ2V0LmlkICsgJy0nICsgZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2RhdGEtZWxlbWVudF9pZCcpKVxuLy8gICAgIH1cbi8vIH0pO1xuXG5cblxuXG5cblxuLy8gLy9wcm9maWxlIG9ic2VydmVyXG4vLyBsZXQgcHJvZmlsZSA9IFtdXG5cbi8vIGZ1bmN0aW9uIHByb2ZpbGVPYnNlcnZlcihtdXRhdGlvbiwgZXh0cmEgPSB7fSkge1xuXG4vLyAgICAgLy8gZ2V0IHRpbWVcbi8vICAgICBsZXQgZGF0ZSA9IG5ldyBEYXRlKCk7XG4vLyAgICAgbGV0IHRpbWUgPSBkYXRlLmdldFNlY29uZHMoKSArICcuJyArIGRhdGUuZ2V0TWlsbGlzZWNvbmRzKClcbi8vICAgICBwcm9maWxlLnB1c2goeyB0aW1lLCAuLi5leHRyYSwgLi4ubXV0YXRpb24gfSlcbi8vIH1cblxuXG4vLyAvLyBkZXYgZW5kXG5cbmxldCBjYWNoZSA9IG5ldyBlbFN0b3JlKCk7XG5sZXQgdHlwZXMgPSBbJ2F0dHJpYnV0ZScsICdjbGFzc3N0eWxlJywgJ3N0eWxlJywgJ2lubmVyVGV4dCddXG5cbmZ1bmN0aW9uIGF0dHJpYnV0ZXMoeyBkb2N1bWVudDogaW5pdERvY3VtZW50LCBleGNsdWRlID0gXCJcIiwgY2FsbGJhY2sgPSAoKSA9PiB7fSB9KSB7XG4gICAgdGhpcy5leGNsdWRlID0gZXhjbHVkZTtcbiAgICB0aGlzLmNhbGxiYWNrID0gY2FsbGJhY2s7XG4gICAgdGhpcy5pbml0RG9jdW1lbnQgPSBpbml0RG9jdW1lbnQ7XG5cbn1cblxuXG5hdHRyaWJ1dGVzLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24gaW5pdCgpIHtcblxuXG4gICAgdGhpcy5zY2FuTmV3RWxlbWVudCgpXG4gICAgLy8gdGhpcy5pbml0RG9jdW1lbnQuZGVmYXVsdFZpZXcuQ29DcmVhdGUub2JzZXJ2ZXIuaW5pdCh7XG4gICAgb2JzZXJ2ZXIuaW5pdCh7XG4gICAgICAgIG5hbWU6IFwiY2NBdHRyaWJ1dGVcIixcbiAgICAgICAgb2JzZXJ2ZTogW1wiYXR0cmlidXRlc1wiXSxcbiAgICAgICAgYXR0cmlidXRlczogW1wiZGF0YS1hdHRyaWJ1dGVzX3RhcmdldFwiLCBcInZhbHVlXCIsIFwiZGF0YS1hdHRyaWJ1dGVzX3VuaXRcIl0sXG4gICAgICAgIGluY2x1ZGU6IFwiSU5QVVQsIC5waWNrciwgY29jcmVhdGUtc2VsZWN0XCIsXG4gICAgICAgIGNhbGxiYWNrOiBhc3luYyBtID0+IGF3YWl0IHRoaXMud2F0Y2hJbnB1dENoYW5nZShtKSxcbiAgICB9KTtcbiAgICB0aGlzLmluaXREb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgYXN5bmMoZSkgPT4ge1xuICAgICAgICBsZXQgaW5wdXQgPSBlLnRhcmdldDtcbiAgICAgICAgLy8gaW5wdXQudGFnTmFtZSA9PSBcIkNPQ1JFQVRFLVNFTEVDVFwiICYmIFxuICAgICAgICB0aGlzLnBlcklucHV0KGlucHV0LCAoaW5wdXRNZXRhLCBlbGVtZW50KSA9PlxuICAgICAgICAgICAgdGhpcy51cGRhdGVFbGVtZW50KHsgLi4uaW5wdXRNZXRhLCBpbnB1dCwgZWxlbWVudCwgaXNDb2xsOiB0cnVlIH0pKVxuICAgIH0pO1xuXG5cbiAgICAvLyBvYnNlcnZlciBlbGVtZW50cyBjaGFuZ2UgdG8gcmVmbGVjdCBpbnB1dHMgKGRhdGEtdW5pdHMpXG4gICAgdGhpcy5vYnNlcnZlckVsZW1lbnRzKHRoaXMuaW5pdERvY3VtZW50LmRlZmF1bHRWaWV3KTtcblxuICAgIHNvY2tldC5saXN0ZW4oXCJjY1N0eWxlXCIsIChhcmdzKSA9PiB0aGlzLmxpc3RlbihhcmdzKSk7XG5cblxuXG59XG5cblxuYXR0cmlidXRlcy5wcm90b3R5cGUubGlzdGVuID0gYXN5bmMgZnVuY3Rpb24gbGlzdGVuKHtcbiAgICB2YWx1ZSxcbiAgICB1bml0LFxuICAgIHR5cGUsXG4gICAgcHJvcGVydHksXG4gICAgY2FtZWxQcm9wZXJ0eSxcbiAgICBlbGVtZW50SWQsXG4gICAgZWxlbWVudFNlbGVjdG9yXG59KSB7XG5cblxuICAgIGxldCBzZWxlY3RvciA9IHByb3BlcnR5ID8gYFtkYXRhLWF0dHJpYnV0ZXM9JHt0eXBlfV1bZGF0YS1hdHRyaWJ1dGVzX3Byb3BlcnR5PSR7cHJvcGVydHl9XTpub3QoJHt0aGlzLmV4Y2x1ZGV9KWAgOiBgW2RhdGEtYXR0cmlidXRlcz0ke3R5cGV9XTpub3QoJHt0aGlzLmV4Y2x1ZGV9KWA7XG5cbiAgICBsZXQgaW5wdXQgPSB0aGlzLmluaXREb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgICBzZWxlY3RvclxuICAgICk7XG4gICAgLy8gaWYgKHNlbGVjdG9yLmluZGV4T2YoJzsnKSAhPT0gLTEpXG4gICAgLy8gbGV0IGVsZW1lbnRcbiAgICBsZXQgZWxlbWVudCA9IGF3YWl0IHRoaXMuY29tcGxleFNlbGVjdG9yKGVsZW1lbnRTZWxlY3RvcixcbiAgICAgICAgKGNhbnZhc0RvYywgc2VsZWN0b3IpID0+IGNhbnZhc0RvYy5xdWVyeVNlbGVjdG9yKHNlbGVjdG9yKSk7XG4gICAgLy8gZWxzZVxuICAgIC8vICAgICBlbGVtZW50ID0gdGhpcy5pbml0RG9jdW1lbnQucXVlcnlTZWxlY3RvcihlbGVtZW50U2VsZWN0b3IpXG5cbiAgICB0aGlzLnVwZGF0ZUVsZW1lbnQoeyB0eXBlLCBwcm9wZXJ0eSwgY2FtZWxQcm9wZXJ0eSwgaW5wdXQsIGVsZW1lbnQsIGNvbGxWYWx1ZTogdmFsdWUsIHVuaXQsIGlzQ29sbDogZmFsc2UgfSlcblxuXG59XG5cbmF0dHJpYnV0ZXMucHJvdG90eXBlLmNvbGxhYm9yYXRlID0gZnVuY3Rpb24gY29sbGFib3JhdGUoe1xuICAgIGVsZW1lbnQsXG4gICAgLi4ucmVzdFxufSkge1xuICAgIC8vIGlmICh2YWx1ZSAhPSBpbnB1dC52YWx1ZSkgcmV0dXJuO1xuICAgIGxldCBlbGVtZW50SWQgPSBlbGVtZW50LmdldEF0dHJpYnV0ZSgnZGF0YS1lbGVtZW50X2lkJyk7XG4gICAgaWYgKCFlbGVtZW50SWQpXG4gICAgICAgIHJldHVybiBjb25zb2xlLndhcm4oJ25vIGVsZW1lbnQgaWQsIGNvbGxhYm9yYXRpb24gc2tpcGVkJyk7XG4gICAgbGV0IGVsZW1lbnRTZWxlY3RvciA9IHJlc3QuaW5wdXQuZ2V0QXR0cmlidXRlKCdkYXRhLWF0dHJpYnV0ZXNfdGFyZ2V0Jyk7XG5cblxuXG4gICAgbWVzc2FnZS5zZW5kKHtcbiAgICAgICAgYnJvYWRjYXN0X3NlbmRlcjogZmFsc2UsXG4gICAgICAgIHJvb21zOiBcIlwiLFxuICAgICAgICBlbWl0OiB7XG4gICAgICAgICAgICBtZXNzYWdlOiBcImNjU3R5bGVcIixcbiAgICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgICAgICAuLi5yZXN0LFxuICAgICAgICAgICAgICAgIGVsZW1lbnRJZCxcbiAgICAgICAgICAgICAgICBlbGVtZW50U2VsZWN0b3JcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgfSxcbiAgICB9KTtcbn1cblxuYXR0cmlidXRlcy5wcm90b3R5cGUuc2Nhbk5ld0VsZW1lbnQgPSBmdW5jdGlvbiBzY2FuTmV3RWxlbWVudCgpIHtcbiAgICB0aGlzLmluaXREb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGBbZGF0YS1hdHRyaWJ1dGVzXTpub3QoJHt0aGlzLmV4Y2x1ZGV9KWApLmZvckVhY2goYXN5bmMoaW5wdXQpID0+IHtcbiAgICAgICAgdGhpcy5wZXJJbnB1dChpbnB1dCwgKGlucHV0TWV0YSwgZWxlbWVudCkgPT5cbiAgICAgICAgICAgIHRoaXMudXBkYXRlSW5wdXQoeyAuLi5pbnB1dE1ldGEsIGlucHV0LCBlbGVtZW50LCBpc0NvbGw6IHRydWUgfSkpXG4gICAgfSk7XG59XG5hdHRyaWJ1dGVzLnByb3RvdHlwZS5vYnNlcnZlckVsZW1lbnRzID0gZnVuY3Rpb24gb2JzZXJ2ZXJFbGVtZW50cyhpbml0V2luZG93KSB7XG4gICAgLy8gaW5pdFdpbmRvdy5Db0NyZWF0ZS5vYnNlcnZlci5pbml0KHtcbiAgICAvLyBsZXQgb2JzZXJ2ZXIgPSBpbml0V2luZG93LkNvQ3JlYXRlLm9ic2VydmVyID9cbiAgICBvYnNlcnZlci5pbml0KHtcbiAgICAgICAgbmFtZTogJ2NjQXR0cmlidXRlJyxcbiAgICAgICAgb2JzZXJ2ZTogW1wiYXR0cmlidXRlc1wiLCBcImNoYXJhY3RlckRhdGFcIl0sXG4gICAgICAgIGNhbGxiYWNrOiAobXV0YXRpb24pID0+IHtcbiAgICAgICAgICAgIGxldCBlbGVtZW50ID0gbXV0YXRpb24udGFyZ2V0O1xuICAgICAgICAgICAgaWYgKCFlbGVtZW50KSByZXR1cm47XG4gICAgICAgICAgICB0aGlzLmdldElucHV0RnJvbUVsZW1lbnQobXV0YXRpb24udGFyZ2V0KS5mb3JFYWNoKGlucHV0ID0+IHtcbiAgICAgICAgICAgICAgICBsZXQgaW5wdXRNZXRhID0gdGhpcy52YWxpZGF0ZUlucHV0KGlucHV0KTtcbiAgICAgICAgICAgICAgICBpZiAoIWlucHV0TWV0YSkgcmV0dXJuO1xuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlSW5wdXQoeyAuLi5pbnB1dE1ldGEsIGlucHV0LCBlbGVtZW50IH0pO1xuICAgICAgICAgICAgfSlcblxuICAgICAgICB9LFxuICAgIH0pO1xufVxuXG4vL2NvbnZlbnRpb24gYmFzZWQgKGFsbCBlbGVtZW50cyBzaG91bGQgdXNlIGRhdGEtZWxlbWVtZXRfaWQgYW5kIGl0J3MgZmFzdGVyKVxuLy8gbWFkZSBpdCBhbHNvIHN1cHBvcnQgXCJpZFwiXG5hdHRyaWJ1dGVzLnByb3RvdHlwZS5nZXRJbnB1dEZyb21FbGVtZW50ID0gZnVuY3Rpb24gZ2V0SW5wdXRGcm9tRWxlbWVudChlbGVtZW50KSB7XG5cblxuICAgIGxldCBlbElkID0gZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2RhdGEtZWxlbWVudF9pZCcpIHx8IGVsZW1lbnQuaWQgJiYgYFwiIyR7ZWxlbWVudC5pZCB9XCJgO1xuICAgIGlmIChlbElkKVxuICAgICAgICByZXR1cm4gdGhpcy5pbml0RG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChgW2RhdGEtYXR0cmlidXRlc190YXJnZXQ9JHtlbElkfV1gKVxuICAgIHJldHVybiBbXVxuXG59XG5cbi8vIHRvZG86IGRpc2N1c3Mgd2l0aFxuLy8gYXR0cmlidXRlcy5wcm90b3R5cGUuZ2V0SW5wdXRGcm9tRWxlbWVudCA9IGZ1bmN0aW9uIGdldElucHV0RnJvbUVsZW1lbnQoZWxlbWVudCkge1xuXG4vLyAgICAgLy8gbGV0IGlucHV0cyA9IFtdO1xuXG4vLyAgICAgLy90b2RvOiBmaXggYWRkIHRleHRhcmVhXG4vLyAgICAgbGV0IGVsSWQgPSBlbGVtZW50LmdldEF0dHJpYnV0ZSgnZGF0YS1lbGVtZW50X2lkJyk7XG4vLyAgICAgaWYoZWxJZClcbi8vICAgICAgdGhpcy5pbml0RG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChgW2RhdGEtYXR0cmlidXRlc190YXJnZXRdYCkuZm9yRWFjaFxuXG4vLyB9XG5cbmF0dHJpYnV0ZXMucHJvdG90eXBlLndhdGNoSW5wdXRDaGFuZ2UgPSBhc3luYyBmdW5jdGlvbiB3YXRjaElucHV0Q2hhbmdlKG11dGF0aW9uKSB7XG4gICAgdHJ5IHtcbiAgICAgICAgLy8gcmV0dXJuO1xuICAgICAgICBsZXQgZWxlbWVudCwgaW5wdXQgPSBtdXRhdGlvbi50YXJnZXQ7XG4gICAgICAgIGxldCBpbnB1dE1ldGEgPSB0aGlzLnZhbGlkYXRlSW5wdXQoaW5wdXQpO1xuXG5cbiAgICAgICAgZWxlbWVudCA9IGlucHV0TWV0YSAmJiBhd2FpdCB0aGlzLmdldEVsZW1lbnRGcm9tSW5wdXQoaW5wdXQpO1xuXG4gICAgICAgIGlmICghZWxlbWVudCkgcmV0dXJuXG5cblxuICAgICAgICBpZiAobXV0YXRpb24uYXR0cmlidXRlTmFtZSA9PT0gXCJkYXRhLWF0dHJpYnV0ZXNfdGFyZ2V0XCIpIHtcbiAgICAgICAgICAgIC8vIGlmIChlbGVtZW50KSBcbiAgICAgICAgICAgIHRoaXMudXBkYXRlSW5wdXQoeyAuLi5pbnB1dE1ldGEsIGlucHV0LCBlbGVtZW50IH0pO1xuICAgICAgICAgICAgLy8gZWxlbWVudC5pc0ZpcnN0ID0gZWxlbWVudC5pc0ZpcnN0ID09PSB0cnVlID8gZmFsc2UgOiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKG11dGF0aW9uLmF0dHJpYnV0ZU5hbWUgPT09IFwiZGF0YS1hdHRyaWJ1dGVzX3VuaXRcIikge1xuICAgICAgICAgICAgLy8gaWYgKGVsZW1lbnQuaXNGaXJzdCkgcmV0dXJuO1xuICAgICAgICAgICAgdGhpcy51cGRhdGVFbGVtZW50KHsgLi4uaW5wdXRNZXRhLCBpbnB1dCwgZWxlbWVudCwgaXNDb2xsOiB0cnVlIH0pXG4gICAgICAgIH1cbiAgICB9XG4gICAgY2F0Y2ggKGVycikge1xuXG4gICAgfVxuXG59XG5cblxuYXR0cmlidXRlcy5wcm90b3R5cGUucGVySW5wdXQgPSBhc3luYyBmdW5jdGlvbiBwZXJJbnB1dChpbnB1dCwgY2FsbGJhY2spIHtcblxuXG4gICAgdHJ5IHtcbiAgICAgICAgbGV0IGlucHV0TWV0YSwgZWxlbWVudDtcbiAgICAgICAgaW5wdXRNZXRhID0gdGhpcy52YWxpZGF0ZUlucHV0KGlucHV0KTtcbiAgICAgICAgZWxlbWVudCA9IGlucHV0TWV0YSAmJiBhd2FpdCB0aGlzLmdldEVsZW1lbnRGcm9tSW5wdXQoaW5wdXQpO1xuICAgICAgICBpZiAoIWVsZW1lbnQpIHJldHVybjtcbiAgICAgICAgY2FsbGJhY2soaW5wdXRNZXRhLCBlbGVtZW50KVxuICAgIH1cbiAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcilcbiAgICB9XG5cbn1cblxuXG5cblxuYXR0cmlidXRlcy5wcm90b3R5cGUudmFsaWRhdGVJbnB1dCA9IGZ1bmN0aW9uIHZhbGlkYXRlSW5wdXQoaW5wdXQpIHtcbiAgICBsZXQgdHlwZSA9IGlucHV0LmdldEF0dHJpYnV0ZShcImRhdGEtYXR0cmlidXRlc1wiKTtcbiAgICBpZiAoIXR5cGUpIHtcbiAgICAgICAgLy8gY29uc29sZS53YXJuKFwiY2Mtc3R5bGU6IGlucHV0IGRvZXNuJ3QgaGF2ZSBkYXRhLWF0dHJpYnV0ZXNcIilcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0eXBlID0gdHlwZS50b0xvd2VyQ2FzZSgpO1xuXG5cbiAgICBsZXQgY2FtZWxQcm9wZXJ0eSwgcHJvcGVydHkgPSBpbnB1dC5nZXRBdHRyaWJ1dGUoXCJkYXRhLWF0dHJpYnV0ZXNfcHJvcGVydHlcIik7XG4gICAgaWYgKHByb3BlcnR5KSB7XG4gICAgICAgIGNhbWVsUHJvcGVydHkgPSB0b0NhbWVsQ2FzZShwcm9wZXJ0eSk7XG4gICAgICAgIHByb3BlcnR5ID0gcHJvcGVydHkudG9Mb3dlckNhc2UoKTtcbiAgICB9XG5cblxuICAgIHJldHVybiB7XG4gICAgICAgIHR5cGUsXG4gICAgICAgIHByb3BlcnR5LFxuICAgICAgICBjYW1lbFByb3BlcnR5LFxuXG4gICAgfTtcbn1cblxuXG5hdHRyaWJ1dGVzLnByb3RvdHlwZS51cGRhdGVFbGVtZW50QnlWYWx1ZSA9IGZ1bmN0aW9uIHVwZGF0ZUVsZW1lbnRCeVZhbHVlKHsgdHlwZSwgcHJvcGVydHksIGNhbWVsUHJvcGVydHksIGlucHV0LCBlbGVtZW50LCBpbnB1dFZhbHVlLCBoYXNDb2xsVmFsdWUgfSkge1xuICAgIGxldCBjb21wdXRlZFN0eWxlcywgdmFsdWUsIHJlbW92ZVZhbHVlLCBoYXNVcGRhdGVkLCB1bml0LCBwYXJzZWRJbnQ7XG4gICAgc3dpdGNoICh0eXBlKSB7XG5cblxuXG4gICAgICAgIGNhc2UgJ2NsYXNzc3R5bGUnOlxuICAgICAgICAgICAgcGFyc2VkSW50ID0gcGFyc2VJbnQodmFsdWUpXG5cbiAgICAgICAgICAgIHVuaXQgPSAoaW5wdXQuZ2V0QXR0cmlidXRlKCdkYXRhLWF0dHJpYnV0ZXNfdW5pdCcpIHx8ICcnKTtcbiAgICAgICAgICAgIHZhbHVlID0gaW5wdXRWYWx1ZSAmJiAhaGFzQ29sbFZhbHVlID8gaW5wdXRWYWx1ZSArIHVuaXQgOiBpbnB1dFZhbHVlO1xuICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZSB8fCAnJztcbiAgICAgICAgICAgIGNvbXB1dGVkU3R5bGVzID0gdGhpcy5nZXRSZWFsU3RhdGljQ29tcFN0eWxlKGVsZW1lbnQpO1xuICAgICAgICAgICAgcmV0dXJuIHNldFN0eWxlQ2xhc3NJZkRpZihlbGVtZW50LCB7XG4gICAgICAgICAgICAgICAgcHJvcGVydHksXG4gICAgICAgICAgICAgICAgY2FtZWxQcm9wZXJ0eSxcbiAgICAgICAgICAgICAgICB2YWx1ZSxcbiAgICAgICAgICAgICAgICBjb21wdXRlZFN0eWxlc1xuICAgICAgICAgICAgfSlcblxuXG4gICAgICAgIGNhc2UgJ3N0eWxlJzpcbiAgICAgICAgICAgIHVuaXQgPSAoaW5wdXQuZ2V0QXR0cmlidXRlKCdkYXRhLWF0dHJpYnV0ZXNfdW5pdCcpIHx8ICcnKTtcbiAgICAgICAgICAgIHZhbHVlID0gaW5wdXRWYWx1ZSAmJiAhaGFzQ29sbFZhbHVlID8gaW5wdXRWYWx1ZSArIHVuaXQgOiBpbnB1dFZhbHVlO1xuICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZSB8fCAnJztcbiAgICAgICAgICAgIGNvbXB1dGVkU3R5bGVzID0gdGhpcy5nZXRSZWFsU3RhdGljQ29tcFN0eWxlKGVsZW1lbnQpO1xuICAgICAgICAgICAgcmV0dXJuIHNldFN0eWxlSWZEaWYuY2FsbChlbGVtZW50LCB7IHByb3BlcnR5LCBjYW1lbFByb3BlcnR5LCB2YWx1ZSwgY29tcHV0ZWRTdHlsZXMgfSlcblxuICAgICAgICBjYXNlICdpbm5lclRleHQnOlxuICAgICAgICAgICAgaWYgKGVsZW1lbnQuaW5uZXJUZXh0ICE9IGlucHV0VmFsdWUpIHtcbiAgICAgICAgICAgICAgICBlbGVtZW50LmlubmVyVGV4dCA9IGlucHV0VmFsdWU7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHJldHVybiBmYWxzZTtcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIGlmICh0eXBlb2YgaW5wdXRWYWx1ZSA9PSAnc3RyaW5nJykge1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHNldEF0dHJpYnV0ZUlmRGlmLmNhbGwoZWxlbWVudCwgdHlwZSwgaW5wdXRWYWx1ZSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGZvciAobGV0IGlucHV0U1ZhbHVlIG9mIGlucHV0VmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlucHV0U1ZhbHVlLmNoZWNrZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHVuY29udmVudGlvbmFsIGNoYW5nZVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGUgPT09ICdkYXRhLWF0dHJpYnV0ZXNfdW5pdCcgJiYgWydhdXRvJywgJ2luaGVyaXQnLCAnaW5pdGlhbCddLmluY2x1ZGVzKGlucHV0U1ZhbHVlLnZhbHVlKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQudmFsdWUgPSBpbnB1dFNWYWx1ZS52YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdmVBbGxTZWxlY3RlZE9wdGlvbnMuY2FsbChpbnB1dClcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB1bmNvbnZlbnRpb25hbCBjaGFuZ2VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2V0QXR0cmlidXRlSWZEaWYuY2FsbChlbGVtZW50LCB0eXBlLCBpbnB1dFNWYWx1ZS52YWx1ZSlcblxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBicmVhaztcblxuICAgIH1cblxuXG59XG5cblxuYXR0cmlidXRlcy5wcm90b3R5cGUucmVtb3ZlWmVyb3MgPSBmdW5jdGlvbiByZW1vdmVaZXJvcyhzdHIpIHtcbiAgICBsZXQgaSA9IDA7XG4gICAgZm9yIChsZXQgbGVuID0gc3RyLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgIGlmIChzdHJbaV0gIT09ICcwJylcbiAgICAgICAgICAgIGJyZWFrO1xuICAgIH1cbiAgICByZXR1cm4gc3RyLnN1YnN0cihpKSB8fCBzdHIgJiYgJzAnO1xufVxuXG5hdHRyaWJ1dGVzLnByb3RvdHlwZS51cGRhdGVFbGVtZW50ID0gZnVuY3Rpb24gdXBkYXRlRWxlbWVudCh7IGlucHV0LCBlbGVtZW50LCBjb2xsVmFsdWUsIGlzQ29sbCwgdW5pdCwgdHlwZSwgcHJvcGVydHksIC4uLnJlc3QgfSkge1xuXG5cblxuICAgIGxldCBpbnB1dFZhbHVlID0gY29sbFZhbHVlICE9IHVuZGVmaW5lZCA/IGNvbGxWYWx1ZSA6IHRoaXMuZ2V0SW5wdXRWYWx1ZShpbnB1dCk7XG5cbiAgICBpZiAoIUFycmF5LmlzQXJyYXkoaW5wdXRWYWx1ZSkpIHtcbiAgICAgICAgaW5wdXRWYWx1ZSA9IHVuaXQgJiYgaW5wdXRWYWx1ZSA/IGlucHV0VmFsdWUgKyB1bml0IDogaW5wdXRWYWx1ZTtcbiAgICAgICAgaW5wdXRWYWx1ZSA9IHRoaXMucmVtb3ZlWmVyb3MoaW5wdXRWYWx1ZSlcbiAgICB9XG4gICAgZWxzZVxuICAgICAgICBpbnB1dFZhbHVlLmZvckVhY2goYSA9PiB0aGlzLnJlbW92ZVplcm9zKGEudmFsdWUpKVxuXG4gICAgbGV0IGhhc1VwZGF0ZWQgPSB0aGlzLnVwZGF0ZUVsZW1lbnRCeVZhbHVlKHsgLi4ucmVzdCwgdHlwZSwgcHJvcGVydHksIGlucHV0LCBlbGVtZW50LCBpbnB1dFZhbHVlLCBoYXNDb2xsVmFsdWU6IGNvbGxWYWx1ZSAhPSB1bmRlZmluZWQgfSlcblxuICAgIGNhY2hlLnJlc2V0KGVsZW1lbnQpXG5cbiAgICAvLyBhdHRyaWJ1dGUgaXMgZGVmYXVsdCB3aGVuIGl0J3Mgbm90IGF0dHJpYnV0ZVxuXG5cblxuICAgIGhhc1VwZGF0ZWQgJiZcbiAgICAgICAgaXNDb2xsICYmXG4gICAgICAgIHRoaXMuY29sbGFib3JhdGUoe1xuICAgICAgICAgICAgdmFsdWU6IGlucHV0VmFsdWUsXG4gICAgICAgICAgICB1bml0OiBpbnB1dC5nZXRBdHRyaWJ1dGUoJ2RhdGEtYXR0cmlidXRlc191bml0JyksXG4gICAgICAgICAgICBpbnB1dCxcbiAgICAgICAgICAgIGVsZW1lbnQsXG4gICAgICAgICAgICB0eXBlLFxuICAgICAgICAgICAgcHJvcGVydHksXG4gICAgICAgICAgICAuLi5yZXN0LFxuXG4gICAgICAgIH0pO1xuICAgIGlmICghdHlwZXMuaW5jbHVkZXModHlwZSkpIHtcbiAgICAgICAgcHJvcGVydHkgPSB0eXBlO1xuICAgICAgICB0eXBlID0gJ2F0dHJpYnV0ZSc7XG4gICAgfVxuXG4gICAgaGFzVXBkYXRlZCAmJlxuICAgICAgICBpc0NvbGwgJiZcbiAgICAgICAgdGhpcy5jYWxsYmFjayh7XG4gICAgICAgICAgICB2YWx1ZTogQXJyYXkuaXNBcnJheShpbnB1dFZhbHVlKSA/IGlucHV0VmFsdWVbMF0udmFsdWUgOiBpbnB1dFZhbHVlLFxuICAgICAgICAgICAgdW5pdDogaW5wdXQuZ2V0QXR0cmlidXRlKCdkYXRhLWF0dHJpYnV0ZXNfdW5pdCcpLFxuICAgICAgICAgICAgaW5wdXQsXG4gICAgICAgICAgICBlbGVtZW50LFxuICAgICAgICAgICAgdHlwZSxcbiAgICAgICAgICAgIHByb3BlcnR5LFxuICAgICAgICAgICAgLi4ucmVzdCxcblxuICAgICAgICB9KTtcblxuICAgIC8vIG5vdCBuZWVkZWQgc2luY2UgY3JkdFxuICAgIC8vIHdoZW4gZnVuY3Rpb24gY2FsbGVkIG9uIGNvbGxib3JhdGlvblxuICAgIC8vIHRvZG86IHVzZSBzZXRJbnB1dFZhbHVlIGRpcmVjdGx5IGluIHVwZGF0ZUVsZW1lbnRCeVZhbHVlXG4gICAgLy8gaWYgKG5ld1ZhbHVlKSB7XG4gICAgLy8gICAgIHVwZGF0ZUlucHV0KHsuLi5yZXN0LCBlbGVtZW50LCBpbnB1dCwgfSlcbiAgICAvLyB9XG5cbn1cblxuYXR0cmlidXRlcy5wcm90b3R5cGUudXBkYXRlSW5wdXQgPSBmdW5jdGlvbiB1cGRhdGVJbnB1dCh7IHR5cGUsIHByb3BlcnR5LCBjYW1lbFByb3BlcnR5LCBlbGVtZW50LCBpbnB1dCB9KSB7XG4gICAgbGV0IGNvbXB1dGVkU3R5bGVzLCB2YWx1ZSwgdmFsdWUyLCBzdHlsZVZhbHVlLCB1bml0O1xuICAgIGlmICghaW5wdXQpIHJldHVybiBjb25zb2xlLmVycm9yKCdDb0NyZWF0ZSBBdHRyaWJ1dGVzOiBpbnB1dCBub3QgZm91bmQvZGV2JylcbiAgICBzd2l0Y2ggKHR5cGUpIHtcbiAgICAgICAgY2FzZSAnY2xhc3NzdHlsZSc6XG4gICAgICAgICAgICBsZXQgY2NTdHlsZSA9IGdldENvQ3JlYXRlU3R5bGUoZWxlbWVudC5jbGFzc0xpc3QpO1xuICAgICAgICAgICAgaWYgKGNjU3R5bGVbY2FtZWxQcm9wZXJ0eV0pXG4gICAgICAgICAgICAgICAgdmFsdWUyID0gY2NTdHlsZVtjYW1lbFByb3BlcnR5XTtcbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbXB1dGVkU3R5bGVzID0gdGhpcy5nZXRSZWFsU3RhdGljQ29tcFN0eWxlKGVsZW1lbnQpO1xuICAgICAgICAgICAgICAgIHZhbHVlMiA9IGNvbXB1dGVkU3R5bGVzW2NhbWVsUHJvcGVydHldO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCF2YWx1ZTIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gY29uc29sZS53YXJuKGBcIiR7cHJvcGVydHl9XCIgY2FuIG5vdCBiZSBmb3VuZCBpbiBzdHlsZSBvYmplY3RgKVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgKFtzdHlsZVZhbHVlLCB1bml0XSA9IHBhcnNlVW5pdCh2YWx1ZTIpKTtcbiAgICAgICAgICAgIHZhbHVlID0gc3R5bGVWYWx1ZTtcbiAgICAgICAgICAgIHNldEF0dHJpYnV0ZUlmRGlmLmNhbGwoaW5wdXQsIFwiZGF0YS1hdHRyaWJ1dGVzX3VuaXRcIiwgdW5pdCk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnc3R5bGUnOlxuICAgICAgICAgICAgY29tcHV0ZWRTdHlsZXMgPSB0aGlzLmdldFJlYWxTdGF0aWNDb21wU3R5bGUoZWxlbWVudCk7XG4gICAgICAgICAgICB2YWx1ZTIgPSBjb21wdXRlZFN0eWxlc1tjYW1lbFByb3BlcnR5XTtcbiAgICAgICAgICAgIGlmICghdmFsdWUyKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvbnNvbGUud2FybihgXCIke3Byb3BlcnR5fVwiIGNhbiBub3QgYmUgZm91bmQgaW4gc3R5bGUgb2JqZWN0YClcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIChbc3R5bGVWYWx1ZSwgdW5pdF0gPSBwYXJzZVVuaXQodmFsdWUyKSk7XG4gICAgICAgICAgICB2YWx1ZSA9IHN0eWxlVmFsdWU7XG4gICAgICAgICAgICBzZXRBdHRyaWJ1dGVJZkRpZi5jYWxsKGlucHV0LCBcImRhdGEtYXR0cmlidXRlc191bml0XCIsIHVuaXQpO1xuICAgICAgICBjYXNlICdpbm5lclRleHQnOlxuICAgICAgICAgICAgdmFsdWUgPSBlbGVtZW50LmlubmVyVGV4dDtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgdmFsdWUgPSBlbGVtZW50LmdldEF0dHJpYnV0ZSh0eXBlKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgIH1cblxuICAgIHRoaXMuc2V0SW5wdXRWYWx1ZShpbnB1dCwgdmFsdWUgIT0gdW5kZWZpbmVkID8gdmFsdWUgOiAnJyk7XG5cbn1cblxuYXR0cmlidXRlcy5wcm90b3R5cGUuc2V0SW5wdXRWYWx1ZSA9IGZ1bmN0aW9uIHNldElucHV0VmFsdWUoaW5wdXQsIHZhbHVlKSB7XG4gICAgLy8gY29uc29sZS5sb2coaW5wdXQuZ2V0QXR0cmlidXRlKCduYW1lJykpXG5cbiAgICBsZXQgaW5wdXRUeXBlID0gaW5wdXQudGFnTmFtZS50b0xvd2VyQ2FzZSgpIHx8IGlucHV0LmNsYXNzTGlzdC5oYXMoJy5waWNrcicpICYmICdwaWNrcic7XG4gICAgc3dpdGNoIChpbnB1dFR5cGUpIHtcbiAgICAgICAgLy8gY2FzZSAnaW5wdXQnOlxuICAgICAgICAvLyAgICAgc3dpdGNoIChpbnB1dC50eXBlKSB7XG4gICAgICAgIC8vICAgICAgICAgY2FzZSAnY2hlY2tib3gnOlxuICAgICAgICAvLyAgICAgICAgIGNhc2UgJ3JhZGlvJzpcbiAgICAgICAgLy8gICAgICAgICAgICAgaW5wdXQuY2hlY2tlZCA9IHZhbHVlID09IGlucHV0LnZhbHVlID8gdHJ1ZSA6IGZhbHNlO1xuICAgICAgICAvLyAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgLy8gICAgICAgICBkZWZhdWx0OlxuICAgICAgICAvLyAgICAgICAgICAgICBpbnB1dC52YWx1ZSA9IHZhbHVlO1xuICAgICAgICAvLyAgICAgfVxuICAgICAgICAvLyAgICAgYnJlYWs7XG4gICAgICAgIC8vIGNhc2UgXCJ0ZXh0YXJlYVwiOlxuICAgICAgICAvLyAgICAgaW5wdXQudmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgLy8gICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdzZWxlY3QnOlxuICAgICAgICAgICAgbGV0IG9wdGlvbnMgPSBBcnJheS5mcm9tKGlucHV0Lm9wdGlvbnMpXG4gICAgICAgICAgICBvcHRpb25zLmZvckVhY2gob3B0aW9uID0+IHtcbiAgICAgICAgICAgICAgICBpZiAodmFsdWUgPT0gb3B0aW9uLnZhbHVlKVxuICAgICAgICAgICAgICAgICAgICBpbnB1dC5zZWxlY3RlZEluZGV4ID0gb3B0aW9ucy5pbmRleE9mKG9wdGlvbik7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ2NvY3JlYXRlLXNlbGVjdCc6XG4gICAgICAgICAgICByZW5kZXJPcHRpb25zKGlucHV0LCB2YWx1ZSlcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdwaWNrcic6XG4gICAgICAgICAgICAvLyB0b2RvOiBob3cgdG8gcGVyZm9ybSB2YWxpZGF0aW9uXG4gICAgICAgICAgICBsZXQgcGlja3JJbnMgPSBwaWNrci5yZWZzLmdldChpbnB1dCk7XG4gICAgICAgICAgICBwaWNrci5kaXNhYmxlZEV2ZW50ID0gdHJ1ZTtcbiAgICAgICAgICAgIHBpY2tySW5zLnNldENvbG9yKHZhbHVlKTsgLy8gdG9kbzogc3R5bGUgb3IgdmFsdWVcbiAgICAgICAgICAgIHBpY2tyLmRpc2FibGVkRXZlbnQgPSBmYWxzZTtcblxuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgY3JkdC5yZXBsYWNlVGV4dCh7XG4gICAgICAgICAgICAgICAgY29sbGVjdGlvbjogJ2FhYWFhJyxcbiAgICAgICAgICAgICAgICBkb2N1bWVudF9pZDogJ251bGwnLFxuICAgICAgICAgICAgICAgIG5hbWU6IGlucHV0LmdldEF0dHJpYnV0ZSgnbmFtZScpLFxuICAgICAgICAgICAgICAgIHZhbHVlOiB2YWx1ZSArICcnLFxuICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAnMCcsXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLy8gY29uc29sZS53YXJuKCdDb0NyZWF0ZVN0eWxlOiB1bmlkZW50aWZpZWQgaW5wdXQ6ICcsIGlucHV0VHlwZSwgJ2lucHV0ICcsIGlucHV0KVxuICAgIH1cbn1cblxuXG5cblxuYXR0cmlidXRlcy5wcm90b3R5cGUucGFja011bHRpVmFsdWUgPSBmdW5jdGlvbiBwYWNrTXVsdGlWYWx1ZSh7XG4gICAgaW5wdXRzLFxuICAgIHN0YXRlUHJvcGVydHksXG4gICAgdmFsdWVQcm9wZXJ0eSA9IFwidmFsdWVcIixcbiAgICBmb3JjZVN0YXRlLFxufSkge1xuICAgIGxldCB2YWx1ZSA9IFtdO1xuICAgIEFycmF5LmZyb20oaW5wdXRzKS5mb3JFYWNoKGlucHV0ID0+IHtcbiAgICAgICAgdmFsdWUucHVzaCh7IGNoZWNrZWQ6IGZvcmNlU3RhdGUgfHwgaW5wdXRbc3RhdGVQcm9wZXJ0eV0sIHZhbHVlOiBpbnB1dFt2YWx1ZVByb3BlcnR5XSB8fCBpbnB1dC5nZXRBdHRyaWJ1dGUodmFsdWVQcm9wZXJ0eSkgfSlcbiAgICB9KVxuICAgIHJldHVybiB2YWx1ZVxufVxuXG5hdHRyaWJ1dGVzLnByb3RvdHlwZS5nZXRJbnB1dFZhbHVlID0gZnVuY3Rpb24gZ2V0SW5wdXRWYWx1ZShpbnB1dCkge1xuICAgIGlmICghaW5wdXQpIHJldHVybjtcbiAgICBsZXQgaW5wdXRUeXBlID0gaW5wdXQudGFnTmFtZS50b0xvd2VyQ2FzZSgpIHx8IGlucHV0LmNsYXNzTGlzdC5oYXMoJy5waWNrcicpICYmICdwaWNrcic7XG5cbiAgICBzd2l0Y2ggKGlucHV0VHlwZSkge1xuICAgICAgICBjYXNlICdpbnB1dCc6XG4gICAgICAgICAgICBzd2l0Y2ggKGlucHV0LnR5cGUpIHtcbiAgICAgICAgICAgICAgICBjYXNlICdjaGVja2JveCc6XG4gICAgICAgICAgICAgICAgY2FzZSAncmFkaW8nOlxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5wYWNrTXVsdGlWYWx1ZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICBpbnB1dHM6IHRoaXMuaW5pdERvY3VtZW50LmdldEVsZW1lbnRzQnlOYW1lKGlucHV0Lm5hbWUpLFxuICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVQcm9wZXJ0eTogJ2NoZWNrZWQnLFxuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBpbnB1dC52YWx1ZTtcblxuICAgICAgICAgICAgfVxuXG4gICAgICAgIGNhc2UgXCJ0ZXh0YXJlYVwiOlxuICAgICAgICAgICAgcmV0dXJuIGlucHV0LnZhbHVlO1xuXG4gICAgICAgIGNhc2UgJ3NlbGVjdCc6XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wYWNrTXVsdGlWYWx1ZSh7XG4gICAgICAgICAgICAgICAgaW5wdXRzOiBpbnB1dC5vcHRpb25zLFxuICAgICAgICAgICAgICAgIHN0YXRlUHJvcGVydHk6ICdzZWxlY3RlZCdcbiAgICAgICAgICAgIH0pXG5cbiAgICAgICAgY2FzZSAnY29jcmVhdGUtc2VsZWN0JzpcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnBhY2tNdWx0aVZhbHVlKHtcbiAgICAgICAgICAgICAgICBpbnB1dHM6IGlucHV0LnF1ZXJ5U2VsZWN0b3JBbGwoXCI6c2NvcGUgPiBbc2VsZWN0ZWRdXCIpLFxuICAgICAgICAgICAgICAgIGZvcmNlU3RhdGU6IHRydWVcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIGNhc2UgJ3BpY2tyJzpcbiAgICAgICAgICAgIC8vIHRvZG86IGhvdyB0byBwZXJmb3JtIHZhbGlkYXRpb25cbiAgICAgICAgICAgIC8vIGlmICghQ29DcmVhdGUucGlja3IucmVmcy5oYXMoaW5wdXQpKSByZXR1cm47IFxuICAgICAgICAgICAgbGV0IHBpY2tySW5zID0gcGlja3IucmVmcy5nZXQoaW5wdXQpO1xuICAgICAgICAgICAgcmV0dXJuIHBpY2tySW5zID8gcGlja3JJbnMuZ2V0Q29sb3IoKS50b0hFWEEoKS50b1N0cmluZygpIDogJyc7XG5cblxuXG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oJ0NvQ3JlYXRlU3R5bGU6IHVuaWRlbnRpZmllZCBpbnB1dCcpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgfVxuXG5cbn1cblxuXG5cbmF0dHJpYnV0ZXMucHJvdG90eXBlLmdldEVsZW1lbnRGcm9tSW5wdXQgPSBhc3luYyBmdW5jdGlvbiBnZXRFbGVtZW50RnJvbUlucHV0KGlucHV0KSB7XG4gICAgbGV0IGlkID0gaW5wdXQuZ2V0QXR0cmlidXRlKFwiZGF0YS1hdHRyaWJ1dGVzX3RhcmdldFwiKTtcblxuICAgIGlmIChpZCkge1xuICAgICAgICBpZiAoaWQuaW5kZXhPZignOycpICE9PSAtMSkge1xuICAgICAgICAgICAgbGV0IGVsID0gYXdhaXQgdGhpcy5jb21wbGV4U2VsZWN0b3IoaWQsXG4gICAgICAgICAgICAgICAgKGNhbnZhc0RvYywgc2VsZWN0b3IpID0+IGNhbnZhc0RvYy5xdWVyeVNlbGVjdG9yKHNlbGVjdG9yKSk7XG4gICAgICAgICAgICByZXR1cm4gZWw7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuaW5pdERvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoaWQpXG4gICAgfVxuICAgIGVsc2VcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuXG59XG5cblxuXG5hdHRyaWJ1dGVzLnByb3RvdHlwZS5nZXRSZWFsU3RhdGljQ29tcFN0eWxlID0gZnVuY3Rpb24gZ2V0UmVhbFN0YXRpY0NvbXBTdHlsZShlbGVtZW50KSB7XG4gICAgaWYgKGNhY2hlLmdldChlbGVtZW50LCAndmFsaWQnKSlcbiAgICAgICAgcmV0dXJuIGNhY2hlLmdldChlbGVtZW50LCAnY29tcHV0ZWRTdHlsZXMnKTtcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgY2FjaGUucmVzZXQoZWxlbWVudClcbiAgICB9LCA1MDAwKTtcbiAgICBsZXQgb2xkRGlzcGFseSA9IGVsZW1lbnQuc3R5bGUuZGlzcGxheTtcbiAgICBlbGVtZW50LnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcbiAgICBsZXQgY29tcHV0ZWRTdHlsZXNMaXZlID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUoZWxlbWVudCk7XG4gICAgbGV0IGNvbXB1dGVkU3R5bGVzID0gT2JqZWN0LmFzc2lnbih7fSwgY29tcHV0ZWRTdHlsZXNMaXZlKTtcbiAgICBjb21wdXRlZFN0eWxlcy5kaXNwbGF5ID0gb2xkRGlzcGFseTtcblxuICAgIGVsZW1lbnQuc3R5bGUuZGlzcGxheSA9IG9sZERpc3BhbHk7XG4gICAgaWYgKGVsZW1lbnQuZ2V0QXR0cmlidXRlKFwic3R5bGVcIikgPT0gXCJcIikgZWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoXCJzdHlsZVwiKTtcbiAgICBlbGVtZW50LnJlbW92ZUF0dHJpYnV0ZSgnbm8tb2JzZXJ2ZScpXG4gICAgY2FjaGUuc3ByZWFkKGVsZW1lbnQsIHsgY29tcHV0ZWRTdHlsZXMsIHZhbGlkOiB0cnVlIH0pXG4gICAgcmV0dXJuIGNvbXB1dGVkU3R5bGVzO1xufVxuXG5cbmF0dHJpYnV0ZXMucHJvdG90eXBlLmNvbXBsZXhTZWxlY3RvciA9IGFzeW5jIGZ1bmN0aW9uIGNvbXBsZXhTZWxlY3Rvcihjb21TZWxlY3RvciwgY2FsbGJhY2spIHtcbiAgICBsZXQgW2NhbnZhc1NlbGVjdG9yLCBzZWxlY3Rvcl0gPSBjb21TZWxlY3Rvci5zcGxpdCgnOycpO1xuICAgIGxldCBjYW52YXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNhbnZhc1NlbGVjdG9yKTtcbiAgICBpZiAoIWNhbnZhcykge1xuICAgICAgICBjb25zb2xlLndhcm4oJ2NvbXBsZXggc2VsZWN0b3IgY2FudmFzIG5vdyBmb3VuZCBmb3InLCBjb21TZWxlY3RvcilcbiAgICAgICAgcmV0dXJuXG4gICAgfVxuXG4gICAgaWYgKCAvKiFjYW52YXMuY29udGVudFdpbmRvdy5vYnNlcnZlZEJ5Q0NBdHRyaWJ1dGVzICYmKi8gY2FudmFzLmNvbnRlbnREb2N1bWVudC5yZWFkeVN0YXRlID09PSAnbG9hZGluZycpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgICAgICAgICBjYW52YXMuY29udGVudFdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdsb2FkJywgKGUpID0+IHJlc29sdmUoKSlcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ2lmcmFtZSBjYW4gbm90IGJlIGxvYWRlZCcpXG4gICAgICAgIH1cbiAgICAgICAgLy8gdGhpcy5vYnNlcnZlckVsZW1lbnRzKGNhbnZhcy5jb250ZW50V2luZG93KVxuICAgICAgICAvLyBjYW52YXMuY29udGVudFdpbmRvdy5vYnNlcnZlZEJ5Q0NBdHRyaWJ1dGVzID0gdHJ1ZTtcbiAgICB9XG5cbiAgICByZXR1cm4gY2FsbGJhY2soY2FudmFzLmNvbnRlbnRXaW5kb3cuZG9jdW1lbnQsIHNlbGVjdG9yKTtcbn1cblxuXG5cblxuXG5cblxuLy8gYXR0cmlidXRlcy5wcm90b3R5cGUuZ2V0SW5wdXRzID0gZnVuY3Rpb24gZ2V0SW5wdXRzKGVsZW1lbnQpIHtcbi8vICAgICBsZXQgaW5wdXRzID0gW107XG4vLyAgICAgbGV0IGFsbElucHV0cyA9IEFycmF5LmZyb20oZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJpbnB1dFwiKSk7XG4vLyAgICAgYWxsSW5wdXRzLmZvckVhY2goKGlucHV0Q2FuZGlkYXRlKSA9PiB7XG4vLyAgICAgICAgIGxldCBpbnB1dE1ldGEgPSBnZXRJbnB1dE1ldGFEYXRhKGlucHV0Q2FuZGlkYXRlKTtcbi8vICAgICAgICAgaWYgKCFpbnB1dE1ldGEpIHJldHVybjtcblxuLy8gICAgICAgICBsZXQgYWxsUmVmZXJlbmNlZEVsID0gYWxsRnJhbWUoKGZyYW1lKSA9PlxuLy8gICAgICAgICAgICAgZnJhbWUucXVlcnlTZWxlY3RvckFsbChcbi8vICAgICAgICAgICAgICAgICBpbnB1dE1ldGEuaW5wdXQuZ2V0QXR0cmlidXRlKFwiZGF0YS1hdHRyaWJ1dGVzX3RhcmdldFwiKVxuLy8gICAgICAgICAgICAgKVxuLy8gICAgICAgICApO1xuLy8gICAgICAgICBpZiAoQXJyYXkuZnJvbShhbGxSZWZlcmVuY2VkRWwpLmluY2x1ZGVzKGVsZW1lbnQpKSB7XG4vLyAgICAgICAgICAgICBpbnB1dHMucHVzaChpbnB1dE1ldGEuaW5wdXQpO1xuLy8gICAgICAgICB9XG4vLyAgICAgfSk7XG4vLyAgICAgcmV0dXJuIGlucHV0cztcbi8vIH1cbi8vYXR0cmlidXRlcy5wcm90b3R5cGUucGVySW5wdXQgPSAgYXN5bmMgZnVuY3Rpb24gcGVySW5wdXQoaW5wdXQsIGNhbGxiYWNrKSB7XG4vLyAgICAgbGV0IGlucHV0TWV0YSwgZWxlbWVudCwgZ3JvdXAgPSBpbnB1dC5nZXRBdHRyaWJ1dGUoXCJkYXRhLWF0dHJpYnV0ZXNfZ3JvdXBcIik7XG4vLyAgICAgaWYgKGdyb3VwKSB7XG4vLyAgICAgICAgIFtpbnB1dE1ldGEsIGVsZW1lbnRdID0gZ2V0SW5wdXRzTWV0YURhdGEoaW5wdXQpO1xuLy8gICAgIH0gZWxzZSB7XG4vLyAgICAgICAgIGlucHV0TWV0YSA9IHZhbGlkYXRlSW5wdXQoaW5wdXQpO1xuLy8gICAgICAgICBlbGVtZW50ID0gYXdhaXQgZ2V0RWxlbWVudEZyb21JbnB1dChpbnB1dCk7XG4vLyAgICAgfVxuXG4vLyAgICAgaWYgKCFpbnB1dE1ldGEgfHwgIWVsZW1lbnQpIHJldHVybjtcblxuLy8gICAgIGlmIChBcnJheS5pc0FycmF5KGlucHV0TWV0YSkpXG4vLyAgICAgICAgIGlucHV0TWV0YS5mb3JFYWNoKGFzeW5jKG1ldGFzKSA9PiBjYWxsYmFjayhtZXRhcywgZWxlbWVudCkpXG4vLyAgICAgZWxzZVxuLy8gICAgICAgICBjYWxsYmFjayhpbnB1dE1ldGEsIGVsZW1lbnQpXG4vLyB9XG5cbi8vYXR0cmlidXRlcy5wcm90b3R5cGUuZ2V0SW5wdXRzTWV0YURhdGEgPSAgZnVuY3Rpb24gZ2V0SW5wdXRzTWV0YURhdGEoaW5wdXQpIHtcbi8vICAgICBsZXQgbGlzdCA9IFtdLFxuLy8gICAgICAgICBpbnB1dHMgPSBbXTtcbi8vICAgICBsZXQgZWxlbWVudCA9IGdldEVsZW1lbnRGcm9tSW5wdXQoaW5wdXQpXG4vLyAgICAgbGV0IHJlYWxJbnB1dHMgPSBpbnB1dC5xdWVyeVNlbGVjdG9yQWxsKGdyb3VwKTtcbi8vICAgICByZWFsSW5wdXRzLmZvckVhY2goaW5wID0+IHtcbi8vICAgICAgICAgXG4vLyAgICAgICAgIGlucHV0cy5wdXNoKGlucClcbi8vICAgICAgICAgbGlzdC5wdXNoKHZhbGlkYXRlSW5wdXQoaW5wKSlcbi8vICAgICB9KVxuLy8gICAgIGdyb3VwRWwuc2V0KGlucHV0LCBpbnB1dHMpO1xuLy8gICAgIHJldHVybiBbbGlzdCwgZWxlbWVudF07XG4vLyB9XG5cblxuXG4vLyB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsICgpID0+IHtcbi8vICAgICBsZXQgYXR0cmlidXRlID0gbmV3IGF0dHJpYnV0ZXMoeyBkb2N1bWVudCwgZXhjbHVkZTogJyNnaG9zdEVmZmVjdCwudmRvbS1pdGVtICcsXG4vLyAgICAgICBjYWxsYmFjazogKHtcbi8vICAgICAgICAgdmFsdWUsXG4vLyAgICAgICAgIHR5cGUsXG4vLyAgICAgICAgIHByb3BlcnR5LFxuLy8gICAgICAgICBlbGVtZW50LFxuLy8gICAgIH0pID0+IHtcbi8vICAgICAgICAgICBpZiAoZG9jdW1lbnQuY29udGFpbnMoZWxlbWVudCkpXG4vLyAgICAgICAgIGRvbVRvVGV4dC5kb21Ub1RleHQoe1xuLy8gICAgICAgICAgIG1ldGhvZDogdHlwZSA9PSAnYXR0cmlidXRlJyA/ICdzZXRBdHRyaWJ1dGUnIDogdHlwZSwgXG4vLyAgICAgICAgICAgcHJvcGVydHk6IHByb3BlcnR5LFxuLy8gICAgICAgICAgIHRhcmdldDogZWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJkYXRhLWVsZW1lbnRfaWRcIiksXG4vLyAgICAgICAgICAgdGFnTmFtZTogZWxlbWVudC50YWdOYW1lLFxuLy8gICAgICAgICAgIHZhbHVlLFxuLy8gICAgICAgICAgIC4uLmNyZHRDb25cbi8vICAgICAgICAgfSlcblxuLy8gICAgIH0sfSlcbi8vICAgICBhdHRyaWJ1dGUuaW5pdCgpXG4vLyB9KVxuXG4vLyBsZXQgcyA9IG5ldyBhdHRyaWJ1dGVzKHtcbi8vICAgICBkb2N1bWVudCxcbi8vICAgICBleGNsdWRlOiAnI2dob3N0RWZmZWN0LC52ZG9tLWl0ZW0gJyxcbi8vICAgICBjYWxsYmFjazogKHtcbi8vICAgICAgICAgdmFsdWUsXG4vLyAgICAgICAgIHR5cGUsXG4vLyAgICAgICAgIHByb3BlcnR5LFxuLy8gICAgICAgICBlbGVtZW50LFxuLy8gICAgIH0pID0+IHtcbi8vICAgICAgICAgICBpZiAoZG9jdW1lbnQuY29udGFpbnMoZWxlbWVudCkpXG4vLyAgICAgICAgIGRvbVRvVGV4dC5kb21Ub1RleHQoe1xuLy8gICAgICAgICAgIG1ldGhvZDogdHlwZSA9PSAnYXR0cmlidXRlJyA/ICdzZXRBdHRyaWJ1dGUnIDogdHlwZSwgXG4vLyAgICAgICAgICAgcHJvcGVydHk6IHByb3BlcnR5LFxuLy8gICAgICAgICAgIHRhcmdldDogZWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJkYXRhLWVsZW1lbnRfaWRcIiksXG4vLyAgICAgICAgICAgdGFnTmFtZTogZWxlbWVudC50YWdOYW1lLFxuLy8gICAgICAgICAgIHZhbHVlLFxuLy8gICAgICAgICAgIC4uLmNyZHRDb25cbi8vICAgICAgICAgfSlcblxuLy8gICAgIH0sXG4vLyB9KVxuLy8gcy5pbml0KCk7XG5cblxuXG5leHBvcnQgZGVmYXVsdCB7XG4gICAgaW5pdDogKHBhcmFtcykgPT4ge1xuICAgICAgICBsZXQgcyA9IG5ldyBhdHRyaWJ1dGVzKHBhcmFtcylcbiAgICAgICAgcy5pbml0KCk7XG4gICAgICAgIHJldHVybiBzO1xuICAgIH1cbn07XG4iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///../../CoCreateJS/node_modules/@cocreate/attributes/src/index.js\n")}}]);